var InstantAnnotation=function(e){var t={};function n(r){if(t[r])return t[r].exports;var a=t[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,n),a.l=!0,a.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(r,a,function(t){return e[t]}.bind(null,a));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=5)}([function(e,t){e.exports=jQuery},function(e,t){e.exports=0},function(e,t,n){(function(t,n){var r;e.exports=function e(t,n,a){function o(s,l){if(!n[s]){if(!t[s]){if(!l&&"function"==typeof r&&r)return r(s,!0);if(i)return i(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var c=n[s]={exports:{}};t[s][0].call(c.exports,function(e){return o(t[s][1][e]||e)},c,c.exports,e,t,n,a)}return n[s].exports}for(var i="function"==typeof r&&r,s=0;s<a.length;s++)o(a[s]);return o}({1:[function(e,t,n){},{}],2:[function(e,t,n){"use strict";const{clone:r}=e("./util");t.exports=class{constructor(e=100){this.order=[],this.cache=new Map,this.size=e}get(e,t){const n=this.cache.get(e);if(n){const e=JSON.stringify(t);return n.get(e)||null}return null}set(e,t,n){if(this.order.length===this.size){const e=this.order.shift();this.cache.get(e.activeCtx).delete(e.localCtx)}const a=JSON.stringify(t);this.order.push({activeCtx:e,localCtx:a});let o=this.cache.get(e);o||(o=new Map,this.cache.set(e,o)),o.set(a,r(n))}}},{"./util":23}],3:[function(e,t,n){"use strict";t.exports=class extends Error{constructor(e="An unspecified JSON-LD error occurred.",t="jsonld.Error",n={}){super(e),this.name=t,this.message=e,this.details=n}}},{}],4:[function(e,t,n){"use strict";t.exports=e=>{class t{toString(){return"[object JsonLdProcessor]"}}return Object.defineProperty(t,"prototype",{writable:!1,enumerable:!1}),Object.defineProperty(t.prototype,"constructor",{writable:!0,enumerable:!1,configurable:!0,value:t}),t.compact=function(t,n){return arguments.length<2?Promise.reject(new TypeError("Could not compact, too few arguments.")):e.compact(t,n)},t.expand=function(t){return arguments.length<1?Promise.reject(new TypeError("Could not expand, too few arguments.")):e.expand(t)},t.flatten=function(t){return arguments.length<1?Promise.reject(new TypeError("Could not flatten, too few arguments.")):e.flatten(t)},t}},{}],5:[function(e,t,n){"use strict";t.exports=e("rdf-canonize").NQuads},{"rdf-canonize":41}],6:[function(e,t,n){"use strict";const{RDF_LANGSTRING:r,RDF_PLAIN_LITERAL:a,RDF_OBJECT:o,RDF_XML_LITERAL:i,XSD_STRING:s}=e("./constants");let l;l="undefined"!=typeof Node?Node:{ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,ENTITY_REFERENCE_NODE:5,ENTITY_NODE:6,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_NODE:9,DOCUMENT_TYPE_NODE:10,DOCUMENT_FRAGMENT_NODE:11,NOTATION_NODE:12},t.exports=class{parse(t){const n={"@default":[]},u=t.getSubjects();for(let c=0;c<u.length;++c){const d=u[c];if(null===d)continue;const p=t.getSubjectTriples(d);if(null===p)continue;const f=p.predicates;for(const t in f){const u=f[t].objects;for(let c=0;c<u.length;++c){const p=u[c],f={};0===d.indexOf("_:")?f.subject={type:"blank node",value:d}:f.subject={type:"IRI",value:d},0===t.indexOf("_:")?f.predicate={type:"blank node",value:t}:f.predicate={type:"IRI",value:t};let h=p.value;if(p.type===i){const t=new("undefined"==typeof XMLSerializer?e("xmldom").XMLSerializer:XMLSerializer);h="";for(let e=0;e<p.value.length;e++)p.value[e].nodeType===l.ELEMENT_NODE?h+=t.serializeToString(p.value[e]):p.value[e].nodeType===l.TEXT_NODE&&(h+=p.value[e].nodeValue)}f.object={},p.type===o?0===p.value.indexOf("_:")?f.object.type="blank node":f.object.type="IRI":(f.object.type="literal",p.type===a?p.language?(f.object.datatype=r,f.object.language=p.language):f.object.datatype=s:f.object.datatype=p.type),f.object.value=h,n["@default"].push(f)}}}return n}}},{"./constants":9,xmldom:1}],7:[function(e,t,n){"use strict";const{callbackify:r,normalizeDocumentLoader:a}=e("./util");t.exports=class{constructor(){this._requests={},this.add=r(this.add.bind(this))}wrapLoader(e){const t=this;return t._loader=a(e),function(){return t.add.apply(t,arguments)}}async add(e){const t=this;let n=t._requests[e];if(n)return Promise.resolve(n);n=t._requests[e]=t._loader(e);try{return await n}finally{delete t._requests[e]}}}},{"./util":23}],8:[function(e,t,n){"use strict";const r=e("./JsonLdError"),{isArray:a,isObject:o,isString:i,isUndefined:s}=e("./types"),{isList:l,isValue:u,isGraph:c,isSimpleGraph:d,isSubjectReference:p}=e("./graphTypes"),{expandIri:f,getContextValue:h,isKeyword:y,process:g}=e("./context"),{removeBase:v}=e("./url"),{addValue:m,asArray:b,compareShortestLeast:x}=e("./util"),w={};function I(e,t,n){if("@nest"!==f(e,t,{vocab:!0},n))throw new r("JSON-LD compact error; nested property must have an @nest value resolving to @nest.","jsonld.SyntaxError",{code:"invalid @nest value"})}t.exports=w,w.compact=({activeCtx:e,activeProperty:t=null,element:n,options:i={},compactionMap:f=(()=>void 0)})=>{if(a(n)){let r=[];for(let a=0;a<n.length;++a){let o=w.compact({activeCtx:e,activeProperty:t,element:n[a],options:i,compactionMap:f});null===o&&void 0===(o=f({unmappedValue:n[a],activeCtx:e,activeProperty:t,parent:n,index:a,options:i}))||r.push(o)}return i.compactArrays&&1===r.length&&0===(h(e,t,"@container")||[]).length&&(r=r[0]),r}const v=h(e,t,"@context");if(s(v)||(e=g({activeCtx:e,localCtx:v,isPropertyTermScopedContext:!0,options:i})),o(n)){if(i.link&&"@id"in n&&i.link.hasOwnProperty(n["@id"])){const e=i.link[n["@id"]];for(let t=0;t<e.length;++t)if(e[t].expanded===n)return e[t].compacted}if(u(n)||p(n)){const r=w.compactValue({activeCtx:e,activeProperty:t,value:n,options:i});return i.link&&p(n)&&(i.link.hasOwnProperty(n["@id"])||(i.link[n["@id"]]=[]),i.link[n["@id"]].push({expanded:n,compacted:r})),r}const v="@reverse"===t,x={};e=e.revertTypeScopedContext(),i.link&&"@id"in n&&(i.link.hasOwnProperty(n["@id"])||(i.link[n["@id"]]=[]),i.link[n["@id"]].push({expanded:n,compacted:x}));let S=n["@type"]||[];S.length>1&&(S=Array.from(S).sort());const O=e;for(const t of S){const n=w.compactIri({activeCtx:O,iri:t,relativeTo:{vocab:!0}}),r=h(O,n,"@context");s(r)||(e=g({activeCtx:e,localCtx:r,options:i,isTypeScopedContext:!0}))}const C=Object.keys(n).sort();for(const s of C){const p=n[s];if("@id"!==s&&"@type"!==s)if("@reverse"!==s)if("@preserve"!==s)if("@index"!==s)if("@graph"!==s&&"@list"!==s&&y(s)){const t=w.compactIri({activeCtx:e,iri:s,relativeTo:{vocab:!0}});m(x,t,p)}else{if(!a(p))throw new r("JSON-LD expansion error; expanded value must be an array.","jsonld.SyntaxError");if(0===p.length){const t=w.compactIri({activeCtx:e,iri:s,value:p,relativeTo:{vocab:!0},reverse:v}),n=e.mappings.has(t)?e.mappings.get(t)["@nest"]:null;let r=x;n&&(I(e,n,i),o(x[n])||(x[n]={}),r=x[n]),m(r,t,p,{propertyIsArray:!0})}for(const t of p){const n=w.compactIri({activeCtx:e,iri:s,value:t,relativeTo:{vocab:!0},reverse:v}),p=e.mappings.has(n)?e.mappings.get(n)["@nest"]:null;let y=x;p&&(I(e,p,i),o(x[p])||(x[p]={}),y=x[p]);const g=h(e,n,"@container")||[],S=c(t),O=l(t);let C;O?C=t["@list"]:S&&(C=t["@graph"]);let k=w.compact({activeCtx:e,activeProperty:n,element:O||S?C:t,options:i,compactionMap:f});if(O)if(a(k)||(k=[k]),g.includes("@list")){if(y.hasOwnProperty(n))throw new r('JSON-LD compact error; property has a "@list" @container rule but there is more than a single @list that matches the compacted term in the document. Compaction might mix unwanted items into the list.',"jsonld.SyntaxError",{code:"compaction to list of lists"})}else k={[w.compactIri({activeCtx:e,iri:"@list",relativeTo:{vocab:!0}})]:k},"@index"in t&&(k[w.compactIri({activeCtx:e,iri:"@index",relativeTo:{vocab:!0}})]=t["@index"]);if(S)if(g.includes("@graph")&&(g.includes("@id")||g.includes("@index")&&d(t))){let r;y.hasOwnProperty(n)?r=y[n]:y[n]=r={};const a=(g.includes("@id")?t["@id"]:t["@index"])||w.compactIri({activeCtx:e,iri:"@none",vocab:!0});m(r,a,k,{propertyIsArray:!i.compactArrays||g.includes("@set")})}else g.includes("@graph")&&d(t)?m(y,n,k,{propertyIsArray:!i.compactArrays||g.includes("@set")}):(a(k)&&1===k.length&&i.compactArrays&&(k=k[0]),k={[w.compactIri({activeCtx:e,iri:"@graph",relativeTo:{vocab:!0}})]:k},"@id"in t&&(k[w.compactIri({activeCtx:e,iri:"@id",relativeTo:{vocab:!0}})]=t["@id"]),"@index"in t&&(k[w.compactIri({activeCtx:e,iri:"@index",relativeTo:{vocab:!0}})]=t["@index"]),m(y,n,k,{propertyIsArray:!i.compactArrays||g.includes("@set")}));else if(g.includes("@language")||g.includes("@index")||g.includes("@id")||g.includes("@type")){let r,a;if(y.hasOwnProperty(n)?r=y[n]:y[n]=r={},g.includes("@language"))u(k)&&(k=k["@value"]),a=t["@language"];else if(g.includes("@index"))a=t["@index"];else if(g.includes("@id")){const t=w.compactIri({activeCtx:e,iri:"@id",vocab:!0});a=k[t],delete k[t]}else if(g.includes("@type")){const t=w.compactIri({activeCtx:e,iri:"@type",vocab:!0});let n;switch([a,...n]=b(k[t]||[]),n.length){case 0:delete k[t];break;case 1:k[t]=n[0];break;default:k[t]=n}}a||(a=w.compactIri({activeCtx:e,iri:"@none",vocab:!0})),m(r,a,k,{propertyIsArray:g.includes("@set")})}else{const e=!i.compactArrays||g.includes("@set")||g.includes("@list")||a(k)&&0===k.length||"@list"===s||"@graph"===s;m(y,n,k,{propertyIsArray:e})}}}else{if((h(e,t,"@container")||[]).includes("@index"))continue;const n=w.compactIri({activeCtx:e,iri:s,relativeTo:{vocab:!0}});m(x,n,p)}else{const n=w.compact({activeCtx:e,activeProperty:t,element:p,options:i,compactionMap:f});a(n)&&0===n.length||m(x,s,n)}else{const t=w.compact({activeCtx:e,activeProperty:"@reverse",element:p,options:i,compactionMap:f});for(const n in t)if(e.mappings.has(n)&&e.mappings.get(n).reverse){const r=t[n],a=(h(e,n,"@container")||[]).includes("@set")||!i.compactArrays;m(x,n,r,{propertyIsArray:a}),delete t[n]}if(Object.keys(t).length>0){const n=w.compactIri({activeCtx:e,iri:s,relativeTo:{vocab:!0}});m(x,n,t)}}else{const t="@type"===s,n=t&&e.previousContext||e;let r=b(p).map(e=>w.compactIri({activeCtx:n,iri:e,relativeTo:{vocab:t}}));1===r.length&&(r=r[0]);const o=w.compactIri({activeCtx:e,iri:s,relativeTo:{vocab:!0}}),i=a(r)&&0===p.length;m(x,o,r,{propertyIsArray:i})}}return x}return n},w.compactIri=({activeCtx:e,iri:t,value:n=null,relativeTo:r={vocab:!1},reverse:a=!1})=>{if(null===t)return t;e.isPropertyTermScoped&&e.previousContext&&(e=e.previousContext);const i=e.getInverse();if(y(t)&&t in i&&"@none"in i[t]&&"@type"in i[t]["@none"]&&"@none"in i[t]["@none"]["@type"])return i[t]["@none"]["@type"]["@none"];if(r.vocab&&t in i){const r=e["@language"]||"@none",i=[];o(n)&&"@index"in n&&!("@graph"in n)&&i.push("@index","@index@set"),o(n)&&"@preserve"in n&&(n=n["@preserve"][0]),c(n)?("@index"in n&&i.push("@graph@index","@graph@index@set","@index","@index@set"),"@id"in n&&i.push("@graph@id","@graph@id@set"),i.push("@graph","@graph@set","@set"),"@index"in n||i.push("@graph@index","@graph@index@set","@index","@index@set"),"@id"in n||i.push("@graph@id","@graph@id@set")):o(n)&&!u(n)&&i.push("@id","@id@set","@type","@set@type");let s="@language",d="@null";if(a)s="@type",d="@reverse",i.push("@set");else if(l(n)){"@index"in n||i.push("@list");const e=n["@list"];if(0===e.length)s="@any",d="@none";else{let t=0===e.length?r:null,n=null;for(let r=0;r<e.length;++r){const a=e[r];let o="@none",i="@none";if(u(a)?"@language"in a?o=a["@language"]:"@type"in a?i=a["@type"]:o="@null":i="@id",null===t?t=o:o!==t&&u(a)&&(t="@none"),null===n?n=i:i!==n&&(n="@none"),"@none"===t&&"@none"===n)break}t=t||"@none","@none"!==(n=n||"@none")?(s="@type",d=n):d=t}}else u(n)?"@language"in n&&!("@index"in n)?(i.push("@language","@language@set"),d=n["@language"]):"@type"in n&&(s="@type",d=n["@type"]):(s="@type",d="@id"),i.push("@set");i.push("@none"),!o(n)||"@index"in n||i.push("@index","@index@set"),u(n)&&1===Object.keys(n).length&&i.push("@language","@language@set");const f=function(e,t,n,r,a,o){null===o&&(o="@null");const i=[];if("@id"!==o&&"@reverse"!==o||!p(n))i.push(o);else{"@reverse"===o&&i.push("@reverse");const t=w.compactIri({activeCtx:e,iri:n["@id"],relativeTo:{vocab:!0}});e.mappings.has(t)&&e.mappings.get(t)&&e.mappings.get(t)["@id"]===n["@id"]?i.push.apply(i,["@vocab","@id"]):i.push.apply(i,["@id","@vocab"])}i.push("@none");const s=e.inverse[t];for(let e=0;e<r.length;++e){const t=r[e];if(!(t in s))continue;const n=s[t][a];for(let e=0;e<i.length;++e){const t=i[e];if(t in n)return n[t]}}return null}(e,t,n,i,s,d);if(null!==f)return f}if(r.vocab&&"@vocab"in e){const n=e["@vocab"];if(0===t.indexOf(n)&&t!==n){const r=t.substr(n.length);if(!e.mappings.has(r))return r}}let s=null;const d=[];let f=e.fastCurieMap;const h=t.length-1;for(let e=0;e<h&&t[e]in f;++e)""in(f=f[t[e]])&&d.push(f[""][0]);for(let r=d.length-1;r>=0;--r){const a=d[r],o=a.terms;for(const r of o){const o=r+":"+t.substr(a.iri.length);e.mappings.get(r)._prefix&&(!e.mappings.has(o)||null===n&&e.mappings.get(o)["@id"]===t)&&(null===s||x(o,s)<0)&&(s=o)}}return null!==s?s:r.vocab?t:v(e["@base"],t)},w.compactValue=({activeCtx:e,activeProperty:t,value:n,options:r})=>{if(u(n)){const r=h(e,t,"@type"),a=h(e,t,"@language"),o=h(e,t,"@container")||[],s="@index"in n&&!o.includes("@index");if(!s&&(n["@type"]===r||n["@language"]===a))return n["@value"];const l=Object.keys(n).length,u=1===l||2===l&&"@index"in n&&!s,c="@language"in e,d=i(n["@value"]),p=e.mappings.has(t)&&null===e.mappings.get(t)["@language"];if(u&&(!c||!d||p))return n["@value"];const f={};return s&&(f[w.compactIri({activeCtx:e,iri:"@index",relativeTo:{vocab:!0}})]=n["@index"]),"@type"in n?f[w.compactIri({activeCtx:e,iri:"@type",relativeTo:{vocab:!0}})]=w.compactIri({activeCtx:e,iri:n["@type"],relativeTo:{vocab:!0}}):"@language"in n&&(f[w.compactIri({activeCtx:e,iri:"@language",relativeTo:{vocab:!0}})]=n["@language"]),f[w.compactIri({activeCtx:e,iri:"@value",relativeTo:{vocab:!0}})]=n["@value"],f}const a=f(e,t,{vocab:!0},r),o=h(e,t,"@type"),s=w.compactIri({activeCtx:e,iri:n["@id"],relativeTo:{vocab:"@vocab"===o}});return"@id"===o||"@vocab"===o||"@graph"===a?s:{[w.compactIri({activeCtx:e,iri:"@id",relativeTo:{vocab:!0}})]:s}},w.removePreserve=(e,t,n)=>{if(a(t)){const r=[];for(let a=0;a<t.length;++a){const o=w.removePreserve(e,t[a],n);null!==o&&r.push(o)}t=r}else if(o(t)){if("@preserve"in t)return"@null"===t["@preserve"]?null:t["@preserve"];if(u(t))return t;if(l(t))return t["@list"]=w.removePreserve(e,t["@list"],n),t;const r=w.compactIri({activeCtx:e,iri:"@id",relativeTo:{vocab:!0}});if(t.hasOwnProperty(r)){const e=t[r];if(n.link.hasOwnProperty(e)){const r=n.link[e].indexOf(t);if(-1!==r)return n.link[e][r];n.link[e].push(t)}else n.link[e]=[t]}const o=w.compactIri({activeCtx:e,iri:"@graph",relativeTo:{vocab:!0}});for(const i in t){if(i===r&&n.bnodesToClear.includes(t[i])){delete t[r];continue}let s=w.removePreserve(e,t[i],n);const l=h(e,i,"@container")||[];n.compactArrays&&a(s)&&1===s.length&&0===l.length&&i!==o&&(s=s[0]),t[i]=s}}return t}},{"./JsonLdError":3,"./context":10,"./graphTypes":17,"./types":21,"./url":22,"./util":23}],9:[function(e,t,n){"use strict";const r="http://www.w3.org/1999/02/22-rdf-syntax-ns#",a="http://www.w3.org/2001/XMLSchema#";t.exports={LINK_HEADER_REL:"http://www.w3.org/ns/json-ld#context",RDF:r,RDF_LIST:r+"List",RDF_FIRST:r+"first",RDF_REST:r+"rest",RDF_NIL:r+"nil",RDF_TYPE:r+"type",RDF_PLAIN_LITERAL:r+"PlainLiteral",RDF_XML_LITERAL:r+"XMLLiteral",RDF_OBJECT:r+"object",RDF_LANGSTRING:r+"langString",XSD:a,XSD_BOOLEAN:a+"boolean",XSD_DOUBLE:a+"double",XSD_INTEGER:a+"integer",XSD_STRING:a+"string"}},{}],10:[function(e,t,n){"use strict";const r=e("./util"),a=e("./ActiveContextCache"),o=e("./JsonLdError"),{isArray:i,isObject:s,isString:l,isUndefined:u}=e("./types"),{isAbsolute:c,isRelative:d,prependBase:p,parse:f}=e("./url"),{asArray:h,compareShortestLeast:y}=e("./util"),g=10,v=new Map,m={};function b(e,t,n,r,a,o){if(null===t||!l(t)||m.isKeyword(t))return t;if(r&&r.hasOwnProperty(t)&&!0!==a.get(t)&&m.createTermDefinition(e,r,t,a,o),e.isPropertyTermScoped&&e.previousContext&&(e=e.previousContext),(n=n||{}).vocab){const n=e.mappings.get(t);if(null===n)return null;if(n)return n["@id"]}const i=t.indexOf(":");if(-1!==i){const n=t.substr(0,i),s=t.substr(i+1);return"_"===n||0===s.indexOf("//")?t:(r&&r.hasOwnProperty(n)&&m.createTermDefinition(e,r,n,a,o),e.mappings.has(n)?e.mappings.get(n)["@id"]+s:t)}return n.vocab&&"@vocab"in e?e["@vocab"]+t:n.base?p(e["@base"],t):t}function x(e,t,n,r){if(i(e))for(const a of e)x(a,t,n,r);else if(s(e))for(const a in e){if("@context"!==a){x(e[a],t,n,r);continue}const o=e[a];if(i(o)){let e=o.length;for(let a=0;a<e;++a){const u=o[a];if(l(u)){const s=p(r,u),l=t.get(s);n?i(l)?(Array.prototype.splice.apply(o,[a,1].concat(l)),a+=l.length-1,e=o.length):!1!==l&&(o[a]=l):void 0===l&&t.set(s,!1)}else for(const e in u)s(u[e])&&x(u[e],t,n,r)}}else if(l(o)){const i=p(r,o),s=t.get(i);n?!1!==s&&(e[a]=s):void 0===s&&t.set(i,!1)}else for(const e in o)s(o[e])&&x(o[e],t,n,r)}}t.exports=m,m.cache=new a,m.process=({activeCtx:e,localCtx:t,options:n,isPropertyTermScopedContext:a=!1,isTypeScopedContext:u=!1})=>{s(t)&&"@context"in t&&i(t["@context"])&&(t=t["@context"]);const y=h(t);if(0===y.length)return e;const g=e.previousContext||e;if(a&&e.previousContext)return(e=e.clone()).isPropertyTermScoped=!0,e.previousContext=m.process({activeCtx:e.previousContext,localCtx:y,options:n,isPropertyTermScopedContext:a}),e;let v=e;for(let i=0;i<y.length;++i){let h=y[i];if(e=v,null===h){if(!a&&0!==Object.keys(e.protected).length){const a=n&&n.protectedMode||"error";if("error"===a)throw new o("Tried to nullify a context with protected terms outside of a term definition.","jsonld.SyntaxError",{code:"invalid context nullification"});if("warn"===a){console.warn("WARNING: invalid context nullification");const t=e;v=e=m.getInitialContext(n).clone();for(const[n,a]of Object.entries(t.protected))a&&(e.mappings[n]=r.clone(t.mappings[n]));e.protected=r.clone(t.protected),m.cache&&m.cache.set(t,h,v);continue}throw new o("Invalid protectedMode.","jsonld.SyntaxError",{code:"invalid protected mode",context:t,protectedMode:a})}v=e=m.getInitialContext(n).clone(),u&&(v.previousContext=g.clone());continue}if(m.cache){const t=m.cache.get(e,h);if(t){v=e=t;continue}}if(s(h)&&"@context"in h&&(h=h["@context"]),!s(h))throw new o("Invalid JSON-LD syntax; @context must be an object.","jsonld.SyntaxError",{code:"invalid local context",context:h});v=v.clone();const b=new Map;if("@version"in h){if(1.1!==h["@version"])throw new o("Unsupported JSON-LD version: "+h["@version"],"jsonld.UnsupportedVersion",{code:"invalid @version value",context:h});if(e.processingMode&&"json-ld-1.0"===e.processingMode)throw new o("@version: "+h["@version"]+" not compatible with "+e.processingMode,"jsonld.ProcessingModeConflict",{code:"processing mode conflict",context:h});v.processingMode="json-ld-1.1",v["@version"]=h["@version"],b.set("@version",!0)}if(v.processingMode=v.processingMode||e.processingMode||"json-ld-1.0","@base"in h){let t=h["@base"];if(null===t);else if(c(t))t=f(t);else{if(!d(t))throw new o('Invalid JSON-LD syntax; the value of "@base" in a @context must be an absolute IRI, a relative IRI, or null.',"jsonld.SyntaxError",{code:"invalid base IRI",context:h});t=f(p(e["@base"].href,t))}v["@base"]=t,b.set("@base",!0)}if("@vocab"in h){const e=h["@vocab"];if(null===e)delete v["@vocab"];else{if(!l(e))throw new o('Invalid JSON-LD syntax; the value of "@vocab" in a @context must be a string or null.',"jsonld.SyntaxError",{code:"invalid vocab mapping",context:h});if(!c(e))throw new o('Invalid JSON-LD syntax; the value of "@vocab" in a @context must be an absolute IRI.',"jsonld.SyntaxError",{code:"invalid vocab mapping",context:h});v["@vocab"]=e}b.set("@vocab",!0)}if("@language"in h){const e=h["@language"];if(null===e)delete v["@language"];else{if(!l(e))throw new o('Invalid JSON-LD syntax; the value of "@language" in a @context must be a string or null.',"jsonld.SyntaxError",{code:"invalid default language",context:h});v["@language"]=e.toLowerCase()}b.set("@language",!0)}b.set("@protected",h["@protected"]||!1);for(const e in h)m.createTermDefinition(v,h,e,b,n,a);u&&!v.previousContext&&(v.previousContext=g.clone()),m.cache&&m.cache.set(e,h,v)}return v},m.createTermDefinition=(e,t,n,r,a,u=!1)=>{if(r.has(n)){if(r.get(n))return;throw new o("Cyclical context definition detected.","jsonld.CyclicalContext",{code:"cyclic IRI mapping",context:t,term:n})}if(r.set(n,!1),m.isKeyword(n))throw new o("Invalid JSON-LD syntax; keywords cannot be overridden.","jsonld.SyntaxError",{code:"keyword redefinition",context:t,term:n});if(""===n)throw new o("Invalid JSON-LD syntax; a term cannot be an empty string.","jsonld.SyntaxError",{code:"invalid term definition",context:t});const d=e.mappings.get(n);let p;if(e.mappings.has(n)&&e.mappings.delete(n),t.hasOwnProperty(n)&&(p=t[n]),null===p||s(p)&&null===p["@id"])return e.mappings.set(n,null),void r.set(n,!0);let f=!1;if(l(p)&&(f=!0,p={"@id":p}),!s(p))throw new o("Invalid JSON-LD syntax; @context term values must be strings or objects.","jsonld.SyntaxError",{code:"invalid term definition",context:t});const h={};e.mappings.set(n,h),h.reverse=!1;const y=["@container","@id","@language","@reverse","@type"];m.processingMode(e,1.1)&&y.push("@context","@nest","@prefix","@protected");for(const e in p)if(!y.includes(e))throw new o("Invalid JSON-LD syntax; a term definition must not contain "+e,"jsonld.SyntaxError",{code:"invalid term definition",context:t});const g=n.indexOf(":");if(h._termHasColon=-1!==g,"@reverse"in p){if("@id"in p)throw new o("Invalid JSON-LD syntax; a @reverse term definition must not contain @id.","jsonld.SyntaxError",{code:"invalid reverse property",context:t});if("@nest"in p)throw new o("Invalid JSON-LD syntax; a @reverse term definition must not contain @nest.","jsonld.SyntaxError",{code:"invalid reverse property",context:t});const n=p["@reverse"];if(!l(n))throw new o("Invalid JSON-LD syntax; a @context @reverse value must be a string.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:t});const i=b(e,n,{vocab:!0,base:!1},t,r,a);if(!c(i))throw new o("Invalid JSON-LD syntax; a @context @reverse value must be an absolute IRI or a blank node identifier.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:t});h["@id"]=i,h.reverse=!0}else if("@id"in p){let i=p["@id"];if(!l(i))throw new o("Invalid JSON-LD syntax; a @context @id value must be an array of strings or a string.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:t});if(i!==n){if(i=b(e,i,{vocab:!0,base:!1},t,r,a),!c(i)&&!m.isKeyword(i))throw new o("Invalid JSON-LD syntax; a @context @id value must be an absolute IRI, a blank node identifier, or a keyword.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:t});h["@id"]=i,h._prefix=!h._termHasColon&&i.match(/[:\/\?#\[\]@]$/)&&(f||m.processingMode(e,1))}}if(!("@id"in h))if(h._termHasColon){const o=n.substr(0,g);if(t.hasOwnProperty(o)&&m.createTermDefinition(e,t,o,r,a),e.mappings.has(o)){const t=n.substr(g+1);h["@id"]=e.mappings.get(o)["@id"]+t}else h["@id"]=n}else{if(!("@vocab"in e))throw new o("Invalid JSON-LD syntax; @context terms must define an @id.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:t,term:n});h["@id"]=e["@vocab"]+n}if((!0===p["@protected"]||!0===r.get("@protected")&&!1!==p["@protected"])&&(e.protected[n]=!0,h.protected=!0),r.set(n,!0),"@type"in p){let n=p["@type"];if(!l(n))throw new o("Invalid JSON-LD syntax; an @context @type value must be a string.","jsonld.SyntaxError",{code:"invalid type mapping",context:t});if("@id"!==n&&"@vocab"!==n){if(n=b(e,n,{vocab:!0,base:!1},t,r,a),!c(n))throw new o("Invalid JSON-LD syntax; an @context @type value must be an absolute IRI.","jsonld.SyntaxError",{code:"invalid type mapping",context:t});if(0===n.indexOf("_:"))throw new o("Invalid JSON-LD syntax; an @context @type value must be an IRI, not a blank node identifier.","jsonld.SyntaxError",{code:"invalid type mapping",context:t})}h["@type"]=n}if("@container"in p){const n=l(p["@container"])?[p["@container"]]:p["@container"]||[],r=["@list","@set","@index","@language"];let a=!0;const s=n.includes("@set");if(m.processingMode(e,1.1))if(r.push("@graph","@id","@type"),n.includes("@list")){if(1!==n.length)throw new o("Invalid JSON-LD syntax; @context @container with @list must have no other values","jsonld.SyntaxError",{code:"invalid container mapping",context:t})}else if(n.includes("@graph")){if(n.some(e=>"@graph"!==e&&"@id"!==e&&"@index"!==e&&"@set"!==e))throw new o("Invalid JSON-LD syntax; @context @container with @graph must have no other values other than @id, @index, and @set","jsonld.SyntaxError",{code:"invalid container mapping",context:t})}else a&=n.length<=(s?2:1);else a&=!i(p["@container"]),a&=n.length<=1;if(a&=n.every(e=>r.includes(e)),!(a&=!(s&&n.includes("@list"))))throw new o("Invalid JSON-LD syntax; @context @container value must be one of the following: "+r.join(", "),"jsonld.SyntaxError",{code:"invalid container mapping",context:t});if(h.reverse&&!n.every(e=>["@index","@set"].includes(e)))throw new o("Invalid JSON-LD syntax; @context @container value for a @reverse type definition must be @index or @set.","jsonld.SyntaxError",{code:"invalid reverse property",context:t});h["@container"]=n}if("@context"in p&&(h["@context"]=p["@context"]),"@language"in p&&!("@type"in p)){let e=p["@language"];if(null!==e&&!l(e))throw new o("Invalid JSON-LD syntax; @context @language value must be a string or null.","jsonld.SyntaxError",{code:"invalid language mapping",context:t});null!==e&&(e=e.toLowerCase()),h["@language"]=e}if("@prefix"in p){if(h._termHasColon)throw new o("Invalid JSON-LD syntax; @context @prefix used on a compact IRI term","jsonld.SyntaxError",{code:"invalid term definition",context:t});if("boolean"!=typeof p["@prefix"])throw new o("Invalid JSON-LD syntax; @context value for @prefix must be boolean","jsonld.SyntaxError",{code:"invalid @prefix value",context:t});h._prefix=!0===p["@prefix"]}if("@nest"in p){const e=p["@nest"];if(!l(e)||"@nest"!==e&&0===e.indexOf("@"))throw new o("Invalid JSON-LD syntax; @context @nest value must be a string which is not a keyword other than @nest.","jsonld.SyntaxError",{code:"invalid @nest value",context:t});h["@nest"]=e}const v=h["@id"];if("@context"===v||"@preserve"===v)throw new o("Invalid JSON-LD syntax; @context and @preserve cannot be aliased.","jsonld.SyntaxError",{code:"invalid keyword alias",context:t});if(d&&d.protected&&!u&&(e.protected[n]=!0,h.protected=!0,!function e(t,n){if(!t||"object"!=typeof t||!n||"object"!=typeof n)return t===n;const r=Array.isArray(t);if(r!==Array.isArray(n))return!1;if(r){if(t.length!==n.length)return!1;for(let r=0;r<t.length;++r)if(!e(t[r],n[r]))return!1;return!0}const a=Object.keys(t),o=Object.keys(n);if(a.length!==o.length)return!1;for(const r in t){let a=t[r],o=n[r];if("@container"===r&&Array.isArray(a)&&Array.isArray(o)&&(a=a.slice().sort(),o=o.slice().sort()),!e(a,o))return!1}return!0}(d,h))){const e=a&&a.protectedMode||"error";if("error"===e)throw new o("Invalid JSON-LD syntax; tried to redefine a protected term.","jsonld.SyntaxError",{code:"protected term redefinition",context:t,term:n});if("warn"===e)return void console.warn("WARNING: protected term redefinition",{term:n});throw new o("Invalid protectedMode.","jsonld.SyntaxError",{code:"invalid protected mode",context:t,term:n,protectedMode:e})}},m.expandIri=(e,t,n,r)=>b(e,t,n,void 0,void 0,r),m.getInitialContext=e=>{const t=f(e.base||""),n=JSON.stringify({base:t,processingMode:e.processingMode}),a=v.get(n);if(a)return a;const o={"@base":t,processingMode:e.processingMode,mappings:new Map,inverse:null,getInverse:function(){const e=this;if(e.inverse)return e.inverse;const t=e.inverse={},n=e.fastCurieMap={},r={},a=e["@language"]||"@none",o=e.mappings,l=[...o.keys()].sort(y);for(const e of l){const i=o.get(e);if(null===i)continue;let l=i["@container"]||"@none";l=[].concat(l).sort().join("");const u=h(i["@id"]);for(const o of u){let u=t[o];const c=m.isKeyword(o);if(u)c||i._termHasColon||r[o].push(e);else if(t[o]=u={},!c&&!i._termHasColon){r[o]=[e];const t={iri:o,terms:r[o]};o[0]in n?n[o[0]].push(t):n[o[0]]=[t]}if(u[l]||(u[l]={"@language":{},"@type":{},"@any":{}}),u=u[l],s(e,u["@any"],"@none"),i.reverse)s(e,u["@type"],"@reverse");else if("@type"in i)s(e,u["@type"],i["@type"]);else if("@language"in i){const t=i["@language"]||"@null";s(e,u["@language"],t)}else s(e,u["@language"],a),s(e,u["@type"],"@none"),s(e,u["@language"],"@none")}}for(const e in n)i(n,e,1);return t},clone:function(){const e={};return e["@base"]=this["@base"],e.mappings=r.clone(this.mappings),e.clone=this.clone,e.inverse=null,e.getInverse=this.getInverse,e.protected=r.clone(this.protected),this.previousContext&&(e.isPropertyTermScoped=this.previousContext.isPropertyTermScoped,e.previousContext=this.previousContext.clone()),e.revertTypeScopedContext=this.revertTypeScopedContext,"@language"in this&&(e["@language"]=this["@language"]),"@vocab"in this&&(e["@vocab"]=this["@vocab"]),e},revertTypeScopedContext:function(){return this.previousContext?this.previousContext.clone():this},protected:{}};return 1e4===v.size&&v.clear(),v.set(n,o),o;function i(e,t,n){const r=e[t],a=e[t]={};let o,s;for(const e of r)(s=n>=(o=e.iri).length?"":o[n])in a?a[s].push(e):a[s]=[e];for(const e in a)""!==e&&i(a,e,n+1)}function s(e,t,n){t.hasOwnProperty(n)||(t[n]=e)}},m.getContextValue=(e,t,n)=>{if(null===t){if("@context"===n)return;return null}if(e.mappings.has(t)){const r=e.mappings.get(t);if(u(n))return r;if(r.hasOwnProperty(n))return r[n]}return"@language"===n&&e.hasOwnProperty(n)?e[n]:"@context"!==n?null:void 0},m.getAllContexts=async(e,t)=>(async function(e,t){const n=r.normalizeDocumentLoader(t.documentLoader);return await async function e(n,r,a){if(r.size>g)throw new o("Maximum number of @context URLs exceeded.","jsonld.ContextUrlError",{code:"loading remote context failed",max:g});const u=new Map;if(x(n,u,!1,t.base),0===u.size)return;const c=[...u.keys()].filter(e=>!1===u.get(e));return Promise.all(c.map(async c=>{if(r.has(c))throw new o("Cyclical @context URLs detected.","jsonld.ContextUrlError",{code:"recursive context inclusion",url:c});const d=new Set(r);let p,f;d.add(c);try{p=await a(c),f=p.document||null,l(f)&&(f=JSON.parse(f))}catch(e){throw new o("Dereferencing a URL did not result in a valid JSON-LD object. Possible causes are an inaccessible URL perhaps due to a same-origin policy (ensure the server uses CORS if you are using client-side JavaScript), too many redirects, a non-JSON response, or more than one HTTP Link Header was provided for a remote context.","jsonld.InvalidUrl",{code:"loading remote context failed",url:c,cause:e})}if(!s(f))throw new o("Dereferencing a URL did not result in a JSON object. The response was valid JSON, but it was not a JSON object.","jsonld.InvalidUrl",{code:"invalid remote context",url:c});f="@context"in f?{"@context":f["@context"]}:{"@context":{}},p.contextUrl&&(i(f["@context"])||(f["@context"]=[f["@context"]]),f["@context"].push(p.contextUrl)),await e(f,d,a),u.set(c,f["@context"]),x(n,u,!0,t.base)}))}(e,new Set,n),e})(e,t),m.processingMode=(e,t)=>t.toString()>="1.1"?e.processingMode&&e.processingMode>="json-ld-"+t.toString():!e.processingMode||"json-ld-1.0"===e.processingMode,m.isKeyword=e=>{if(!l(e))return!1;switch(e){case"@base":case"@container":case"@context":case"@default":case"@embed":case"@explicit":case"@graph":case"@id":case"@index":case"@language":case"@list":case"@nest":case"@none":case"@omitDefault":case"@prefix":case"@preserve":case"@protected":case"@requireAll":case"@reverse":case"@set":case"@type":case"@value":case"@version":case"@vocab":return!0}return!1}},{"./ActiveContextCache":2,"./JsonLdError":3,"./types":21,"./url":22,"./util":23}],11:[function(e,t,n){"use strict";const{parseLinkHeader:r,buildHeaders:a}=e("../util"),{LINK_HEADER_REL:o}=e("../constants"),i=e("../JsonLdError"),s=e("../RequestQueue");t.exports=({secure:t,strictSSL:n=!0,maxRedirects:l=-1,request:u,headers:c={}}={strictSSL:!0,maxRedirects:-1,headers:{}})=>{c=a(c),u=u||e("request");const d=e("http");return(new s).wrapLoader(function(e){return async function e(a,s){if(0!==a.indexOf("http:")&&0!==a.indexOf("https:"))throw new i('URL could not be dereferenced; only "http" and "https" URLs are supported.',"jsonld.InvalidUrl",{code:"loading document failed",url:a});if(t&&0!==a.indexOf("https"))throw new i('URL could not be dereferenced; secure mode is enabled and the URL\'s scheme is not "https".',"jsonld.InvalidUrl",{code:"loading document failed",url:a});let p,f=null;if(null!==f)return f;try{p=await function(e,t){return new Promise((n,r)=>{e(t,(e,t,a)=>{e?r(e):n({res:t,body:a})})})}(u,{url:a,headers:c,strictSSL:n,followRedirect:!1})}catch(e){throw new i("URL could not be dereferenced, an error occurred.","jsonld.LoadDocumentError",{code:"loading document failed",url:a,cause:e})}const{res:h,body:y}=p;f={contextUrl:null,documentUrl:a,document:y||null};const g=d.STATUS_CODES[h.statusCode];if(h.statusCode>=400)throw new i("URL could not be dereferenced: "+g,"jsonld.InvalidUrl",{code:"loading document failed",url:a,httpStatusCode:h.statusCode});if(h.headers.link&&"application/ld+json"!==h.headers["content-type"]){const e=r(h.headers.link)[o];if(Array.isArray(e))throw new i("URL could not be dereferenced, it has more than one associated HTTP Link Header.","jsonld.InvalidUrl",{code:"multiple context link headers",url:a});e&&(f.contextUrl=e.target)}if(h.statusCode>=300&&h.statusCode<400&&h.headers.location){if(s.length===l)throw new i("URL could not be dereferenced; there were too many redirects.","jsonld.TooManyRedirects",{code:"loading document failed",url:a,httpStatusCode:h.statusCode,redirects:s});if(-1!==s.indexOf(a))throw new i("URL could not be dereferenced; infinite redirection was detected.","jsonld.InfiniteRedirectDetected",{code:"recursive context inclusion",url:a,httpStatusCode:h.statusCode,redirects:s});return s.push(a),e(h.headers.location,s)}return s.push(a),f}(e,[])})}},{"../JsonLdError":3,"../RequestQueue":7,"../constants":9,"../util":23,http:1,request:1}],12:[function(e,t,n){"use strict";const{parseLinkHeader:r,buildHeaders:a}=e("../util"),{LINK_HEADER_REL:o}=e("../constants"),i=e("../JsonLdError"),s=e("../RequestQueue"),l=/(^|(\r\n))link:/i;t.exports=({secure:e,headers:t={},xhr:n}={headers:{}})=>(t=a(t),(new s).wrapLoader(async function(a){if(0!==a.indexOf("http:")&&0!==a.indexOf("https:"))throw new i('URL could not be dereferenced; only "http" and "https" URLs are supported.',"jsonld.InvalidUrl",{code:"loading document failed",url:a});if(e&&0!==a.indexOf("https"))throw new i('URL could not be dereferenced; secure mode is enabled and the URL\'s scheme is not "https".',"jsonld.InvalidUrl",{code:"loading document failed",url:a});let s;try{s=await function(e,t,n){const r=new(e=e||XMLHttpRequest);return new Promise((e,a)=>{r.onload=()=>e(r),r.onerror=e=>a(e),r.open("GET",t,!0);for(const e in n)r.setRequestHeader(e,n[e]);r.send()})}(n,a,t)}catch(e){throw new i("URL could not be dereferenced, an error occurred.","jsonld.LoadDocumentError",{code:"loading document failed",url:a,cause:e})}if(s.status>=400)throw new i("URL could not be dereferenced: "+s.statusText,"jsonld.LoadDocumentError",{code:"loading document failed",url:a,httpStatusCode:s.status});const u={contextUrl:null,documentUrl:a,document:s.response},c=s.getResponseHeader("Content-Type");let d;if(l.test(s.getAllResponseHeaders())&&(d=s.getResponseHeader("Link")),d&&"application/ld+json"!==c){if(d=r(d)[o],Array.isArray(d))throw new i("URL could not be dereferenced, it has more than one associated HTTP Link Header.","jsonld.InvalidUrl",{code:"multiple context link headers",url:a});d&&(u.contextUrl=d.target)}return u}))},{"../JsonLdError":3,"../RequestQueue":7,"../constants":9,"../util":23}],13:[function(e,t,n){"use strict";const r=e("./JsonLdError"),{isArray:a,isObject:o,isEmptyObject:i,isString:s,isUndefined:l}=e("./types"),{isList:u,isValue:c,isGraph:d}=e("./graphTypes"),{expandIri:p,getContextValue:f,isKeyword:h,process:y}=e("./context"),{isAbsolute:g}=e("./url"),{addValue:v,asArray:m,getValues:b,validateTypeValue:x}=e("./util"),w={};function I(e,t,n){const o=[],i=Object.keys(t).sort();for(const l of i){const i=p(e,l,{vocab:!0},n);let u=t[l];a(u)||(u=[u]);for(const e of u){if(null===e)continue;if(!s(e))throw new r("Invalid JSON-LD syntax; language map values must be strings.","jsonld.SyntaxError",{code:"invalid language map value",languageMap:t});const n={"@value":e};"@none"!==i&&(n["@language"]=l.toLowerCase()),o.push(n)}}return o}function S({activeCtx:e,options:t,activeProperty:n,value:r,expansionMap:o,asGraph:i,indexKey:s}){const u=[],c=Object.keys(r).sort(),h="@type"===s;for(let g of c){if(h){const n=f(e,g,"@context");l(n)||(e=y({activeCtx:e,localCtx:n,isTypeScopedContext:!0,options:t}))}let c=r[g];a(c)||(c=[c]);const v=p(e,g,{vocab:!0},t);"@id"===s?g=p(e,g,{base:!0},t):h&&(g=v),c=w.expand({activeCtx:e,activeProperty:n,element:c,options:t,insideList:!1,insideIndex:!0,expansionMap:o});for(let e of c)i&&!d(e)&&(e={"@graph":[e]}),"@type"===s?"@none"===v||(e["@type"]?e["@type"]=[g].concat(e["@type"]):e["@type"]=[g]):"@none"===v||s in e||(e[s]=g),u.push(e)}return u}t.exports=w,w.expand=({activeCtx:e,activeProperty:t=null,element:n,options:O={},insideList:C=!1,insideIndex:k=!1,typeScopedContext:A=null,expansionMap:j=(()=>void 0)})=>{if(null==n)return null;if("@default"===t&&(O=Object.assign({},O,{isFrame:!1})),!a(n)&&!o(n)){if(!C&&(null===t||"@graph"===p(e,t,{vocab:!0},O))){const r=j({unmappedValue:n,activeCtx:e,activeProperty:t,options:O,insideList:C});return void 0===r?null:r}return function({activeCtx:e,activeProperty:t,value:n,options:r}){if(null==n)return null;const a=p(e,t,{vocab:!0},r);if("@id"===a)return p(e,n,{base:!0},r);if("@type"===a)return p(e,n,{vocab:!0,base:!0},r);const o=f(e,t,"@type");if(("@id"===o||"@graph"===a)&&s(n))return{"@id":p(e,n,{base:!0},r)};if("@vocab"===o&&s(n))return{"@id":p(e,n,{vocab:!0,base:!0},r)};if(h(a))return n;const i={};if(o&&!["@id","@vocab"].includes(o))i["@type"]=o;else if(s(n)){const n=f(e,t,"@language");null!==n&&(i["@language"]=n)}return["boolean","number","string"].includes(typeof n)||(n=n.toString()),i["@value"]=n,i}({activeCtx:e,activeProperty:t,value:n,options:O})}if(a(n)){let o=[];const i=f(e,t,"@container")||[];C=C||i.includes("@list");for(let i=0;i<n.length;++i){let s=w.expand({activeCtx:e,activeProperty:t,element:n[i],options:O,expansionMap:j,insideIndex:k,typeScopedContext:A});if(C&&(a(s)||u(s)))throw new r("Invalid JSON-LD syntax; lists of lists are not permitted.","jsonld.SyntaxError",{code:"list of lists"});null===s&&void 0===(s=j({unmappedValue:n[i],activeCtx:e,activeProperty:t,parent:n,index:i,options:O,expandedParent:o,insideList:C}))||(a(s)?o=o.concat(s):o.push(s))}return o}const T=p(e,t,{vocab:!0},O);A=A||(e.previousContext?e:null);let N=Object.keys(n).sort(),D=!k;if(D&&A&&N.length<=2&&!N.includes("@context"))for(const t of N){const n=p(A,t,{vocab:!0},O);if("@value"===n){D=!1,e=A;break}if("@id"===n&&1===N.length){D=!1;break}}D&&(e=e.revertTypeScopedContext()),"@context"in n&&(e=y({activeCtx:e,localCtx:n["@context"],options:O}));for(const t of N)if("@type"===p(e,t,{vocab:!0},O)){const r=n[t],a=Array.isArray(r)?r.length>1?r.slice().sort():r:[r];for(const t of a){const n=f(e.previousContext||e,t,"@context");l(n)||(e=y({activeCtx:e,localCtx:n,options:O,isTypeScopedContext:!0}))}}let L={};!function e({activeCtx:t,activeProperty:n,expandedActiveProperty:b,element:O,expandedParent:C,options:k={},insideList:A,expansionMap:j}){const T=Object.keys(O).sort(),N=[];for(const e of T){let T,D=O[e];if("@context"===e)continue;let L=p(t,e,{vocab:!0},k);if((null===L||!g(L)&&!h(L))&&void 0===(L=j({unmappedProperty:e,activeCtx:t,activeProperty:n,parent:O,options:k,insideList:A,value:D,expandedParent:C})))continue;if(h(L)){if("@reverse"===b)throw new r("Invalid JSON-LD syntax; a keyword cannot be used as a @reverse property.","jsonld.SyntaxError",{code:"invalid reverse property map",value:D});if(L in C)throw new r("Invalid JSON-LD syntax; colliding keywords detected.","jsonld.SyntaxError",{code:"colliding keywords",keyword:L})}if("@id"===L){if(!s(D)){if(!k.isFrame)throw new r('Invalid JSON-LD syntax; "@id" value must a string.',"jsonld.SyntaxError",{code:"invalid @id value",value:D});if(o(D)){if(!i(D))throw new r('Invalid JSON-LD syntax; "@id" value an empty object or array of strings, if framing',"jsonld.SyntaxError",{code:"invalid @id value",value:D})}else{if(!a(D))throw new r('Invalid JSON-LD syntax; "@id" value an empty object or array of strings, if framing',"jsonld.SyntaxError",{code:"invalid @id value",value:D});if(!D.every(e=>s(e)))throw new r('Invalid JSON-LD syntax; "@id" value an empty object or array of strings, if framing',"jsonld.SyntaxError",{code:"invalid @id value",value:D})}}v(C,"@id",m(D).map(e=>s(e)?p(t,e,{base:!0},k):e),{propertyIsArray:k.isFrame});continue}if("@type"===L){x(D),v(C,"@type",m(D).map(e=>s(e)?p(t.previousContext||t,e,{base:!0,vocab:!0},k):e),{propertyIsArray:k.isFrame});continue}if("@graph"===L&&!o(D)&&!a(D))throw new r('Invalid JSON-LD syntax; "@graph" value must not be an object or an array.',"jsonld.SyntaxError",{code:"invalid @graph value",value:D});if("@value"===L){if((o(D)||a(D))&&!k.isFrame)throw new r('Invalid JSON-LD syntax; "@value" value must not be an object or an array.',"jsonld.SyntaxError",{code:"invalid value object value",value:D});v(C,"@value",D,{propertyIsArray:k.isFrame});continue}if("@language"===L){if(null===D)continue;if(!s(D)&&!k.isFrame)throw new r('Invalid JSON-LD syntax; "@language" value must be a string.',"jsonld.SyntaxError",{code:"invalid language-tagged string",value:D});D=m(D).map(e=>s(e)?e.toLowerCase():e),v(C,"@language",D,{propertyIsArray:k.isFrame});continue}if("@index"===L){if(!s(D))throw new r('Invalid JSON-LD syntax; "@index" value must be a string.',"jsonld.SyntaxError",{code:"invalid @index value",value:D});v(C,"@index",D);continue}if("@reverse"===L){if(!o(D))throw new r('Invalid JSON-LD syntax; "@reverse" value must be an object.',"jsonld.SyntaxError",{code:"invalid @reverse value",value:D});if("@reverse"in(T=w.expand({activeCtx:t,activeProperty:"@reverse",element:D,options:k,expansionMap:j})))for(const e in T["@reverse"])v(C,e,T["@reverse"][e],{propertyIsArray:!0});let e=C["@reverse"]||null;for(const t in T){if("@reverse"===t)continue;null===e&&(e=C["@reverse"]={}),v(e,t,[],{propertyIsArray:!0});const n=T[t];for(let a=0;a<n.length;++a){const o=n[a];if(c(o)||u(o))throw new r('Invalid JSON-LD syntax; "@reverse" value must not be a @value or an @list.',"jsonld.SyntaxError",{code:"invalid reverse property value",value:T});v(e,t,o,{propertyIsArray:!0})}}continue}if("@nest"===L){N.push(e);continue}let E=t;const R=f(t,e,"@context");l(R)||(E=y({activeCtx:t,localCtx:R,isPropertyTermScopedContext:!0,options:k}));const _=f(E,e,"@container")||[];if(_.includes("@language")&&o(D))T=I(E,D,k);else if(_.includes("@index")&&o(D)){const t=_.includes("@graph");T=S({activeCtx:E,options:k,activeProperty:e,value:D,expansionMap:j,asGraph:t,indexKey:"@index"})}else if(_.includes("@id")&&o(D)){const t=_.includes("@graph");T=S({activeCtx:E,options:k,activeProperty:e,value:D,expansionMap:j,asGraph:t,indexKey:"@id"})}else if(_.includes("@type")&&o(D))T=S({activeCtx:E.revertTypeScopedContext(),options:k,activeProperty:e,value:D,expansionMap:j,asGraph:!1,indexKey:"@type"});else{const t="@list"===L;if(t||"@set"===L){let e=n;if(t&&"@graph"===b&&(e=null),T=w.expand({activeCtx:E,activeProperty:e,element:D,options:k,insideList:t,expansionMap:j}),t&&u(T))throw new r("Invalid JSON-LD syntax; lists of lists are not permitted.","jsonld.SyntaxError",{code:"list of lists"})}else T=w.expand({activeCtx:E,activeProperty:e,element:D,options:k,insideList:!1,expansionMap:j})}if(null===T&&"@value"!==L&&void 0===(T=j({unmappedValue:D,expandedProperty:L,activeCtx:E,activeProperty:n,parent:O,options:k,insideList:A,key:e,expandedParent:C})))continue;if("@list"!==L&&!u(T)&&_.includes("@list")&&(T={"@list":m(T)}),_.includes("@graph")&&!_.some(e=>"@id"===e||"@index"===e)&&(T=m(T).map(e=>d(e)?e:{"@graph":m(e)})),E.mappings.has(e)&&E.mappings.get(e).reverse){const e=C["@reverse"]=C["@reverse"]||{};T=m(T);for(let t=0;t<T.length;++t){const n=T[t];if(c(n)||u(n))throw new r('Invalid JSON-LD syntax; "@reverse" value must not be a @value or an @list.',"jsonld.SyntaxError",{code:"invalid reverse property value",value:T});v(e,L,n,{propertyIsArray:!0})}continue}const B=!["@index","@id","@type","@value","@language"].includes(L);v(C,L,T,{propertyIsArray:B})}for(const i of N){const s=a(O[i])?O[i]:[O[i]];for(const a of s){if(!o(a)||Object.keys(a).some(e=>"@value"===p(t,e,{vocab:!0},k)))throw new r("Invalid JSON-LD syntax; nested value must be a node object.","jsonld.SyntaxError",{code:"invalid @nest value",value:a});e({activeCtx:t,activeProperty:n,expandedActiveProperty:b,element:a,expandedParent:C,options:k,insideList:A,expansionMap:j})}}}({activeCtx:e,activeProperty:t,expandedActiveProperty:T,element:n,expandedParent:L,options:O,insideList:C,typeScopedContext:A,expansionMap:j});let E=(N=Object.keys(L)).length;if("@value"in L){if("@type"in L&&"@language"in L)throw new r('Invalid JSON-LD syntax; an element containing "@value" may not contain both "@type" and "@language".',"jsonld.SyntaxError",{code:"invalid value object",element:L});let a=E-1;if("@type"in L&&(a-=1),"@index"in L&&(a-=1),"@language"in L&&(a-=1),0!==a)throw new r('Invalid JSON-LD syntax; an element containing "@value" may only have an "@index" property and at most one other property which can be "@type" or "@language".',"jsonld.SyntaxError",{code:"invalid value object",element:L});const o=null===L["@value"]?[]:m(L["@value"]),l=b(L,"@type");if(0===o.length){const r=j({unmappedValue:L,activeCtx:e,activeProperty:t,element:n,options:O,insideList:C});L=void 0!==r?r:null}else{if(!o.every(e=>s(e)||i(e))&&"@language"in L)throw new r("Invalid JSON-LD syntax; only strings may be language-tagged.","jsonld.SyntaxError",{code:"invalid language-tagged value",element:L});if(!l.every(e=>g(e)&&!(s(e)&&0===e.indexOf("_:"))||i(e)))throw new r('Invalid JSON-LD syntax; an element containing "@value" and "@type" must have an absolute IRI for the value of "@type".',"jsonld.SyntaxError",{code:"invalid typed value",element:L})}}else if("@type"in L&&!a(L["@type"]))L["@type"]=[L["@type"]];else if("@set"in L||"@list"in L){if(E>1&&!(2===E&&"@index"in L))throw new r('Invalid JSON-LD syntax; if an element has the property "@set" or "@list", then it can have at most one other property that is "@index".',"jsonld.SyntaxError",{code:"invalid set or list object",element:L});"@set"in L&&(L=L["@set"],E=(N=Object.keys(L)).length)}else if(1===E&&"@language"in L){const r=j(L,{unmappedValue:L,activeCtx:e,activeProperty:t,element:n,options:O,insideList:C});L=void 0!==r?r:null}if(o(L)&&!O.keepFreeFloatingNodes&&!C&&(null===t||"@graph"===T)&&(0===E||"@value"in L||"@list"in L||1===E&&"@id"in L)){const r=j({unmappedValue:L,activeCtx:e,activeProperty:t,element:n,options:O,insideList:C});L=void 0!==r?r:null}return L}},{"./JsonLdError":3,"./context":10,"./graphTypes":17,"./types":21,"./url":22,"./util":23}],14:[function(e,t,n){"use strict";const{isSubjectReference:r}=e("./graphTypes"),{createMergedNodeMap:a}=e("./nodeMap"),o={};t.exports=o,o.flatten=e=>{const t=a(e),n=[],o=Object.keys(t).sort();for(let e=0;e<o.length;++e){const a=t[o[e]];r(a)||n.push(a)}return n}},{"./graphTypes":17,"./nodeMap":19}],15:[function(e,t,n){"use strict";const{isKeyword:r}=e("./context"),a=e("./graphTypes"),o=e("./types"),i=e("./util"),s=e("./JsonLdError"),{createNodeMap:l,mergeNodeMapGraphs:u}=e("./nodeMap"),c={};function d(e){const t={};for(const n in e)void 0!==e[n]&&(t["@"+n]=[e[n]]);return[t]}function p(e,t,n){for(let r=n.length-1;r>=0;--r){const a=n[r];if(a.graph===t&&a.subject["@id"]===e["@id"])return!0}return!1}function f(e,t,n){const r="@"+n;let a=r in e?e[r][0]:t[n];return"embed"===n&&(!0===a?a="@last":!1===a?a="@never":"@always"!==a&&"@never"!==a&&"@link"!==a&&(a="@last")),a}function h(e){if(!o.isArray(e)||1!==e.length||!o.isObject(e[0]))throw new s("Invalid JSON-LD syntax; a JSON-LD frame must be a single object.","jsonld.SyntaxError",{frame:e})}function y(e,t,n,s){let l=!0,u=!1;for(const c in n){let d=!1;const p=i.getValues(t,c),f=0===i.getValues(n,c).length;if(r(c)){if("@id"!==c&&"@type"!==c)continue;if(l=!1,"@id"===c){if(n["@id"].length>=0&&!o.isEmptyObject(n["@id"][0]))return n["@id"].includes(p[0]);d=!0;continue}if("@type"in n)if(f){if(p.length>0)return!1;d=!0}else{if(1!==n["@type"].length||!o.isEmptyObject(n["@type"][0])){for(const e of n["@type"])if(p.some(t=>t===e))return!0;return!1}d=p.length>0}}const y=i.getValues(n,c)[0];let g=!1;if(y&&(h([y]),g="@default"in y),l=!1,0!==p.length||!g){if(p.length>0&&f)return!1;if(void 0===y){if(p.length>0)return!1;d=!0}else if(o.isObject(y))d=p.length>0;else if(a.isValue(y))d=p.some(e=>b(y,e));else if(a.isSubject(y)||a.isSubjectReference(y))d=p.some(t=>m(e,y,t,s));else if(a.isList(y)){const t=y["@list"][0];if(a.isList(p[0])){const n=p[0]["@list"];a.isValue(t)?d=n.some(e=>b(t,e)):(a.isSubject(t)||a.isSubjectReference(t))&&(d=n.some(n=>m(e,t,n,s)))}else d=!1}if(!d&&s.requireAll)return!1;u=u||d}}return l||u}function g(e,t){const n=e.uniqueEmbeds[e.graph],r=n[t],a=r.parent,s=r.property,l={"@id":t};if(o.isArray(a)){for(let e=0;e<a.length;++e)if(i.compareValues(a[e],l)){a[e]=l;break}}else{const e=o.isArray(a[s]);i.removeValue(a,s,l,{propertyIsArray:e}),i.addValue(a,s,l,{propertyIsArray:e})}const u=e=>{const t=Object.keys(n);for(const r of t)r in n&&o.isObject(n[r].parent)&&n[r].parent["@id"]===e&&(delete n[r],u(r))};u(t)}function v(e,t,n){o.isObject(e)?i.addValue(e,t,n,{propertyIsArray:!0}):e.push(n)}function m(e,t,n,r){if(!("@id"in n))return!1;const a=e.subjects[n["@id"]];return a&&y(e,a,t,r)}function b(e,t){const n=t["@value"],r=t["@type"],a=t["@language"],i=e["@value"]?o.isArray(e["@value"])?e["@value"]:[e["@value"]]:[],s=e["@type"]?o.isArray(e["@type"])?e["@type"]:[e["@type"]]:[],l=e["@language"]?o.isArray(e["@language"])?e["@language"]:[e["@language"]]:[];return 0===i.length&&0===s.length&&0===l.length||!(!i.includes(n)&&!o.isEmptyObject(i[0]))&&!!(!r&&0===s.length||s.includes(r)||r&&o.isEmptyObject(s[0]))&&!!(!a&&0===l.length||l.includes(a)||a&&o.isEmptyObject(l[0]))}t.exports=c,c.frameMergedOrDefault=(e,t,n)=>{const r={options:n,graph:"@default",graphMap:{"@default":{}},graphStack:[],subjectStack:[],link:{},bnodeMap:{}},a=new i.IdentifierIssuer("_:b");l(e,r.graphMap,"@default",a),n.merged&&(r.graphMap["@merged"]=u(r.graphMap),r.graph="@merged"),r.subjects=r.graphMap[r.graph];const o=[];return c.frame(r,Object.keys(r.subjects).sort(),t,o),n.pruneBlankNodeIdentifiers&&(n.bnodesToClear=Object.keys(r.bnodeMap).filter(e=>1===r.bnodeMap[e].length)),o},c.frame=(e,t,n,s,l=null)=>{h(n),n=n[0];const u=e.options,m={embed:f(n,u,"embed"),explicit:f(n,u,"explicit"),requireAll:f(n,u,"requireAll")},x=function(e,t,n,r){const a={};for(const o of t){const t=e.graphMap[e.graph][o];y(e,t,n,r)&&(a[o]=t)}return a}(e,t,n,m),w=Object.keys(x).sort();for(const t of w){const h=x[t];if("@link"===m.embed&&t in e.link){v(s,l,e.link[t]);continue}null===l?e.uniqueEmbeds={[e.graph]:{}}:e.uniqueEmbeds[e.graph]=e.uniqueEmbeds[e.graph]||{};const y={};if(y["@id"]=t,0===t.indexOf("_:")&&i.addValue(e.bnodeMap,t,y,{propertyIsArray:!0}),e.link[t]=y,"@never"===m.embed||p(h,e.graph,e.subjectStack))v(s,l,y);else{if("@last"===m.embed&&(t in e.uniqueEmbeds[e.graph]&&g(e,t),e.uniqueEmbeds[e.graph][t]={parent:s,property:l}),e.subjectStack.push({subject:h,graph:e.graph}),t in e.graphMap){let r=!1,a=null;"@graph"in n?(a=n["@graph"][0],o.isObject(a)||(a={}),r=!("@merged"===t||"@default"===t)):(r="@merged"!==e.graph,a={}),r&&(e.graphStack.push(e.graph),e.graph=t,c.frame(e,Object.keys(e.graphMap[t]).sort(),[a],y,"@graph"),e.graph=e.graphStack.pop)}for(const t of Object.keys(h).sort())if(r(t)){if(y[t]=i.clone(h[t]),"@type"===t)for(const t of h["@type"])0===t.indexOf("_:")&&i.addValue(e.bnodeMap,t,y,{propertyIsArray:!0})}else if(!m.explicit||t in n)for(let r of h[t]){const o=t in n?n[t]:d(m);if(a.isList(r)){const o={"@list":[]};v(y,t,o);const s=r["@list"];for(const l in s)if(r=s[l],a.isSubjectReference(r)){const a=t in n?n[t][0]["@list"]:d(m);c.frame(e,[r["@id"]],a,o,"@list")}else v(o,"@list",i.clone(r))}else a.isSubjectReference(r)?c.frame(e,[r["@id"]],o,y,t):b(o[0],r)&&v(y,t,i.clone(r))}for(const e of Object.keys(n).sort()){if(r(e))continue;const t=n[e][0]||{};if(!(f(t,u,"omitDefault")||e in y)){let n="@null";"@default"in t&&(n=i.clone(t["@default"])),o.isArray(n)||(n=[n]),y[e]=[{"@preserve":n}]}}if("@reverse"in n)for(const r of Object.keys(n["@reverse"]).sort()){const a=n["@reverse"][r];for(const n of Object.keys(e.subjects))i.getValues(e.subjects[n],r).some(e=>e["@id"]===t)&&(y["@reverse"]=y["@reverse"]||{},i.addValue(y["@reverse"],r,[],{propertyIsArray:!0}),c.frame(e,[n],a,y["@reverse"][r],l))}v(s,l,y),e.subjectStack.pop()}}}},{"./JsonLdError":3,"./context":10,"./graphTypes":17,"./nodeMap":19,"./types":21,"./util":23}],16:[function(e,t,n){"use strict";const r=e("./graphTypes"),a=e("./types"),o=e("./util"),{RDF_LIST:i,RDF_FIRST:s,RDF_REST:l,RDF_NIL:u,RDF_TYPE:c,XSD_BOOLEAN:d,XSD_DOUBLE:p,XSD_INTEGER:f,XSD_STRING:h}=e("./constants"),y={};function g(e,t){if(e.termType.endsWith("Node"))return{"@id":e.value};const n={"@value":e.value};if(e.language)n["@language"]=e.language;else{let r=e.datatype.value;if(r||(r=h),t){if(r===d)"true"===n["@value"]?n["@value"]=!0:"false"===n["@value"]&&(n["@value"]=!1);else if(a.isNumeric(n["@value"]))if(r===f){const e=parseInt(n["@value"],10);e.toFixed(0)===n["@value"]&&(n["@value"]=e)}else r===p&&(n["@value"]=parseFloat(n["@value"]));[d,f,p,h].includes(r)||(n["@type"]=r)}else r!==h&&(n["@type"]=r)}return n}t.exports=y,y.fromRDF=async(e,{useRdfType:t=!1,useNativeTypes:n=!1})=>{const d={},p={"@default":d},f={};for(const r of e){const e="DefaultGraph"===r.graph.termType?"@default":r.graph.value;e in p||(p[e]={}),"@default"===e||e in d||(d[e]={"@id":e});const a=p[e],i=r.subject.value,s=r.predicate.value,l=r.object;i in a||(a[i]={"@id":i});const h=a[i],y=l.termType.endsWith("Node");if(!y||l.value in a||(a[l.value]={"@id":l.value}),s===c&&!t&&y){o.addValue(h,"@type",l.value,{propertyIsArray:!0});continue}const v=g(l,n);if(o.addValue(h,s,v,{propertyIsArray:!0}),y)if(l.value===u){const e=a[l.value];"usages"in e||(e.usages=[]),e.usages.push({node:h,property:s,value:v})}else l.value in f?f[l.value]=!1:f[l.value]={node:h,property:s,value:v}}for(const e in p){const t=p[e];if(!(u in t))continue;const n=t[u];if(n.usages){for(let e of n.usages){let n=e.node,o=e.property,c=e.value;const d=[],p=[];let h=Object.keys(n).length;for(;o===l&&a.isObject(f[n["@id"]])&&a.isArray(n[s])&&1===n[s].length&&a.isArray(n[l])&&1===n[l].length&&(3===h||4===h&&a.isArray(n["@type"])&&1===n["@type"].length&&n["@type"][0]===i)&&(d.push(n[s][0]),p.push(n["@id"]),n=(e=f[n["@id"]]).node,o=e.property,c=e.value,h=Object.keys(n).length,r.isBlankNode(n)););if(o===s){if(n["@id"]===u)continue;l in t[c["@id"]]&&(c=t[c["@id"]][l][0]),d.pop(),p.pop()}delete c["@id"],c["@list"]=d.reverse();for(const e of p)delete t[e]}delete n.usages}}const h=[],y=Object.keys(d).sort();for(const e of y){const t=d[e];if(e in p){const n=t["@graph"]=[],a=p[e],o=Object.keys(a).sort();for(const e of o){const t=a[e];r.isSubjectReference(t)||n.push(t)}}r.isSubjectReference(t)||h.push(t)}return h}},{"./constants":9,"./graphTypes":17,"./types":21,"./util":23}],17:[function(e,t,n){"use strict";const r=e("./types"),a={};t.exports=a,a.isSubject=e=>!(!r.isObject(e)||"@value"in e||"@set"in e||"@list"in e||!(Object.keys(e).length>1)&&"@id"in e),a.isSubjectReference=e=>r.isObject(e)&&1===Object.keys(e).length&&"@id"in e,a.isValue=e=>r.isObject(e)&&"@value"in e,a.isList=e=>r.isObject(e)&&"@list"in e,a.isGraph=e=>r.isObject(e)&&"@graph"in e&&1===Object.keys(e).filter(e=>"@id"!==e&&"@index"!==e).length,a.isSimpleGraph=e=>a.isGraph(e)&&!("@id"in e),a.isBlankNode=e=>!!r.isObject(e)&&("@id"in e?0===e["@id"].indexOf("_:"):0===Object.keys(e).length||!("@value"in e||"@set"in e||"@list"in e))},{"./types":21}],18:[function(e,n,r){(function(t,r){const a=e("rdf-canonize"),o=e("./util"),i=o.IdentifierIssuer,s=e("./JsonLdError"),l=e("./NQuads"),u=e("./Rdfa"),{expand:c}=e("./expand"),{flatten:d}=e("./flatten"),{fromRDF:p}=e("./fromRdf"),{toRDF:f}=e("./toRdf"),{frameMergedOrDefault:h}=e("./frame"),{isArray:y,isObject:g,isString:v}=e("./types"),{isSubjectReference:m}=e("./graphTypes"),{getInitialContext:b,process:x,getAllContexts:w}=e("./context"),{compact:I,compactIri:S,removePreserve:O}=e("./compact"),{createNodeMap:C,createMergedNodeMap:k,mergeNodeMaps:A}=e("./nodeMap"),j=void 0!==t&&t.versions&&t.versions.node,T=!j&&("undefined"!=typeof window||"undefined"!=typeof self),N=function(t){t.compact=o.callbackify(async function(e,n,r){if(arguments.length<2)throw new TypeError("Could not compact, too few arguments.");if(null===n)throw new s("The compaction context must not be null.","jsonld.CompactError",{code:"invalid local context"});if(null===e)return null;let a;(r=N(r,{base:v(e)?e:"",compactArrays:!0,compactToRelative:!0,graph:!1,skipExpansion:!1,link:!1,issuer:new i("_:b")})).link&&(r.skipExpansion=!0),r.compactToRelative||delete r.base,a=r.skipExpansion?e:await t.expand(e,r);const l=await t.processContext(b(r),n,r);let u=I({activeCtx:l,element:a,options:r,compactionMap:r.compactionMap});r.compactArrays&&!r.graph&&y(u)?1===u.length?u=u[0]:0===u.length&&(u={}):r.graph&&g(u)&&(u=[u]),g(n)&&"@context"in n&&(n=n["@context"]),n=o.clone(n),y(n)||(n=[n]);const c=n;n=[];for(let e=0;e<c.length;++e)(!g(c[e])||Object.keys(c[e]).length>0)&&n.push(c[e]);const d=n.length>0;if(1===n.length&&(n=n[0]),y(u)){const e=S({activeCtx:l,iri:"@graph",relativeTo:{vocab:!0}}),t=u;u={},d&&(u["@context"]=n),u[e]=t}else if(g(u)&&d){const e=u;u={"@context":n};for(const t in e)u[t]=e[t]}if(r.framing){const e=S({activeCtx:l,iri:"@graph",relativeTo:{vocab:!0}});r.link={},u[e]=O(l,u[e],r)}return u}),t.expand=o.callbackify(async function(e,n){if(arguments.length<1)throw new TypeError("Could not expand, too few arguments.");!1===(n=N(n,{keepFreeFloatingNodes:!1})).expansionMap&&(n.expansionMap=void 0);const r={},a=[];if("expandContext"in n){const e=o.clone(n.expandContext);g(e)&&"@context"in e?r.expandContext=e:r.expandContext={"@context":e},a.push(r.expandContext)}let i;if(v(e)){const o=await t.get(e,n);i=o.documentUrl,r.input=o.document,o.contextUrl&&(r.remoteContext={"@context":o.contextUrl},a.push(r.remoteContext))}else r.input=o.clone(e);"base"in n||(n.base=i||""),await w(r,n);let s=b(n);a.forEach(e=>{s=x({activeCtx:s,localCtx:e,options:n})});let l=c({activeCtx:s,element:r.input,options:n,expansionMap:n.expansionMap});return g(l)&&"@graph"in l&&1===Object.keys(l).length?l=l["@graph"]:null===l&&(l=[]),y(l)||(l=[l]),l}),t.flatten=o.callbackify(async function(e,n,r){if(arguments.length<1)return new TypeError("Could not flatten, too few arguments.");n="function"==typeof n?null:n||null,r=N(r,{base:v(e)?e:""});const a=await t.expand(e,r),o=d(a);if(null===n)return o;r.graph=!0,r.skipExpansion=!0;const i=await t.compact(o,n,r);return i}),t.frame=o.callbackify(async function(e,n,r){if(arguments.length<2)throw new TypeError("Could not frame, too few arguments.");if(r=N(r,{base:v(e)?e:"",embed:"@last",explicit:!1,requireAll:!0,omitDefault:!1,pruneBlankNodeIdentifiers:!0,bnodesToClear:[]}),v(n)){const e=await t.get(n,r);if(n=e.document,e.contextUrl){let t=n["@context"];t?y(t)?t.push(e.contextUrl):t=[t,e.contextUrl]:t=e.contextUrl,n["@context"]=t}}const a=n&&n["@context"]||{},i=await t.expand(e,r),s=o.clone(r);s.isFrame=!0,s.keepFreeFloatingNodes=!0;const l=await t.expand(n,s);let u;s.merged=!("@graph"in n),u=h(i,l,s),s.graph=!0,s.skipExpansion=!0,s.link={},s.framing=!0;const c=await t.compact(u,a,s);return c}),t.link=o.callbackify(async function(e,n,r){const a={};return n&&(a["@context"]=n),a["@embed"]="@link",t.frame(e,a,r)}),t.normalize=t.canonize=o.callbackify(async function(e,n){if(arguments.length<1)throw new TypeError("Could not canonize, too few arguments.");if("inputFormat"in(n=N(n,{base:v(e)?e:"",algorithm:"URDNA2015",skipExpansion:!1}))){if("application/n-quads"!==n.inputFormat&&"application/nquads"!==n.inputFormat)throw new s("Unknown canonicalization input format.","jsonld.CanonizeError");const t=l.parse(e);return a.canonize(t,n)}const r=o.clone(n);delete r.format,r.produceGeneralizedRdf=!1;const i=await t.toRDF(e,r);return a.canonize(i,n)}),t.fromRDF=o.callbackify(async function(e,t){if(arguments.length<1)throw new TypeError("Could not convert from RDF, too few arguments.");t=N(t,{format:v(e)?"application/n-quads":void 0});let r,{format:a,rdfParser:o}=t;if(a){if(!(o=o||n[a]))throw new s("Unknown input format.","jsonld.UnknownFormat",{format:a})}else o=()=>e;return r=o.length>1?new Promise((t,n)=>{o(e,(e,r)=>{e?n(e):t(r)})}):Promise.resolve(o(e)),r=await r,Array.isArray(r)||(r=l.legacyDatasetToQuads(r)),p(r,t)}),t.toRDF=o.callbackify(async function(e,n){if(arguments.length<1)throw new TypeError("Could not convert to RDF, too few arguments.");let r;r=(n=N(n,{base:v(e)?e:"",skipExpansion:!1})).skipExpansion?e:await t.expand(e,n);const a=f(r,n);if(n.format){if("application/n-quads"===n.format||"application/nquads"===n.format)return await l.serialize(a);throw new s("Unknown output format.","jsonld.UnknownFormat",{format:n.format})}return a}),t.createNodeMap=o.callbackify(async function(e,n){if(arguments.length<1)throw new TypeError("Could not create node map, too few arguments.");n=N(n,{base:v(e)?e:""});const r=await t.expand(e,n);return k(r,n)}),t.merge=o.callbackify(async function(e,n,r){if(arguments.length<1)throw new TypeError("Could not merge, too few arguments.");if(!y(e))throw new TypeError('Could not merge, "docs" must be an array.');n="function"==typeof n?null:n||null,r=N(r,{});const a=await Promise.all(e.map(e=>{const n=Object.assign({},r);return t.expand(e,n)}));let s=!0;"mergeNodes"in r&&(s=r.mergeNodes);const l=r.issuer||new i("_:b"),u={"@default":{}};for(let e=0;e<a.length;++e){const t=o.relabelBlankNodes(a[e],{issuer:new i("_:b"+e+"-")}),n=s||0===e?u:{"@default":{}};if(C(t,n,"@default",l),n!==u)for(const e in n){const t=n[e];if(!(e in u)){u[e]=t;continue}const r=u[e];for(const e in t)e in r||(r[e]=t[e])}}const c=A(u),d=[],p=Object.keys(c).sort();for(let e=0;e<p.length;++e){const t=c[p[e]];m(t)||d.push(t)}if(null===n)return d;r.graph=!0,r.skipExpansion=!0;const f=await t.compact(d,n,r);return f}),Object.defineProperty(t,"documentLoader",{get:()=>t._documentLoader,set:e=>t._documentLoader=o.normalizeDocumentLoader(e)}),t.documentLoader=async e=>{throw new s("Could not retrieve a JSON-LD document from the URL. URL dereferencing not implemented.","jsonld.LoadDocumentError",{code:"loading document failed",url:e})},t.loadDocument=o.callbackify(async function(){return t.documentLoader.apply(null,arguments)}),t.get=o.callbackify(async function(e,n){let r;r="function"==typeof n.documentLoader?o.normalizeDocumentLoader(n.documentLoader):t.documentLoader;const a=await r(e);try{if(!a.document)throw new s("No remote document found at the given URL.","jsonld.NullRemoteDocument");v(a.document)&&(a.document=JSON.parse(a.document))}catch(e){throw new s("Could not retrieve a JSON-LD document from the URL.","jsonld.LoadDocumentError",{code:"loading document failed",cause:e,remoteDoc:a})}return a}),t.processContext=o.callbackify(async function(e,t,n){if(n=N(n,{base:""}),null===t)return b(n);t=o.clone(t),g(t)&&"@context"in t||(t={"@context":t});const r=await w(t,n);return x({activeCtx:e,localCtx:r,options:n})}),t.getContextValue=e("./context").getContextValue,t.documentLoaders={},t.documentLoaders.node=e("./documentLoaders/node"),t.documentLoaders.xhr=e("./documentLoaders/xhr"),t.useDocumentLoader=function(e){if(!(e in t.documentLoaders))throw new s('Unknown document loader type: "'+e+'"',"jsonld.UnknownDocumentLoader",{type:e});t.documentLoader=t.documentLoaders[e].apply(t,Array.prototype.slice.call(arguments,1))};const n={};function N(e,{documentLoader:n=t.documentLoader,...r}){return Object.assign({},{documentLoader:n},r,e)}return t.registerRDFParser=function(e,t){n[e]=t},t.unregisterRDFParser=function(e){delete n[e]},t.registerRDFParser("application/n-quads",l.parse),t.registerRDFParser("application/nquads",l.parse),t.registerRDFParser("rdfa-api",u.parse),t.url=e("./url"),t.util=o,Object.assign(t,o),t.promises=t,t.RequestQueue=e("./RequestQueue"),t.JsonLdProcessor=e("./JsonLdProcessor")(t),T&&void 0===r.JsonLdProcessor&&Object.defineProperty(r,"JsonLdProcessor",{writable:!0,enumerable:!1,configurable:!0,value:t.JsonLdProcessor}),j?t.useDocumentLoader("node"):"undefined"!=typeof XMLHttpRequest&&t.useDocumentLoader("xhr"),t},D=function(){return N(function(){return D()})};N(D),n.exports=D}).call(this,e("_process"),void 0!==t?t:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./JsonLdError":3,"./JsonLdProcessor":4,"./NQuads":5,"./Rdfa":6,"./RequestQueue":7,"./compact":8,"./context":10,"./documentLoaders/node":11,"./documentLoaders/xhr":12,"./expand":13,"./flatten":14,"./frame":15,"./fromRdf":16,"./graphTypes":17,"./nodeMap":19,"./toRdf":20,"./types":21,"./url":22,"./util":23,_process:31,"rdf-canonize":41}],19:[function(e,t,n){"use strict";const{isKeyword:r}=e("./context"),a=e("./graphTypes"),o=e("./types"),i=e("./util"),s=e("./JsonLdError"),l={};t.exports=l,l.createMergedNodeMap=(e,t)=>{const n=(t=t||{}).issuer||new i.IdentifierIssuer("_:b"),r={"@default":{}};return l.createNodeMap(e,r,"@default",n),l.mergeNodeMaps(r)},l.createNodeMap=(e,t,n,u,c,d)=>{if(o.isArray(e)){for(let r=0;r<e.length;++r)l.createNodeMap(e[r],t,n,u,void 0,d);return}if(!o.isObject(e))return void(d&&d.push(e));if(a.isValue(e)){if("@type"in e){let t=e["@type"];0===t.indexOf("_:")&&(e["@type"]=t=u.getId(t))}return void(d&&d.push(e))}if("@type"in e){const t=e["@type"];for(let e=0;e<t.length;++e){const n=t[e];0===n.indexOf("_:")&&u.getId(n)}}o.isUndefined(c)&&(c=a.isBlankNode(e)?u.getId(e["@id"]):e["@id"]),d&&d.push({"@id":c});const p=t[n],f=p[c]=p[c]||{};f["@id"]=c;const h=Object.keys(e).sort();for(let o=0;o<h.length;++o){let d=h[o];if("@id"===d)continue;if("@reverse"===d){const r={"@id":c},o=e["@reverse"];for(const e in o){const s=o[e];for(let o=0;o<s.length;++o){const c=s[o];let d=c["@id"];a.isBlankNode(c)&&(d=u.getId(d)),l.createNodeMap(c,t,n,u,d),i.addValue(p[d],e,r,{propertyIsArray:!0,allowDuplicate:!1})}}continue}if("@graph"===d){c in t||(t[c]={}),l.createNodeMap(e[d],t,c,u);continue}if("@type"!==d&&r(d)){if("@index"===d&&d in f&&(e[d]!==f[d]||e[d]["@id"]!==f[d]["@id"]))throw new s("Invalid JSON-LD syntax; conflicting @index property detected.","jsonld.SyntaxError",{code:"conflicting indexes",subject:f});f[d]=e[d];continue}const y=e[d];if(0===d.indexOf("_:")&&(d=u.getId(d)),0!==y.length)for(let e=0;e<y.length;++e){let r=y[e];if("@type"===d&&(r=0===r.indexOf("_:")?u.getId(r):r),a.isSubject(r)||a.isSubjectReference(r)){const e=a.isBlankNode(r)?u.getId(r["@id"]):r["@id"];i.addValue(f,d,{"@id":e},{propertyIsArray:!0,allowDuplicate:!1}),l.createNodeMap(r,t,n,u,e)}else if(a.isList(r)){const e=[];l.createNodeMap(r["@list"],t,n,u,c,e),r={"@list":e},i.addValue(f,d,r,{propertyIsArray:!0,allowDuplicate:!1})}else l.createNodeMap(r,t,n,u,c),i.addValue(f,d,r,{propertyIsArray:!0,allowDuplicate:!1})}else i.addValue(f,d,[],{propertyIsArray:!0})}},l.mergeNodeMapGraphs=e=>{const t={};for(const n of Object.keys(e).sort())for(const a of Object.keys(e[n]).sort()){const o=e[n][a];a in t||(t[a]={"@id":a});const s=t[a];for(const e of Object.keys(o).sort())if(r(e))s[e]=i.clone(o[e]);else for(const t of o[e])i.addValue(s,e,i.clone(t),{propertyIsArray:!0,allowDuplicate:!1})}return t},l.mergeNodeMaps=e=>{const t=e["@default"],n=Object.keys(e).sort();for(let r=0;r<n.length;++r){const o=n[r];if("@default"===o)continue;const i=e[o];let s=t[o];s?"@graph"in s||(s["@graph"]=[]):t[o]=s={"@id":o,"@graph":[]};const l=s["@graph"],u=Object.keys(i).sort();for(let e=0;e<u.length;++e){const t=i[u[e]];a.isSubjectReference(t)||l.push(t)}}return t}},{"./JsonLdError":3,"./context":10,"./graphTypes":17,"./types":21,"./util":23}],20:[function(e,t,n){"use strict";const{createNodeMap:r}=e("./nodeMap"),{isKeyword:a}=e("./context"),o=e("./graphTypes"),i=e("./types"),s=e("./util"),{RDF_FIRST:l,RDF_REST:u,RDF_NIL:c,RDF_TYPE:d,RDF_LANGSTRING:p,XSD_BOOLEAN:f,XSD_DOUBLE:h,XSD_INTEGER:y,XSD_STRING:g}=e("./constants"),{isAbsolute:v}=e("./url"),m={};function b(e,t,n,r,i){const s=Object.keys(t).sort();for(let l=0;l<s.length;++l){const u=s[l],c=t[u],p=Object.keys(c).sort();for(let t of p){const s=c[t];if("@type"===t)t=d;else if(a(t))continue;for(const a of s){const s={termType:u.startsWith("_:")?"BlankNode":"NamedNode",value:u};if(!v(u))continue;const l={termType:t.startsWith("_:")?"BlankNode":"NamedNode",value:t};if(v(t)&&("BlankNode"!==l.termType||i.produceGeneralizedRdf))if(o.isList(a))x(a["@list"],r,s,l,e,n);else{const t=w(a);t&&e.push({subject:s,predicate:l,object:t,graph:n})}}}}}function x(e,t,n,r,a,o){const i={termType:"NamedNode",value:l},s={termType:"NamedNode",value:u},d={termType:"NamedNode",value:c};for(const l of e){const e={termType:"BlankNode",value:t.getId()};a.push({subject:n,predicate:r,object:e,graph:o}),n=e,r=i;const u=w(l);u&&a.push({subject:n,predicate:r,object:u,graph:o}),r=s}a.push({subject:n,predicate:r,object:d,graph:o})}function w(e){const t={};if(o.isValue(e)){t.termType="Literal",t.value=void 0,t.datatype={termType:"NamedNode"};let n=e["@value"];const r=e["@type"]||null;i.isBoolean(n)?(t.value=n.toString(),t.datatype.value=r||f):i.isDouble(n)||r===h?(i.isDouble(n)||(n=parseFloat(n)),t.value=n.toExponential(15).replace(/(\d)0*e\+?/,"$1E"),t.datatype.value=r||h):i.isNumber(n)?(t.value=n.toFixed(0),t.datatype.value=r||y):"@language"in e?(t.value=n,t.datatype.value=r||p,t.language=e["@language"]):(t.value=n,t.datatype.value=r||g)}else{const n=i.isObject(e)?e["@id"]:e;t.termType=n.startsWith("_:")?"BlankNode":"NamedNode",t.value=n}return"NamedNode"!==t.termType||v(t.value)?t:null}t.exports=m,m.toRDF=(e,t)=>{const n=new s.IdentifierIssuer("_:b"),a={"@default":{}};r(e,a,"@default",n);const o=[],i=Object.keys(a).sort();for(const e of i){let r;if("@default"===e)r={termType:"DefaultGraph",value:""};else{if(!v(e))continue;(r=e.startsWith("_:")?{termType:"BlankNode"}:{termType:"NamedNode"}).value=e}b(o,a[e],r,n,t)}return o}},{"./constants":9,"./context":10,"./graphTypes":17,"./nodeMap":19,"./types":21,"./url":22,"./util":23}],21:[function(e,t,n){"use strict";const r={};t.exports=r,r.isArray=Array.isArray,r.isBoolean=e=>"boolean"==typeof e||"[object Boolean]"===Object.prototype.toString.call(e),r.isDouble=e=>r.isNumber(e)&&-1!==String(e).indexOf("."),r.isEmptyObject=e=>r.isObject(e)&&0===Object.keys(e).length,r.isNumber=e=>"number"==typeof e||"[object Number]"===Object.prototype.toString.call(e),r.isNumeric=e=>!isNaN(parseFloat(e))&&isFinite(e),r.isObject=e=>"[object Object]"===Object.prototype.toString.call(e),r.isString=e=>"string"==typeof e||"[object String]"===Object.prototype.toString.call(e),r.isUndefined=e=>void 0===e},{}],22:[function(e,t,n){"use strict";const r=e("./types"),a={};t.exports=a,a.parsers={simple:{keys:["href","scheme","authority","path","query","fragment"],regex:/^(?:([^:\/?#]+):)?(?:\/\/([^\/?#]*))?([^?#]*)(?:\?([^#]*))?(?:#(.*))?/},full:{keys:["href","protocol","scheme","authority","auth","user","password","hostname","port","path","directory","file","query","fragment"],regex:/^(([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?(?:(((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/}},a.parse=(e,t)=>{const n={},r=a.parsers[t||"full"],o=r.regex.exec(e);let i=r.keys.length;for(;i--;)n[r.keys[i]]=void 0===o[i]?null:o[i];return("https"===n.scheme&&"443"===n.port||"http"===n.scheme&&"80"===n.port)&&(n.href=n.href.replace(":"+n.port,""),n.authority=n.authority.replace(":"+n.port,""),n.port=null),n.normalizedPath=a.removeDotSegments(n.path),n},a.prependBase=(e,t)=>{if(null===e)return t;if(-1!==t.indexOf(":"))return t;r.isString(e)&&(e=a.parse(e||""));const n=a.parse(t),o={protocol:e.protocol||""};if(null!==n.authority)o.authority=n.authority,o.path=n.path,o.query=n.query;else if(o.authority=e.authority,""===n.path)o.path=e.path,null!==n.query?o.query=n.query:o.query=e.query;else{if(0===n.path.indexOf("/"))o.path=n.path;else{let t=e.path;(t=t.substr(0,t.lastIndexOf("/")+1)).length>0&&"/"!==t.substr(-1)&&(t+="/"),t+=n.path,o.path=t}o.query=n.query}""!==n.path&&(o.path=a.removeDotSegments(o.path));let i=o.protocol;return null!==o.authority&&(i+="//"+o.authority),i+=o.path,null!==o.query&&(i+="?"+o.query),null!==n.fragment&&(i+="#"+n.fragment),""===i&&(i="./"),i},a.removeBase=(e,t)=>{if(null===e)return t;r.isString(e)&&(e=a.parse(e||""));let n="";if(""!==e.href?n+=(e.protocol||"")+"//"+(e.authority||""):t.indexOf("//")&&(n+="//"),0!==t.indexOf(n))return t;const o=a.parse(t.substr(n.length)),i=e.normalizedPath.split("/"),s=o.normalizedPath.split("/"),l=o.fragment||o.query?0:1;for(;i.length>0&&s.length>l&&i[0]===s[0];)i.shift(),s.shift();let u="";if(i.length>0){i.pop();for(let e=0;e<i.length;++e)u+="../"}return u+=s.join("/"),null!==o.query&&(u+="?"+o.query),null!==o.fragment&&(u+="#"+o.fragment),""===u&&(u="./"),u},a.removeDotSegments=e=>{if(0===e.length)return"";const t=e.split("/"),n=[];for(;t.length>0;){const e=t.shift(),r=0===t.length;"."!==e?".."!==e?n.push(e):(n.pop(),r&&n.push("")):r&&n.push("")}return n.length>0&&""!==n[0]&&n.unshift(""),1===n.length&&""===n[0]?"/":n.join("/")};const o=/^([A-Za-z][A-Za-z0-9+-.]*|_):/;a.isAbsolute=e=>r.isString(e)&&o.test(e),a.isRelative=e=>r.isString(e)},{"./types":21}],23:[function(e,t,n){(function(n,r){"use strict";const a=e("./graphTypes"),o=e("./types"),i=e("rdf-canonize").IdentifierIssuer,s=e("./JsonLdError"),l=/(?:<[^>]*?>|"[^"]*?"|[^,])+/g,u=/\s*<([^>]*?)>\s*(?:;\s*(.*))?/,c=/(.*?)=(?:(?:"([^"]*?)")|([^"]*?))\s*(?:(?:;\s*)|$)/g,d={accept:"application/ld+json, application/json"},p={};t.exports=p,p.IdentifierIssuer=i;const f="function"==typeof r&&r,h=f?e=>f(e):e=>setTimeout(e,0);function y(e,t,n){p.nextTick(()=>e(t,n))}"object"==typeof n&&"function"==typeof n.nextTick?p.nextTick=n.nextTick:p.nextTick=h,p.setImmediate=f?h:p.nextTick,p.clone=function(e){if(e&&"object"==typeof e){let t;if(o.isArray(e)){t=[];for(let n=0;n<e.length;++n)t[n]=p.clone(e[n])}else if(e instanceof Map){t=new Map;for(const[n,r]of e)t.set(n,p.clone(r))}else if(e instanceof Set){t=new Set;for(const n of e)t.add(p.clone(n))}else if(o.isObject(e)){t={};for(const n in e)t[n]=p.clone(e[n])}else t=e.toString();return t}return e},p.asArray=function(e){return Array.isArray(e)?e:[e]},p.buildHeaders=(e={})=>{if(Object.keys(e).some(e=>"accept"===e.toLowerCase()))throw new RangeError('Accept header may not be specified; only "'+d.accept+'" is supported.');return Object.assign({Accept:d.accept},e)},p.parseLinkHeader=e=>{const t={},n=e.match(l);for(let e=0;e<n.length;++e){let r=n[e].match(u);if(!r)continue;const a={target:r[1]},o=r[2];for(;r=c.exec(o);)a[r[1]]=void 0===r[2]?r[3]:r[2];const i=a.rel||"";Array.isArray(t[i])?t[i].push(a):t.hasOwnProperty(i)?t[i]=[t[i],a]:t[i]=a}return t},p.validateTypeValue=e=>{if(o.isString(e)||o.isEmptyObject(e))return;let t=!1;if(o.isArray(e)){t=!0;for(let n=0;n<e.length;++n)if(!o.isString(e[n])){t=!1;break}}if(!t)throw new s('Invalid JSON-LD syntax; "@type" value must a string, an array of strings, or an empty object.',"jsonld.SyntaxError",{code:"invalid type value",value:e})},p.hasProperty=(e,t)=>{if(e.hasOwnProperty(t)){const n=e[t];return!o.isArray(n)||n.length>0}return!1},p.hasValue=(e,t,n)=>{if(p.hasProperty(e,t)){let r=e[t];const i=a.isList(r);if(o.isArray(r)||i){i&&(r=r["@list"]);for(let e=0;e<r.length;++e)if(p.compareValues(n,r[e]))return!0}else if(!o.isArray(n))return p.compareValues(n,r)}return!1},p.addValue=(e,t,n,r)=>{if("propertyIsArray"in(r=r||{})||(r.propertyIsArray=!1),"allowDuplicate"in r||(r.allowDuplicate=!0),o.isArray(n)){0===n.length&&r.propertyIsArray&&!e.hasOwnProperty(t)&&(e[t]=[]);for(let a=0;a<n.length;++a)p.addValue(e,t,n[a],r)}else if(e.hasOwnProperty(t)){const a=!r.allowDuplicate&&p.hasValue(e,t,n);o.isArray(e[t])||a&&!r.propertyIsArray||(e[t]=[e[t]]),a||e[t].push(n)}else e[t]=r.propertyIsArray?[n]:n},p.getValues=(e,t)=>[].concat(e[t]||[]),p.removeProperty=(e,t)=>{delete e[t]},p.removeValue=(e,t,n,r)=>{"propertyIsArray"in(r=r||{})||(r.propertyIsArray=!1);const a=p.getValues(e,t).filter(e=>!p.compareValues(e,n));0===a.length?p.removeProperty(e,t):1!==a.length||r.propertyIsArray?e[t]=a:e[t]=a[0]},p.relabelBlankNodes=(e,t)=>(function e(t,n){if(o.isArray(n))for(let r=0;r<n.length;++r)n[r]=e(t,n[r]);else if(a.isList(n))n["@list"]=e(t,n["@list"]);else if(o.isObject(n)){a.isBlankNode(n)&&(n["@id"]=t.getId(n["@id"]));const r=Object.keys(n).sort();for(let a=0;a<r.length;++a){const o=r[a];"@id"!==o&&(n[o]=e(t,n[o]))}}return n})((t=t||{}).issuer||new i("_:b"),e),p.compareValues=(e,t)=>e===t||!(!a.isValue(e)||!a.isValue(t)||e["@value"]!==t["@value"]||e["@type"]!==t["@type"]||e["@language"]!==t["@language"]||e["@index"]!==t["@index"])||!!(o.isObject(e)&&"@id"in e&&o.isObject(t)&&"@id"in t)&&e["@id"]===t["@id"],p.compareShortestLeast=(e,t)=>e.length<t.length?-1:t.length<e.length?1:e===t?0:e<t?-1:1,p.normalizeDocumentLoader=e=>e.length<2?p.callbackify(e):async function(t){const n=arguments[1];return new Promise((r,a)=>{try{e(t,(e,t)=>{if("function"==typeof n)return y(n,e,t);e?a(e):r(t)})}catch(e){if("function"==typeof n)return y(n,e);a(e)}})},p.callbackify=e=>(async function(...t){const n=t[t.length-1];let r;"function"==typeof n&&t.pop();try{r=await e.apply(null,t)}catch(e){if("function"==typeof n)return y(n,e);throw e}return"function"==typeof n?y(n,null,r):r})}).call(this,e("_process"),e("timers").setImmediate)},{"./JsonLdError":3,"./graphTypes":17,"./types":21,_process:31,"rdf-canonize":41,timers:43}],24:[function(e,n,r){(function(e){"use strict";e=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==e)return e;throw new Error("unable to locate global object")}(),n.exports=r=e.fetch,r.default=e.fetch.bind(e),r.Headers=e.Headers,r.Request=e.Request,r.Response=e.Response}).call(this,void 0!==t?t:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],25:[function(e,t,n){(function(e){var n={};t.exports=n;var r={};n.encode=function(e,t,n){if("string"!=typeof t)throw new TypeError('"alphabet" must be a string.');if(void 0!==n&&"number"!=typeof n)throw new TypeError('"maxline" must be a number.');var r="";if(e instanceof Uint8Array){var a=0,o=t.length,i=t.charAt(0),s=[0];for(a=0;a<e.length;++a){for(var l=0,u=e[a];l<s.length;++l)u+=s[l]<<8,s[l]=u%o,u=u/o|0;for(;u>0;)s.push(u%o),u=u/o|0}for(a=0;0===e[a]&&a<e.length-1;++a)r+=i;for(a=s.length-1;a>=0;--a)r+=t[s[a]]}else r=function(e,t){var n=0,r=t.length,a=t.charAt(0),o=[0];for(n=0;n<e.length();++n){for(var i=0,s=e.at(n);i<o.length;++i)s+=o[i]<<8,o[i]=s%r,s=s/r|0;for(;s>0;)o.push(s%r),s=s/r|0}var l="";for(n=0;0===e.at(n)&&n<e.length()-1;++n)l+=a;for(n=o.length-1;n>=0;--n)l+=t[o[n]];return l}(e,t);if(n){var c=new RegExp(".{1,"+n+"}","g");r=r.match(c).join("\r\n")}return r},n.decode=function(t,n){if("string"!=typeof t)throw new TypeError('"input" must be a string.');if("string"!=typeof n)throw new TypeError('"alphabet" must be a string.');var a=r[n];if(!a){a=r[n]=[];for(var o=0;o<n.length;++o)a[n.charCodeAt(o)]=o}t=t.replace(/\s/g,"");var i=n.length,s=n.charAt(0),l=[0];for(o=0;o<t.length;o++){var u=a[t.charCodeAt(o)];if(void 0===u)return;for(var c=0,d=u;c<l.length;++c)d+=l[c]*i,l[c]=255&d,d>>=8;for(;d>0;)l.push(255&d),d>>=8}for(var p=0;t[p]===s&&p<t.length-1;++p)l.push(0);return void 0!==e?e.from(l.reverse()):new Uint8Array(l.reverse())}}).call(this,e("buffer").Buffer)},{buffer:1}],26:[function(e,t,n){t.exports={options:{usePureJavaScript:!1}}},{}],27:[function(e,t,n){var r=e("./forge");t.exports=r.md=r.md||{},r.md.algorithms=r.md.algorithms||{}},{"./forge":26}],28:[function(e,t,n){var r=e("./forge");e("./md"),e("./util");var a=t.exports=r.sha1=r.sha1||{};r.md.sha1=r.md.algorithms.sha1=a,a.create=function(){i||(o=String.fromCharCode(128),o+=r.util.fillString(String.fromCharCode(0),64),i=!0);var e=null,t=r.util.createBuffer(),n=new Array(80),a={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8,start:function(){a.messageLength=0,a.fullMessageLength=a.messageLength64=[];for(var n=a.messageLengthSize/4,o=0;o<n;++o)a.fullMessageLength.push(0);return t=r.util.createBuffer(),e={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},a}};return a.start(),a.update=function(o,i){"utf8"===i&&(o=r.util.encodeUtf8(o));var l=o.length;a.messageLength+=l,l=[l/4294967296>>>0,l>>>0];for(var u=a.fullMessageLength.length-1;u>=0;--u)a.fullMessageLength[u]+=l[1],l[1]=l[0]+(a.fullMessageLength[u]/4294967296>>>0),a.fullMessageLength[u]=a.fullMessageLength[u]>>>0,l[0]=l[1]/4294967296>>>0;return t.putBytes(o),s(e,n,t),(t.read>2048||0===t.length())&&t.compact(),a},a.digest=function(){var i=r.util.createBuffer();i.putBytes(t.bytes());var l,u=a.fullMessageLength[a.fullMessageLength.length-1]+a.messageLengthSize&a.blockLength-1;i.putBytes(o.substr(0,a.blockLength-u));for(var c=8*a.fullMessageLength[0],d=0;d<a.fullMessageLength.length-1;++d)c+=(l=8*a.fullMessageLength[d+1])/4294967296>>>0,i.putInt32(c>>>0),c=l>>>0;i.putInt32(c);var p={h0:e.h0,h1:e.h1,h2:e.h2,h3:e.h3,h4:e.h4};s(p,n,i);var f=r.util.createBuffer();return f.putInt32(p.h0),f.putInt32(p.h1),f.putInt32(p.h2),f.putInt32(p.h3),f.putInt32(p.h4),f},a};var o=null,i=!1;function s(e,t,n){for(var r,a,o,i,s,l,u,c=n.length();c>=64;){for(a=e.h0,o=e.h1,i=e.h2,s=e.h3,l=e.h4,u=0;u<16;++u)r=n.getInt32(),t[u]=r,r=(a<<5|a>>>27)+(s^o&(i^s))+l+1518500249+r,l=s,s=i,i=(o<<30|o>>>2)>>>0,o=a,a=r;for(;u<20;++u)r=(r=t[u-3]^t[u-8]^t[u-14]^t[u-16])<<1|r>>>31,t[u]=r,r=(a<<5|a>>>27)+(s^o&(i^s))+l+1518500249+r,l=s,s=i,i=(o<<30|o>>>2)>>>0,o=a,a=r;for(;u<32;++u)r=(r=t[u-3]^t[u-8]^t[u-14]^t[u-16])<<1|r>>>31,t[u]=r,r=(a<<5|a>>>27)+(o^i^s)+l+1859775393+r,l=s,s=i,i=(o<<30|o>>>2)>>>0,o=a,a=r;for(;u<40;++u)r=(r=t[u-6]^t[u-16]^t[u-28]^t[u-32])<<2|r>>>30,t[u]=r,r=(a<<5|a>>>27)+(o^i^s)+l+1859775393+r,l=s,s=i,i=(o<<30|o>>>2)>>>0,o=a,a=r;for(;u<60;++u)r=(r=t[u-6]^t[u-16]^t[u-28]^t[u-32])<<2|r>>>30,t[u]=r,r=(a<<5|a>>>27)+(o&i|s&(o^i))+l+2400959708+r,l=s,s=i,i=(o<<30|o>>>2)>>>0,o=a,a=r;for(;u<80;++u)r=(r=t[u-6]^t[u-16]^t[u-28]^t[u-32])<<2|r>>>30,t[u]=r,r=(a<<5|a>>>27)+(o^i^s)+l+3395469782+r,l=s,s=i,i=(o<<30|o>>>2)>>>0,o=a,a=r;e.h0=e.h0+a|0,e.h1=e.h1+o|0,e.h2=e.h2+i|0,e.h3=e.h3+s|0,e.h4=e.h4+l|0,c-=64}}},{"./forge":26,"./md":27,"./util":30}],29:[function(e,t,n){var r=e("./forge");e("./md"),e("./util");var a=t.exports=r.sha256=r.sha256||{};r.md.sha256=r.md.algorithms.sha256=a,a.create=function(){i||(o=String.fromCharCode(128),o+=r.util.fillString(String.fromCharCode(0),64),s=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],i=!0);var e=null,t=r.util.createBuffer(),n=new Array(64),a={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8,start:function(){a.messageLength=0,a.fullMessageLength=a.messageLength64=[];for(var n=a.messageLengthSize/4,o=0;o<n;++o)a.fullMessageLength.push(0);return t=r.util.createBuffer(),e={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},a}};return a.start(),a.update=function(o,i){"utf8"===i&&(o=r.util.encodeUtf8(o));var s=o.length;a.messageLength+=s,s=[s/4294967296>>>0,s>>>0];for(var u=a.fullMessageLength.length-1;u>=0;--u)a.fullMessageLength[u]+=s[1],s[1]=s[0]+(a.fullMessageLength[u]/4294967296>>>0),a.fullMessageLength[u]=a.fullMessageLength[u]>>>0,s[0]=s[1]/4294967296>>>0;return t.putBytes(o),l(e,n,t),(t.read>2048||0===t.length())&&t.compact(),a},a.digest=function(){var i=r.util.createBuffer();i.putBytes(t.bytes());var s,u=a.fullMessageLength[a.fullMessageLength.length-1]+a.messageLengthSize&a.blockLength-1;i.putBytes(o.substr(0,a.blockLength-u));for(var c=8*a.fullMessageLength[0],d=0;d<a.fullMessageLength.length-1;++d)c+=(s=8*a.fullMessageLength[d+1])/4294967296>>>0,i.putInt32(c>>>0),c=s>>>0;i.putInt32(c);var p={h0:e.h0,h1:e.h1,h2:e.h2,h3:e.h3,h4:e.h4,h5:e.h5,h6:e.h6,h7:e.h7};l(p,n,i);var f=r.util.createBuffer();return f.putInt32(p.h0),f.putInt32(p.h1),f.putInt32(p.h2),f.putInt32(p.h3),f.putInt32(p.h4),f.putInt32(p.h5),f.putInt32(p.h6),f.putInt32(p.h7),f},a};var o=null,i=!1,s=null;function l(e,t,n){for(var r,a,o,i,l,u,c,d,p,f,h,y,g,v=n.length();v>=64;){for(l=0;l<16;++l)t[l]=n.getInt32();for(;l<64;++l)r=((r=t[l-2])>>>17|r<<15)^(r>>>19|r<<13)^r>>>10,a=((a=t[l-15])>>>7|a<<25)^(a>>>18|a<<14)^a>>>3,t[l]=r+t[l-7]+a+t[l-16]|0;for(u=e.h0,c=e.h1,d=e.h2,p=e.h3,f=e.h4,h=e.h5,y=e.h6,g=e.h7,l=0;l<64;++l)o=(u>>>2|u<<30)^(u>>>13|u<<19)^(u>>>22|u<<10),i=u&c|d&(u^c),r=g+((f>>>6|f<<26)^(f>>>11|f<<21)^(f>>>25|f<<7))+(y^f&(h^y))+s[l]+t[l],g=y,y=h,h=f,f=p+r>>>0,p=d,d=c,c=u,u=r+(a=o+i)>>>0;e.h0=e.h0+u|0,e.h1=e.h1+c|0,e.h2=e.h2+d|0,e.h3=e.h3+p|0,e.h4=e.h4+f|0,e.h5=e.h5+h|0,e.h6=e.h6+y|0,e.h7=e.h7+g|0,v-=64}}},{"./forge":26,"./md":27,"./util":30}],30:[function(e,r,a){(function(t,a,o,i,s,l,u,c){var d=e("./forge"),p=e("./baseN"),f=r.exports=d.util=d.util||{};function h(e){if(8!==e&&16!==e&&24!==e&&32!==e)throw new Error("Only 8, 16, 24, or 32 bits supported: "+e)}function y(e){if(this.data="",this.read=0,"string"==typeof e)this.data=e;else if(f.isArrayBuffer(e)||f.isArrayBufferView(e))if(void 0!==o&&e instanceof o)this.data=e.toString("binary");else{var t=new Uint8Array(e);try{this.data=String.fromCharCode.apply(null,t)}catch(e){for(var n=0;n<t.length;++n)this.putByte(t[n])}}else(e instanceof y||"object"==typeof e&&"string"==typeof e.data&&"number"==typeof e.read)&&(this.data=e.data,this.read=e.read);this._constructedStringLength=0}!function(){if(void 0!==t&&t.nextTick&&!t.browser)return f.nextTick=t.nextTick,void(f.setImmediate="function"==typeof c?c:f.nextTick);if("function"==typeof c)return f.setImmediate=function(){return c.apply(void 0,arguments)},void(f.nextTick=function(e){return c(e)});if(f.setImmediate=function(e){setTimeout(e,0)},"undefined"!=typeof window&&"function"==typeof window.postMessage){var e="forge.setImmediate",n=[];f.setImmediate=function(t){n.push(t),1===n.length&&window.postMessage(e,"*")},window.addEventListener("message",function(t){if(t.source===window&&t.data===e){t.stopPropagation();var r=n.slice();n.length=0,r.forEach(function(e){e()})}},!0)}if("undefined"!=typeof MutationObserver){var r=Date.now(),a=!0,o=document.createElement("div");n=[],new MutationObserver(function(){var e=n.slice();n.length=0,e.forEach(function(e){e()})}).observe(o,{attributes:!0});var i=f.setImmediate;f.setImmediate=function(e){Date.now()-r>15?(r=Date.now(),i(e)):(n.push(e),1===n.length&&o.setAttribute("a",a=!a))}}f.nextTick=f.setImmediate}(),f.isNodejs=void 0!==t&&t.versions&&t.versions.node,f.globalScope=f.isNodejs||a?a:"undefined"==typeof self?window:self,f.isArray=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},f.isArrayBuffer=function(e){return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer},f.isArrayBufferView=function(e){return e&&f.isArrayBuffer(e.buffer)&&void 0!==e.byteLength},f.ByteBuffer=y,f.ByteStringBuffer=y,f.ByteStringBuffer.prototype._optimizeConstructedString=function(e){this._constructedStringLength+=e,this._constructedStringLength>4096&&(this.data.substr(0,1),this._constructedStringLength=0)},f.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read},f.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0},f.ByteStringBuffer.prototype.putByte=function(e){return this.putBytes(String.fromCharCode(e))},f.ByteStringBuffer.prototype.fillWithByte=function(e,t){e=String.fromCharCode(e);for(var n=this.data;t>0;)1&t&&(n+=e),(t>>>=1)>0&&(e+=e);return this.data=n,this._optimizeConstructedString(t),this},f.ByteStringBuffer.prototype.putBytes=function(e){return this.data+=e,this._optimizeConstructedString(e.length),this},f.ByteStringBuffer.prototype.putString=function(e){return this.putBytes(f.encodeUtf8(e))},f.ByteStringBuffer.prototype.putInt16=function(e){return this.putBytes(String.fromCharCode(e>>8&255)+String.fromCharCode(255&e))},f.ByteStringBuffer.prototype.putInt24=function(e){return this.putBytes(String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(255&e))},f.ByteStringBuffer.prototype.putInt32=function(e){return this.putBytes(String.fromCharCode(e>>24&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(255&e))},f.ByteStringBuffer.prototype.putInt16Le=function(e){return this.putBytes(String.fromCharCode(255&e)+String.fromCharCode(e>>8&255))},f.ByteStringBuffer.prototype.putInt24Le=function(e){return this.putBytes(String.fromCharCode(255&e)+String.fromCharCode(e>>8&255)+String.fromCharCode(e>>16&255))},f.ByteStringBuffer.prototype.putInt32Le=function(e){return this.putBytes(String.fromCharCode(255&e)+String.fromCharCode(e>>8&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>24&255))},f.ByteStringBuffer.prototype.putInt=function(e,t){h(t);var n="";do{t-=8,n+=String.fromCharCode(e>>t&255)}while(t>0);return this.putBytes(n)},f.ByteStringBuffer.prototype.putSignedInt=function(e,t){return e<0&&(e+=2<<t-1),this.putInt(e,t)},f.ByteStringBuffer.prototype.putBuffer=function(e){return this.putBytes(e.getBytes())},f.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)},f.ByteStringBuffer.prototype.getInt16=function(){var e=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,e},f.ByteStringBuffer.prototype.getInt24=function(){var e=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,e},f.ByteStringBuffer.prototype.getInt32=function(){var e=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,e},f.ByteStringBuffer.prototype.getInt16Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,e},f.ByteStringBuffer.prototype.getInt24Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,e},f.ByteStringBuffer.prototype.getInt32Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,e},f.ByteStringBuffer.prototype.getInt=function(e){h(e);var t=0;do{t=(t<<8)+this.data.charCodeAt(this.read++),e-=8}while(e>0);return t},f.ByteStringBuffer.prototype.getSignedInt=function(e){var t=this.getInt(e),n=2<<e-2;return t>=n&&(t-=n<<1),t},f.ByteStringBuffer.prototype.getBytes=function(e){var t;return e?(e=Math.min(this.length(),e),t=this.data.slice(this.read,this.read+e),this.read+=e):0===e?t="":(t=0===this.read?this.data:this.data.slice(this.read),this.clear()),t},f.ByteStringBuffer.prototype.bytes=function(e){return void 0===e?this.data.slice(this.read):this.data.slice(this.read,this.read+e)},f.ByteStringBuffer.prototype.at=function(e){return this.data.charCodeAt(this.read+e)},f.ByteStringBuffer.prototype.setAt=function(e,t){return this.data=this.data.substr(0,this.read+e)+String.fromCharCode(t)+this.data.substr(this.read+e+1),this},f.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)},f.ByteStringBuffer.prototype.copy=function(){var e=f.createBuffer(this.data);return e.read=this.read,e},f.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this},f.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this},f.ByteStringBuffer.prototype.truncate=function(e){var t=Math.max(0,this.length()-e);return this.data=this.data.substr(this.read,t),this.read=0,this},f.ByteStringBuffer.prototype.toHex=function(){for(var e="",t=this.read;t<this.data.length;++t){var n=this.data.charCodeAt(t);n<16&&(e+="0"),e+=n.toString(16)}return e},f.ByteStringBuffer.prototype.toString=function(){return f.decodeUtf8(this.bytes())},f.DataBuffer=function(e,t){t=t||{},this.read=t.readOffset||0,this.growSize=t.growSize||1024;var n=f.isArrayBuffer(e),r=f.isArrayBufferView(e);if(n||r)return this.data=n?new DataView(e):new DataView(e.buffer,e.byteOffset,e.byteLength),void(this.write="writeOffset"in t?t.writeOffset:this.data.byteLength);this.data=new DataView(new ArrayBuffer(0)),this.write=0,null!=e&&this.putBytes(e),"writeOffset"in t&&(this.write=t.writeOffset)},f.DataBuffer.prototype.length=function(){return this.write-this.read},f.DataBuffer.prototype.isEmpty=function(){return this.length()<=0},f.DataBuffer.prototype.accommodate=function(e,t){if(this.length()>=e)return this;t=Math.max(t||this.growSize,e);var n=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),r=new Uint8Array(this.length()+t);return r.set(n),this.data=new DataView(r.buffer),this},f.DataBuffer.prototype.putByte=function(e){return this.accommodate(1),this.data.setUint8(this.write++,e),this},f.DataBuffer.prototype.fillWithByte=function(e,t){this.accommodate(t);for(var n=0;n<t;++n)this.data.setUint8(e);return this},f.DataBuffer.prototype.putBytes=function(e,t){if(f.isArrayBufferView(e)){var n=(r=new Uint8Array(e.buffer,e.byteOffset,e.byteLength)).byteLength-r.byteOffset;return this.accommodate(n),new Uint8Array(this.data.buffer,this.write).set(r),this.write+=n,this}if(f.isArrayBuffer(e)){var r=new Uint8Array(e);return this.accommodate(r.byteLength),new Uint8Array(this.data.buffer).set(r,this.write),this.write+=r.byteLength,this}if(e instanceof f.DataBuffer||"object"==typeof e&&"number"==typeof e.read&&"number"==typeof e.write&&f.isArrayBufferView(e.data))return r=new Uint8Array(e.data.byteLength,e.read,e.length()),this.accommodate(r.byteLength),new Uint8Array(e.data.byteLength,this.write).set(r),this.write+=r.byteLength,this;if(e instanceof f.ByteStringBuffer&&(e=e.data,t="binary"),t=t||"binary","string"==typeof e){var a;if("hex"===t)return this.accommodate(Math.ceil(e.length/2)),a=new Uint8Array(this.data.buffer,this.write),this.write+=f.binary.hex.decode(e,a,this.write),this;if("base64"===t)return this.accommodate(3*Math.ceil(e.length/4)),a=new Uint8Array(this.data.buffer,this.write),this.write+=f.binary.base64.decode(e,a,this.write),this;if("utf8"===t&&(e=f.encodeUtf8(e),t="binary"),"binary"===t||"raw"===t)return this.accommodate(e.length),a=new Uint8Array(this.data.buffer,this.write),this.write+=f.binary.raw.decode(a),this;if("utf16"===t)return this.accommodate(2*e.length),a=new Uint16Array(this.data.buffer,this.write),this.write+=f.text.utf16.encode(a),this;throw new Error("Invalid encoding: "+t)}throw Error("Invalid parameter: "+e)},f.DataBuffer.prototype.putBuffer=function(e){return this.putBytes(e),e.clear(),this},f.DataBuffer.prototype.putString=function(e){return this.putBytes(e,"utf16")},f.DataBuffer.prototype.putInt16=function(e){return this.accommodate(2),this.data.setInt16(this.write,e),this.write+=2,this},f.DataBuffer.prototype.putInt24=function(e){return this.accommodate(3),this.data.setInt16(this.write,e>>8&65535),this.data.setInt8(this.write,e>>16&255),this.write+=3,this},f.DataBuffer.prototype.putInt32=function(e){return this.accommodate(4),this.data.setInt32(this.write,e),this.write+=4,this},f.DataBuffer.prototype.putInt16Le=function(e){return this.accommodate(2),this.data.setInt16(this.write,e,!0),this.write+=2,this},f.DataBuffer.prototype.putInt24Le=function(e){return this.accommodate(3),this.data.setInt8(this.write,e>>16&255),this.data.setInt16(this.write,e>>8&65535,!0),this.write+=3,this},f.DataBuffer.prototype.putInt32Le=function(e){return this.accommodate(4),this.data.setInt32(this.write,e,!0),this.write+=4,this},f.DataBuffer.prototype.putInt=function(e,t){h(t),this.accommodate(t/8);do{t-=8,this.data.setInt8(this.write++,e>>t&255)}while(t>0);return this},f.DataBuffer.prototype.putSignedInt=function(e,t){return h(t),this.accommodate(t/8),e<0&&(e+=2<<t-1),this.putInt(e,t)},f.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)},f.DataBuffer.prototype.getInt16=function(){var e=this.data.getInt16(this.read);return this.read+=2,e},f.DataBuffer.prototype.getInt24=function(){var e=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,e},f.DataBuffer.prototype.getInt32=function(){var e=this.data.getInt32(this.read);return this.read+=4,e},f.DataBuffer.prototype.getInt16Le=function(){var e=this.data.getInt16(this.read,!0);return this.read+=2,e},f.DataBuffer.prototype.getInt24Le=function(){var e=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,e},f.DataBuffer.prototype.getInt32Le=function(){var e=this.data.getInt32(this.read,!0);return this.read+=4,e},f.DataBuffer.prototype.getInt=function(e){h(e);var t=0;do{t=(t<<8)+this.data.getInt8(this.read++),e-=8}while(e>0);return t},f.DataBuffer.prototype.getSignedInt=function(e){var t=this.getInt(e),n=2<<e-2;return t>=n&&(t-=n<<1),t},f.DataBuffer.prototype.getBytes=function(e){var t;return e?(e=Math.min(this.length(),e),t=this.data.slice(this.read,this.read+e),this.read+=e):0===e?t="":(t=0===this.read?this.data:this.data.slice(this.read),this.clear()),t},f.DataBuffer.prototype.bytes=function(e){return void 0===e?this.data.slice(this.read):this.data.slice(this.read,this.read+e)},f.DataBuffer.prototype.at=function(e){return this.data.getUint8(this.read+e)},f.DataBuffer.prototype.setAt=function(e,t){return this.data.setUint8(e,t),this},f.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)},f.DataBuffer.prototype.copy=function(){return new f.DataBuffer(this)},f.DataBuffer.prototype.compact=function(){if(this.read>0){var e=new Uint8Array(this.data.buffer,this.read),t=new Uint8Array(e.byteLength);t.set(e),this.data=new DataView(t),this.write-=this.read,this.read=0}return this},f.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this},f.DataBuffer.prototype.truncate=function(e){return this.write=Math.max(0,this.length()-e),this.read=Math.min(this.read,this.write),this},f.DataBuffer.prototype.toHex=function(){for(var e="",t=this.read;t<this.data.byteLength;++t){var n=this.data.getUint8(t);n<16&&(e+="0"),e+=n.toString(16)}return e},f.DataBuffer.prototype.toString=function(e){var t=new Uint8Array(this.data,this.read,this.length());if("binary"===(e=e||"utf8")||"raw"===e)return f.binary.raw.encode(t);if("hex"===e)return f.binary.hex.encode(t);if("base64"===e)return f.binary.base64.encode(t);if("utf8"===e)return f.text.utf8.decode(t);if("utf16"===e)return f.text.utf16.decode(t);throw new Error("Invalid encoding: "+e)},f.createBuffer=function(e,t){return t=t||"raw",void 0!==e&&"utf8"===t&&(e=f.encodeUtf8(e)),new f.ByteBuffer(e)},f.fillString=function(e,t){for(var n="";t>0;)1&t&&(n+=e),(t>>>=1)>0&&(e+=e);return n},f.xorBytes=function(e,t,n){for(var r="",a="",o="",i=0,s=0;n>0;--n,++i)a=e.charCodeAt(i)^t.charCodeAt(i),s>=10&&(r+=o,o="",s=0),o+=String.fromCharCode(a),++s;return r+=o},f.hexToBytes=function(e){var t="",n=0;for(!0&e.length&&(n=1,t+=String.fromCharCode(parseInt(e[0],16)));n<e.length;n+=2)t+=String.fromCharCode(parseInt(e.substr(n,2),16));return t},f.bytesToHex=function(e){return f.createBuffer(e).toHex()},f.int32ToBytes=function(e){return String.fromCharCode(e>>24&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(255&e)};var g="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",v=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],m="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";f.encode64=function(e,t){for(var n,r,a,o="",i="",s=0;s<e.length;)n=e.charCodeAt(s++),r=e.charCodeAt(s++),a=e.charCodeAt(s++),o+=g.charAt(n>>2),o+=g.charAt((3&n)<<4|r>>4),isNaN(r)?o+="==":(o+=g.charAt((15&r)<<2|a>>6),o+=isNaN(a)?"=":g.charAt(63&a)),t&&o.length>t&&(i+=o.substr(0,t)+"\r\n",o=o.substr(t));return i+=o},f.decode64=function(e){e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var t,n,r,a,o="",i=0;i<e.length;)t=v[e.charCodeAt(i++)-43],n=v[e.charCodeAt(i++)-43],r=v[e.charCodeAt(i++)-43],a=v[e.charCodeAt(i++)-43],o+=String.fromCharCode(t<<2|n>>4),64!==r&&(o+=String.fromCharCode((15&n)<<4|r>>2),64!==a&&(o+=String.fromCharCode((3&r)<<6|a)));return o},f.encodeUtf8=function(e){return unescape(encodeURIComponent(e))},f.decodeUtf8=function(e){return decodeURIComponent(escape(e))},f.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:p.encode,decode:p.decode}},f.binary.raw.encode=function(e){return String.fromCharCode.apply(null,e)},f.binary.raw.decode=function(e,t,n){var r=t;r||(r=new Uint8Array(e.length));for(var a=n=n||0,o=0;o<e.length;++o)r[a++]=e.charCodeAt(o);return t?a-n:r},f.binary.hex.encode=f.bytesToHex,f.binary.hex.decode=function(e,t,n){var r=t;r||(r=new Uint8Array(Math.ceil(e.length/2)));var a=0,o=n=n||0;for(1&e.length&&(a=1,r[o++]=parseInt(e[0],16));a<e.length;a+=2)r[o++]=parseInt(e.substr(a,2),16);return t?o-n:r},f.binary.base64.encode=function(e,t){for(var n,r,a,o="",i="",s=0;s<e.byteLength;)n=e[s++],r=e[s++],a=e[s++],o+=g.charAt(n>>2),o+=g.charAt((3&n)<<4|r>>4),isNaN(r)?o+="==":(o+=g.charAt((15&r)<<2|a>>6),o+=isNaN(a)?"=":g.charAt(63&a)),t&&o.length>t&&(i+=o.substr(0,t)+"\r\n",o=o.substr(t));return i+=o},f.binary.base64.decode=function(e,t,n){var r,a,o,i,s=t;s||(s=new Uint8Array(3*Math.ceil(e.length/4))),e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var l=0,u=n=n||0;l<e.length;)r=v[e.charCodeAt(l++)-43],a=v[e.charCodeAt(l++)-43],o=v[e.charCodeAt(l++)-43],i=v[e.charCodeAt(l++)-43],s[u++]=r<<2|a>>4,64!==o&&(s[u++]=(15&a)<<4|o>>2,64!==i&&(s[u++]=(3&o)<<6|i));return t?u-n:s.subarray(0,u)},f.binary.base58.encode=function(e,t){return f.binary.baseN.encode(e,m,t)},f.binary.base58.decode=function(e,t){return f.binary.baseN.decode(e,m,t)},f.text={utf8:{},utf16:{}},f.text.utf8.encode=function(e,t,n){e=f.encodeUtf8(e);var r=t;r||(r=new Uint8Array(e.length));for(var a=n=n||0,o=0;o<e.length;++o)r[a++]=e.charCodeAt(o);return t?a-n:r},f.text.utf8.decode=function(e){return f.decodeUtf8(String.fromCharCode.apply(null,e))},f.text.utf16.encode=function(e,t,n){var r=t;r||(r=new Uint8Array(2*e.length));for(var a=new Uint16Array(r.buffer),o=n=n||0,i=n,s=0;s<e.length;++s)a[i++]=e.charCodeAt(s),o+=2;return t?o-n:r},f.text.utf16.decode=function(e){return String.fromCharCode.apply(null,new Uint16Array(e.buffer))},f.deflate=function(e,t,n){if(t=f.decode64(e.deflate(f.encode64(t)).rval),n){var r=2;32&t.charCodeAt(1)&&(r=6),t=t.substring(r,t.length-4)}return t},f.inflate=function(e,t,n){var r=e.inflate(f.encode64(t)).rval;return null===r?null:f.decode64(r)};var b=function(e,t,n){if(!e)throw new Error("WebStorage not available.");var r;if(null===n?r=e.removeItem(t):(n=f.encode64(JSON.stringify(n)),r=e.setItem(t,n)),void 0!==r&&!0!==r.rval){var a=new Error(r.error.message);throw a.id=r.error.id,a.name=r.error.name,a}},x=function(e,t){if(!e)throw new Error("WebStorage not available.");var n=e.getItem(t);if(e.init)if(null===n.rval){if(n.error){var r=new Error(n.error.message);throw r.id=n.error.id,r.name=n.error.name,r}n=null}else n=n.rval;return null!==n&&(n=JSON.parse(f.decode64(n))),n},w=function(e,t,n,r){var a=x(e,t);null===a&&(a={}),a[n]=r,b(e,t,a)},I=function(e,t,n){var r=x(e,t);return null!==r&&(r=n in r?r[n]:null),r},S=function(e,t,n){var r=x(e,t);if(null!==r&&n in r){delete r[n];var a=!0;for(var o in r){a=!1;break}a&&(r=null),b(e,t,r)}},O=function(e,t){b(e,t,null)},C=function(e,t,n){var r,a=null;void 0===n&&(n=["web","flash"]);var o=!1,i=null;for(var s in n){r=n[s];try{if("flash"===r||"both"===r){if(null===t[0])throw new Error("Flash local storage not available.");a=e.apply(this,t),o="flash"===r}"web"!==r&&"both"!==r||(t[0]=localStorage,a=e.apply(this,t),o=!0)}catch(e){i=e}if(o)break}if(!o)throw i;return a};f.setItem=function(e,t,n,r,a){C(w,arguments,a)},f.getItem=function(e,t,n,r){return C(I,arguments,r)},f.removeItem=function(e,t,n,r){C(S,arguments,r)},f.clearItems=function(e,t,n){C(O,arguments,n)},f.parseUrl=function(e){var t=/^(https?):\/\/([^:&^\/]*):?(\d*)(.*)$/g;t.lastIndex=0;var n=t.exec(e),r=null===n?null:{full:e,scheme:n[1],host:n[2],port:n[3],path:n[4]};return r&&(r.fullHost=r.host,r.port?80!==r.port&&"http"===r.scheme?r.fullHost+=":"+r.port:443!==r.port&&"https"===r.scheme&&(r.fullHost+=":"+r.port):"http"===r.scheme?r.port=80:"https"===r.scheme&&(r.port=443),r.full=r.scheme+"://"+r.fullHost),r};var k=null;f.getQueryVariables=function(e){var t,n=function(e){for(var t={},n=e.split("&"),r=0;r<n.length;r++){var a,o,i=n[r].indexOf("=");i>0?(a=n[r].substring(0,i),o=n[r].substring(i+1)):(a=n[r],o=null),a in t||(t[a]=[]),a in Object.prototype||null===o||t[a].push(unescape(o))}return t};return void 0===e?(null===k&&(k="undefined"!=typeof window&&window.location&&window.location.search?n(window.location.search.substring(1)):{}),t=k):t=n(e),t},f.parseFragment=function(e){var t=e,n="",r=e.indexOf("?");r>0&&(t=e.substring(0,r),n=e.substring(r+1));var a=t.split("/");return a.length>0&&""===a[0]&&a.shift(),{pathString:t,queryString:n,path:a,query:""===n?{}:f.getQueryVariables(n)}},f.makeRequest=function(e){var t=f.parseFragment(e),n={path:t.pathString,query:t.queryString,getPath:function(e){return void 0===e?t.path:t.path[e]},getQuery:function(e,n){var r;return void 0===e?r=t.query:(r=t.query[e])&&void 0!==n&&(r=r[n]),r},getQueryLast:function(e,t){var r=n.getQuery(e);return r?r[r.length-1]:t}};return n},f.makeLink=function(e,t,r){e=n.isArray(e)?e.join("/"):e;var a=n.param(t||{});return r=r||"",e+(a.length>0?"?"+a:"")+(r.length>0?"#"+r:"")},f.setPath=function(e,t,n){if("object"==typeof e&&null!==e)for(var r=0,a=t.length;r<a;){var o=t[r++];if(r==a)e[o]=n;else{var i=o in e;(!i||i&&"object"!=typeof e[o]||i&&null===e[o])&&(e[o]={}),e=e[o]}}},f.getPath=function(e,t,n){for(var r=0,a=t.length,o=!0;o&&r<a&&"object"==typeof e&&null!==e;){var i=t[r++];(o=i in e)&&(e=e[i])}return o?e:n},f.deletePath=function(e,t){if("object"==typeof e&&null!==e)for(var n=0,r=t.length;n<r;){var a=t[n++];if(n==r)delete e[a];else{if(!(a in e)||"object"!=typeof e[a]||null===e[a])break;e=e[a]}}},f.isEmpty=function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0},f.format=function(e){for(var t,n,r=/%./g,a=0,o=[],i=0;t=r.exec(e);){(n=e.substring(i,r.lastIndex-2)).length>0&&o.push(n),i=r.lastIndex;var s=t[0][1];switch(s){case"s":case"o":a<arguments.length?o.push(arguments[1+a++]):o.push("<?>");break;case"%":o.push("%");break;default:o.push("<%"+s+"?>")}}return o.push(e.substring(i)),o.join("")},f.formatNumber=function(e,t,n,r){var a=e,o=isNaN(t=Math.abs(t))?2:t,i=void 0===n?",":n,s=void 0===r?".":r,l=a<0?"-":"",u=parseInt(a=Math.abs(+a||0).toFixed(o),10)+"",c=u.length>3?u.length%3:0;return l+(c?u.substr(0,c)+s:"")+u.substr(c).replace(/(\d{3})(?=\d)/g,"$1"+s)+(o?i+Math.abs(a-u).toFixed(o).slice(2):"")},f.formatSize=function(e){return e=e>=1073741824?f.formatNumber(e/1073741824,2,".","")+" GiB":e>=1048576?f.formatNumber(e/1048576,2,".","")+" MiB":e>=1024?f.formatNumber(e/1024,0)+" KiB":f.formatNumber(e,0)+" bytes"},f.bytesFromIP=function(e){return-1!==e.indexOf(".")?f.bytesFromIPv4(e):-1!==e.indexOf(":")?f.bytesFromIPv6(e):null},f.bytesFromIPv4=function(e){if(4!==(e=e.split(".")).length)return null;for(var t=f.createBuffer(),n=0;n<e.length;++n){var r=parseInt(e[n],10);if(isNaN(r))return null;t.putByte(r)}return t.getBytes()},f.bytesFromIPv6=function(e){for(var t=0,n=2*(8-(e=e.split(":").filter(function(e){return 0===e.length&&++t,!0})).length+t),r=f.createBuffer(),a=0;a<8;++a)if(e[a]&&0!==e[a].length){var o=f.hexToBytes(e[a]);o.length<2&&r.putByte(0),r.putBytes(o)}else r.fillWithByte(0,n),n=0;return r.getBytes()},f.bytesToIP=function(e){return 4===e.length?f.bytesToIPv4(e):16===e.length?f.bytesToIPv6(e):null},f.bytesToIPv4=function(e){if(4!==e.length)return null;for(var t=[],n=0;n<e.length;++n)t.push(e.charCodeAt(n));return t.join(".")},f.bytesToIPv6=function(e){if(16!==e.length)return null;for(var t=[],n=[],r=0,a=0;a<e.length;a+=2){for(var o=f.bytesToHex(e[a]+e[a+1]);"0"===o[0]&&"0"!==o;)o=o.substr(1);if("0"===o){var i=n[n.length-1],s=t.length;i&&s===i.end+1?(i.end=s,i.end-i.start>n[r].end-n[r].start&&(r=n.length-1)):n.push({start:s,end:s})}t.push(o)}if(n.length>0){var l=n[r];l.end-l.start>0&&(t.splice(l.start,l.end-l.start+1,""),0===l.start&&t.unshift(""),7===l.end&&t.push(""))}return t.join(":")},f.estimateCores=function(e,t){if("function"==typeof e&&(t=e,e={}),e=e||{},"cores"in f&&!e.update)return t(null,f.cores);if("undefined"!=typeof navigator&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return f.cores=navigator.hardwareConcurrency,t(null,f.cores);if("undefined"==typeof Worker)return f.cores=1,t(null,f.cores);if("undefined"==typeof Blob)return f.cores=2,t(null,f.cores);var n=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",function(e){for(var t=Date.now(),n=t+4;Date.now()<n;);self.postMessage({st:t,et:n})})}.toString(),")()"],{type:"application/javascript"}));!function e(r,a,o){if(0===a){var i=Math.floor(r.reduce(function(e,t){return e+t},0)/r.length);return f.cores=Math.max(1,i),URL.revokeObjectURL(n),t(null,f.cores)}!function(e,t){for(var r=[],a=[],o=0;o<e;++o){var i=new Worker(n);i.addEventListener("message",function(n){if(a.push(n.data),a.length===e){for(var o=0;o<e;++o)r[o].terminate();t(null,a)}}),r.push(i)}for(o=0;o<e;++o)r[o].postMessage(o)}(o,function(t,n){r.push(function(e,t){for(var n=[],r=0;r<e;++r)for(var a=t[r],o=n[r]=[],i=0;i<e;++i)if(r!==i){var s=t[i];(a.st>s.st&&a.st<s.et||s.st>a.st&&s.st<a.et)&&o.push(i)}return n.reduce(function(e,t){return Math.max(e,t.length)},0)}(o,n)),e(r,a-1,o)})}([],5,16)}}).call(this,e("_process"),void 0!==t?t:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],e("timers").setImmediate)},{"./baseN":25,"./forge":26,_process:31,buffer:1,timers:43}],31:[function(e,t,n){var r,a,o=t.exports={};function i(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function l(e){if(r===setTimeout)return setTimeout(e,0);if((r===i||!r)&&setTimeout)return r=setTimeout,setTimeout(e,0);try{return r(e,0)}catch(t){try{return r.call(null,e,0)}catch(t){return r.call(this,e,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:i}catch(e){r=i}try{a="function"==typeof clearTimeout?clearTimeout:s}catch(e){a=s}}();var u,c=[],d=!1,p=-1;function f(){d&&u&&(d=!1,u.length?c=u.concat(c):p=-1,c.length&&h())}function h(){if(!d){var e=l(f);d=!0;for(var t=c.length;t;){for(u=c,c=[];++p<t;)u&&u[p].run();p=-1,t=c.length}u=null,d=!1,function(e){if(a===clearTimeout)return clearTimeout(e);if((a===s||!a)&&clearTimeout)return a=clearTimeout,clearTimeout(e);try{a(e)}catch(t){try{return a.call(null,e)}catch(t){return a.call(this,e)}}}(e)}}function y(e,t){this.fun=e,this.array=t}function g(){}o.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];c.push(new y(e,t)),1!==c.length||d||l(h)},y.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=g,o.addListener=g,o.once=g,o.off=g,o.removeListener=g,o.removeAllListeners=g,o.emit=g,o.prependListener=g,o.prependOnceListener=g,o.listeners=function(e){return[]},o.binding=function(e){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(e){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},{}],32:[function(e,t,n){"use strict";const r=e("./util");t.exports=class{constructor({maxCallStackDepth:e=500,maxTotalCallStackDepth:t=4294967295,timeSlice:n=10}={}){this.schedule={},this.schedule.MAX_DEPTH=e,this.schedule.MAX_TOTAL_DEPTH=t,this.schedule.depth=0,this.schedule.totalDepth=0,this.schedule.timeSlice=n}doWork(e,t){const n=this.schedule;if(n.totalDepth>=n.MAX_TOTAL_DEPTH)return t(new Error("Maximum total call stack depth exceeded; canonicalization aborting."));!function a(){if(n.depth===n.MAX_DEPTH)return n.depth=0,n.running=!1,r.nextTick(a);const o=Date.now();if(n.running||(n.start=Date.now(),n.deadline=n.start+n.timeSlice),o<n.deadline)return n.running=!0,n.depth++,n.totalDepth++,e((e,r)=>{n.depth--,n.totalDepth--,t(e,r)});n.depth=0,n.running=!1,r.setImmediate(a)}()}forEach(e,t,n){const r=this;let a,o,i=0;if(Array.isArray(e))o=e.length,a=()=>i!==o&&(a.value=e[i++],a.key=i,!0);else{const t=Object.keys(e);o=t.length,a=()=>i!==o&&(a.key=t[i++],a.value=e[a.key],!0)}!function e(o){return o?n(o):a()?r.doWork(()=>t(a.value,a.key,e)):void n()}()}waterfall(e,t){const n=this;n.forEach(e,(e,t,r)=>n.doWork(e,r),t)}whilst(e,t,n){const r=this;!function a(o){return o?n(o):e()?void r.doWork(t,a):n()}()}}},{"./util":42}],33:[function(e,t,n){"use strict";const r=e("./util");t.exports=class e{constructor(e){this.prefix=e,this.counter=0,this.existing={}}clone(){const t=new e(this.prefix);return t.counter=this.counter,t.existing=r.clone(this.existing),t}getId(e){if(e&&e in this.existing)return this.existing[e];const t=this.prefix+this.counter;return this.counter+=1,e&&(this.existing[e]=t),t}hasId(e){return e in this.existing}}},{"./util":42}],34:[function(e,t,n){"use strict";const r=e("node-forge/lib/forge");e("node-forge/lib/md"),e("node-forge/lib/sha1"),e("node-forge/lib/sha256"),t.exports=class{constructor(e){this.md=r.md[e].create()}update(e){this.md.update(e,"utf8")}digest(){return this.md.digest().toHex()}}},{"node-forge/lib/forge":26,"node-forge/lib/md":27,"node-forge/lib/sha1":28,"node-forge/lib/sha256":29}],35:[function(e,t,n){"use strict";const r="http://www.w3.org/1999/02/22-rdf-syntax-ns#langString",a="http://www.w3.org/2001/XMLSchema#string",o={};function i(e,t){for(const n in e)if(e[n].termType!==t[n].termType||e[n].value!==t[n].value)return!1;return"Literal"!==e.object.termType||e.object.datatype.termType===t.object.datatype.termType&&e.object.datatype.value===t.object.datatype.value&&e.object.language===t.object.language}o.eoln=/(?:\r\n)|(?:\n)|(?:\r)/g,o.empty=new RegExp("^[ \\t]*$"),o.quad=new RegExp('^[ \\t]*(?:(?:<([^:]+:[^>]*)>)|(_:(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9])(?:(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9-\xb7\u0300-\u036f\u203f-\u2040.])*(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9-\xb7\u0300-\u036f\u203f-\u2040]))?))[ \\t]+(?:<([^:]+:[^>]*)>)[ \\t]+(?:(?:<([^:]+:[^>]*)>)|(_:(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9])(?:(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9-\xb7\u0300-\u036f\u203f-\u2040.])*(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9-\xb7\u0300-\u036f\u203f-\u2040]))?)|(?:"([^"\\\\]*(?:\\\\.[^"\\\\]*)*)"(?:(?:\\^\\^(?:<([^:]+:[^>]*)>))|(?:@([a-zA-Z]+(?:-[a-zA-Z0-9]+)*)))?))[ \\t]*(?:\\.|(?:(?:(?:<([^:]+:[^>]*)>)|(_:(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9])(?:(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9-\xb7\u0300-\u036f\u203f-\u2040.])*(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9-\xb7\u0300-\u036f\u203f-\u2040]))?))[ \\t]*\\.))[ \\t]*$'),t.exports=class e{static parse(e){const t=[],n={},s=e.split(o.eoln);let u=0;for(const e of s){if(u++,o.empty.test(e))continue;const s=e.match(o.quad);if(null===s)throw new Error("N-Quads parse error on line "+u+".");const c={};if(void 0!==s[1]?c.subject={termType:"NamedNode",value:s[1]}:c.subject={termType:"BlankNode",value:s[2]},c.predicate={termType:"NamedNode",value:s[3]},void 0!==s[4]?c.object={termType:"NamedNode",value:s[4]}:void 0!==s[5]?c.object={termType:"BlankNode",value:s[5]}:(c.object={termType:"Literal",value:void 0,datatype:{termType:"NamedNode"}},void 0!==s[7]?c.object.datatype.value=s[7]:void 0!==s[8]?(c.object.datatype.value=r,c.object.language=s[8]):c.object.datatype.value=a,c.object.value=s[6].replace(l,function(e,t,n,r){if(t)switch(t){case"t":return"\t";case"b":return"\b";case"n":return"\n";case"r":return"\r";case"f":return"\f";case'"':return'"';case"'":return"'";case"\\":return"\\"}if(n)return String.fromCharCode(parseInt(n,16));if(r)throw new Error("Unsupported U escape")})),void 0!==s[9]?c.graph={termType:"NamedNode",value:s[9]}:void 0!==s[10]?c.graph={termType:"BlankNode",value:s[10]}:c.graph={termType:"DefaultGraph",value:""},c.graph.value in n){let e=!0;const r=n[c.graph.value];for(const t of r)if(i(t,c)){e=!1;break}e&&(r.push(c),t.push(c))}else n[c.graph.value]=[c],t.push(c)}return t}static serialize(t){Array.isArray(t)||(t=e.legacyDatasetToQuads(t));const n=[];for(const r of t)n.push(e.serializeQuad(r));return n.sort().join("")}static serializeQuad(e){const t=e.subject,n=e.predicate,o=e.object,i=e.graph;let l="";return[t,n].forEach(e=>{"NamedNode"===e.termType?l+="<"+e.value+">":l+=e.value,l+=" "}),"NamedNode"===o.termType?l+="<"+o.value+">":"BlankNode"===o.termType?l+=o.value:(l+='"'+function(e){return e.replace(s,function(e){switch(e){case'"':return'\\"';case"\\":return"\\\\";case"\n":return"\\n";case"\r":return"\\r"}})}(o.value)+'"',o.datatype.value===r?o.language&&(l+="@"+o.language):o.datatype.value!==a&&(l+="^^<"+o.datatype.value+">")),"NamedNode"===i.termType?l+=" <"+i.value+">":"BlankNode"===i.termType&&(l+=" "+i.value),l+=" .\n"}static legacyDatasetToQuads(e){const t=[],n={"blank node":"BlankNode",IRI:"NamedNode",literal:"Literal"};for(const o in e)e[o].forEach(e=>{const i={};for(const t in e){const o=e[t],s={termType:n[o.type],value:o.value};"Literal"===s.termType&&(s.datatype={termType:"NamedNode"},"datatype"in o&&(s.datatype.value=o.datatype),"language"in o?("datatype"in o||(s.datatype.value=r),s.language=o.language):"datatype"in o||(s.datatype.value=a)),i[t]=s}i.graph="@default"===o?{termType:"DefaultGraph",value:""}:{termType:o.startsWith("_:")?"BlankNode":"NamedNode",value:o},t.push(i)});return t}};const s=/["\\\n\r]/g,l=/(?:\\([tbnrf"'\\]))|(?:\\u([0-9A-Fa-f]{4}))|(?:\\U([0-9A-Fa-f]{8}))/g},{}],36:[function(e,t,n){"use strict";t.exports=class{constructor(e){this.list=e.sort(),this.done=!1,this.left={};for(let t=0;t<e.length;++t)this.left[e[t]]=!0}hasNext(){return!this.done}next(){const e=this.list.slice();let t=null,n=0;const r=this.list.length;for(let e=0;e<r;++e){const a=this.list[e],o=this.left[a];(null===t||a>t)&&(o&&e>0&&a>this.list[e-1]||!o&&e<r-1&&a>this.list[e+1])&&(t=a,n=e)}if(null===t)this.done=!0;else{const e=this.left[t]?n-1:n+1;this.list[n]=this.list[e],this.list[e]=t;for(let e=0;e<r;++e)this.list[e]>t&&(this.left[this.list[e]]=!this.left[this.list[e]])}return e}}},{}],37:[function(e,t,n){"use strict";const r=e("./AsyncAlgorithm"),a=e("./IdentifierIssuer"),o=e("./MessageDigest"),i=e("./Permutator"),s=e("./NQuads"),l=e("./util"),u={subject:"s",object:"o",graph:"g"};t.exports=class extends r{constructor(e){super(e=e||{}),this.name="URDNA2015",this.options=Object.assign({},e),this.blankNodeInfo={},this.hashToBlankNodes={},this.canonicalIssuer=new a("_:c14n"),this.hashAlgorithm="sha256",this.quads}main(e,t){const n=this;let r;n.schedule.start=Date.now(),n.quads=e;const o={};n.waterfall([t=>{n.forEach(e,(e,t,r)=>{n.forEachComponent(e,t=>{if("BlankNode"!==t.termType)return;const r=t.value;r in n.blankNodeInfo?n.blankNodeInfo[r].quads.push(e):(o[r]=!0,n.blankNodeInfo[r]={quads:[e]})}),r()},t)},e=>{let t=!0;n.whilst(()=>t,e=>{t=!1,n.hashToBlankNodes={},n.waterfall([e=>{n.forEach(o,(e,t,r)=>{n.hashFirstDegreeQuads(t,(e,a)=>{if(e)return r(e);a in n.hashToBlankNodes?n.hashToBlankNodes[a].push(t):n.hashToBlankNodes[a]=[t],r()})},e)},e=>{const r=Object.keys(n.hashToBlankNodes).sort();n.forEach(r,(e,r,a)=>{const i=n.hashToBlankNodes[e];if(i.length>1)return a();const s=i[0];n.canonicalIssuer.getId(s),delete o[s],delete n.hashToBlankNodes[e],t=!0,a()},e)}],e)},e)},e=>{const t=Object.keys(n.hashToBlankNodes).sort();n.forEach(t,(e,t,r)=>{const o=[],i=n.hashToBlankNodes[e];n.waterfall([e=>{n.forEach(i,(e,t,r)=>{if(n.canonicalIssuer.hasId(e))return r();const i=new a("_:b");i.getId(e),n.hashNDegreeQuads(e,i,(e,t)=>{if(e)return r(e);o.push(t),r()})},e)},e=>{o.sort((e,t)=>e.hash<t.hash?-1:e.hash>t.hash?1:0),n.forEach(o,(e,t,r)=>{for(const t in e.issuer.existing)n.canonicalIssuer.getId(t);r()},e)}],r)},e)},e=>{const t=[];n.waterfall([e=>{n.forEach(n.quads,(e,r,a)=>{n.forEachComponent(e,e=>{"BlankNode"!==e.termType||e.value.startsWith(n.canonicalIssuer.prefix)||(e.value=n.canonicalIssuer.getId(e.value))}),t.push(s.serializeQuad(e)),a()},e)},e=>(t.sort(),r=t.join(""),e())],e)}],e=>t(e,r))}hashFirstDegreeQuads(e,t){const n=this,r=n.blankNodeInfo[e];if("hash"in r)return t(null,r.hash);const a=[],i=r.quads;n.forEach(i,(t,r,o)=>{const i={predicate:t.predicate};n.forEachComponent(t,(t,r)=>{i[r]=n.modifyFirstDegreeComponent(e,t,r)}),a.push(s.serializeQuad(i)),o()},e=>{if(e)return t(e);a.sort();const i=new o(n.hashAlgorithm);for(let e=0;e<a.length;++e)i.update(a[e]);r.hash=i.digest(),t(null,r.hash)})}hashRelatedBlankNode(e,t,n,r,a){const i=this;let s;i.waterfall([t=>i.canonicalIssuer.hasId(e)?(s=i.canonicalIssuer.getId(e),t()):n.hasId(e)?(s=n.getId(e),t()):void i.hashFirstDegreeQuads(e,(e,n)=>{if(e)return t(e);s=n,t()})],e=>{if(e)return a(e);const n=new o(i.hashAlgorithm);return n.update(r),"g"!==r&&n.update(i.getRelatedPredicate(t)),n.update(s),a(null,n.digest())})}hashNDegreeQuads(e,t,n){const r=this;let a;const s=new o(r.hashAlgorithm);r.waterfall([n=>r.createHashToRelated(e,t,(e,t)=>{if(e)return n(e);a=t,n()}),e=>{const n=Object.keys(a).sort();r.forEach(n,(e,n,o)=>{s.update(e);let l,u="";const c=new i(a[e]);r.whilst(()=>c.hasNext(),e=>{const n=c.next();let a=t.clone(),o="";const i=[];r.waterfall([t=>{r.forEach(n,(t,n,s)=>{if(r.canonicalIssuer.hasId(t)?o+=r.canonicalIssuer.getId(t):(a.hasId(t)||i.push(t),o+=a.getId(t)),0!==u.length&&o.length>=u.length&&o>u)return e();s()},t)},t=>{r.forEach(i,(t,n,i)=>{r.hashNDegreeQuads(t,a,(n,r)=>n?i(n):(o+=a.getId(t),o+="<"+r.hash+">",a=r.issuer,0!==u.length&&o.length>=u.length&&o>u?e():void i()))},t)},e=>{(0===u.length||o<u)&&(u=o,l=a),e()}],e)},e=>{if(e)return o(e);s.update(u),t=l,o()})},e)}],e=>{n(e,{hash:s.digest(),issuer:t})})}modifyFirstDegreeComponent(e,t){return"BlankNode"!==t.termType?t:((t=l.clone(t)).value=t.value===e?"_:a":"_:z",t)}getRelatedPredicate(e){return"<"+e.predicate.value+">"}createHashToRelated(e,t,n){const r=this,a={},o=r.blankNodeInfo[e].quads;r.forEach(o,(n,o,i)=>{r.forEach(n,(o,i,s)=>{if("predicate"===i||"BlankNode"!==o.termType||o.value===e)return s();const l=o.value,c=u[i];r.hashRelatedBlankNode(l,n,t,c,(e,t)=>{if(e)return s(e);t in a?a[t].push(l):a[t]=[l],s()})},i)},e=>n(e,a))}forEachComponent(e,t){for(const n in e)"predicate"!==n&&t(e[n],n,e)}}},{"./AsyncAlgorithm":32,"./IdentifierIssuer":33,"./MessageDigest":34,"./NQuads":35,"./Permutator":36,"./util":42}],38:[function(e,t,n){"use strict";const r=e("./IdentifierIssuer"),a=e("./MessageDigest"),o=e("./Permutator"),i=e("./NQuads"),s=e("./util"),l={subject:"s",object:"o",graph:"g"};t.exports=class{constructor(){this.name="URDNA2015",this.blankNodeInfo={},this.hashToBlankNodes={},this.canonicalIssuer=new r("_:c14n"),this.hashAlgorithm="sha256",this.quads}main(e){const t=this;t.quads=e;const n={};for(const r of e)t.forEachComponent(r,e=>{if("BlankNode"!==e.termType)return;const a=e.value;a in t.blankNodeInfo?t.blankNodeInfo[a].quads.push(r):(n[a]=!0,t.blankNodeInfo[a]={quads:[r]})});let a=!0;for(;a;){a=!1,t.hashToBlankNodes={};for(const e in n){const n=t.hashFirstDegreeQuads(e);n in t.hashToBlankNodes?t.hashToBlankNodes[n].push(e):t.hashToBlankNodes[n]=[e]}const e=Object.keys(t.hashToBlankNodes).sort();for(let r=0;r<e.length;++r){const o=e[r],i=t.hashToBlankNodes[o];if(i.length>1)continue;const s=i[0];t.canonicalIssuer.getId(s),delete n[s],delete t.hashToBlankNodes[o],a=!0}}const o=Object.keys(t.hashToBlankNodes).sort();for(let e=0;e<o.length;++e){const n=[],a=o[e],i=t.hashToBlankNodes[a];for(let e=0;e<i.length;++e){const a=i[e];if(t.canonicalIssuer.hasId(a))continue;const o=new r("_:b");o.getId(a);const s=t.hashNDegreeQuads(a,o);n.push(s)}n.sort((e,t)=>e.hash<t.hash?-1:e.hash>t.hash?1:0);for(let e=0;e<n.length;++e){const r=n[e];for(const e in r.issuer.existing)t.canonicalIssuer.getId(e)}}const s=[];for(let e=0;e<t.quads.length;++e){const n=t.quads[e];t.forEachComponent(n,e=>{"BlankNode"!==e.termType||e.value.startsWith(t.canonicalIssuer.prefix)||(e.value=t.canonicalIssuer.getId(e.value))}),s.push(i.serializeQuad(n))}return s.sort(),s.join("")}hashFirstDegreeQuads(e){const t=this,n=t.blankNodeInfo[e];if("hash"in n)return n.hash;const r=[],o=n.quads;for(let n=0;n<o.length;++n){const a=o[n],s={predicate:a.predicate};t.forEachComponent(a,(n,r)=>{s[r]=t.modifyFirstDegreeComponent(e,n,r)}),r.push(i.serializeQuad(s))}r.sort();const s=new a(t.hashAlgorithm);for(let e=0;e<r.length;++e)s.update(r[e]);return n.hash=s.digest(),n.hash}hashRelatedBlankNode(e,t,n,r){const o=this;let i;i=o.canonicalIssuer.hasId(e)?o.canonicalIssuer.getId(e):n.hasId(e)?n.getId(e):o.hashFirstDegreeQuads(e);const s=new a(o.hashAlgorithm);return s.update(r),"g"!==r&&s.update(o.getRelatedPredicate(t)),s.update(i),s.digest()}hashNDegreeQuads(e,t){const n=this,r=new a(n.hashAlgorithm),i=n.createHashToRelated(e,t),s=Object.keys(i).sort();for(let e=0;e<s.length;++e){const a=s[e];r.update(a);let l,u="";const c=new o(i[a]);for(;c.hasNext();){const e=c.next();let r=t.clone(),a="";const o=[];let i=!1;for(let t=0;t<e.length;++t){const s=e[t];if(n.canonicalIssuer.hasId(s)?a+=n.canonicalIssuer.getId(s):(r.hasId(s)||o.push(s),a+=r.getId(s)),0!==u.length&&a.length>=u.length&&a>u){i=!0;break}}if(!i){for(let e=0;e<o.length;++e){const t=o[e],s=n.hashNDegreeQuads(t,r);if(a+=r.getId(t),a+="<"+s.hash+">",r=s.issuer,0!==u.length&&a.length>=u.length&&a>u){i=!0;break}}i||(0===u.length||a<u)&&(u=a,l=r)}}r.update(u),t=l}return{hash:r.digest(),issuer:t}}modifyFirstDegreeComponent(e,t){return"BlankNode"!==t.termType?t:((t=s.clone(t)).value=t.value===e?"_:a":"_:z",t)}getRelatedPredicate(e){return"<"+e.predicate.value+">"}createHashToRelated(e,t){const n=this,r={},a=n.blankNodeInfo[e].quads;for(let o=0;o<a.length;++o){const i=a[o];for(const a in i){const o=i[a];if("predicate"===a||"BlankNode"!==o.termType||o.value===e)continue;const s=o.value,u=l[a],c=n.hashRelatedBlankNode(s,i,t,u);c in r?r[c].push(s):r[c]=[s]}}return r}forEachComponent(e,t){for(const n in e)"predicate"!==n&&t(e[n],n,e)}}},{"./IdentifierIssuer":33,"./MessageDigest":34,"./NQuads":35,"./Permutator":36,"./util":42}],39:[function(e,t,n){"use strict";const r=e("./URDNA2015"),a=e("./util");t.exports=class extends r{constructor(e){super(e),this.name="URGNA2012",this.hashAlgorithm="sha1"}modifyFirstDegreeComponent(e,t,n){return"BlankNode"!==t.termType?t:((t=a.clone(t)).value="name"===n?"_:g":t.value===e?"_:a":"_:z",t)}getRelatedPredicate(e){return e.predicate.value}createHashToRelated(e,t,n){const r=this,a={},o=r.blankNodeInfo[e].quads;r.forEach(o,(n,o,i)=>{let s,l;if("BlankNode"===n.subject.termType&&n.subject.value!==e)l=n.subject.value,s="p";else{if("BlankNode"!==n.object.termType||n.object.value===e)return i();l=n.object.value,s="r"}r.hashRelatedBlankNode(l,n,t,s,(e,t)=>{if(e)return i(e);t in a?a[t].push(l):a[t]=[l],i()})},e=>n(e,a))}}},{"./URDNA2015":37,"./util":42}],40:[function(e,t,n){"use strict";const r=e("./URDNA2015Sync"),a=e("./util");t.exports=class extends r{constructor(){super(),this.name="URGNA2012",this.hashAlgorithm="sha1"}modifyFirstDegreeComponent(e,t,n){return"BlankNode"!==t.termType?t:((t=a.clone(t)).value="name"===n?"_:g":t.value===e?"_:a":"_:z",t)}getRelatedPredicate(e){return e.predicate.value}createHashToRelated(e,t){const n=this,r={},a=n.blankNodeInfo[e].quads;for(let o=0;o<a.length;++o){const i=a[o];let s,l;if("BlankNode"===i.subject.termType&&i.subject.value!==e)l=i.subject.value,s="p";else{if("BlankNode"!==i.object.termType||i.object.value===e)continue;l=i.object.value,s="r"}const u=n.hashRelatedBlankNode(l,i,t,s);u in r?r[u].push(l):r[u]=[l]}return r}}},{"./URDNA2015Sync":38,"./util":42}],41:[function(e,t,n){"use strict";const r=e("./util"),a=e("./URDNA2015"),o=e("./URGNA2012"),i=e("./URDNA2015Sync"),s=e("./URGNA2012Sync");let l;try{l=e("rdf-canonize-native")}catch(e){}const u={};t.exports=u,u.NQuads=e("./NQuads"),u.IdentifierIssuer=e("./IdentifierIssuer"),u._rdfCanonizeNative=function(e){return e&&(l=e),l},u.canonize=r.callbackify(async function(e,t){let n;const r=new Promise((e,t)=>{n=(n,r)=>{if(n)return t(n);e(r)}});if(Array.isArray(e)||(e=u.NQuads.legacyDatasetToQuads(e)),t.useNative){if(!l)throw new Error("rdf-canonize-native not available");l.canonize(e,t,n)}else if("URDNA2015"===t.algorithm)new a(t).main(e,n);else{if("URGNA2012"!==t.algorithm)throw"algorithm"in t?new Error("Invalid RDF Dataset Canonicalization algorithm: "+t.algorithm):new Error("No RDF Dataset Canonicalization algorithm specified.");new o(t).main(e,n)}return r}),u.canonizeSync=function(e,t){if(Array.isArray(e)||(e=u.NQuads.legacyDatasetToQuads(e)),t.useNative){if(l)return l.canonizeSync(e,t);throw new Error("rdf-canonize-native not available")}if("URDNA2015"===t.algorithm)return new i(t).main(e);if("URGNA2012"===t.algorithm)return new s(t).main(e);if(!("algorithm"in t))throw new Error("No RDF Dataset Canonicalization algorithm specified.");throw new Error("Invalid RDF Dataset Canonicalization algorithm: "+t.algorithm)}},{"./IdentifierIssuer":33,"./NQuads":35,"./URDNA2015":37,"./URDNA2015Sync":38,"./URGNA2012":39,"./URGNA2012Sync":40,"./util":42,"rdf-canonize-native":1}],42:[function(e,t,n){(function(e,n){"use strict";const r={};t.exports=r;const a="function"==typeof n&&n,o=a?e=>a(e):e=>setTimeout(e,0);function i(t,n,r){try{return t(n,r)}catch(t){e.nextTick(()=>{throw t})}}"object"==typeof e&&"function"==typeof e.nextTick?r.nextTick=e.nextTick:r.nextTick=o,r.setImmediate=a?o:r.nextTick,r.clone=function(e){if(e&&"object"==typeof e){let t;if(Array.isArray(e)){t=[];for(let n=0;n<e.length;++n)t[n]=r.clone(e[n])}else if(r.isObject(e)){t={};for(const n in e)t[n]=r.clone(e[n])}else t=e.toString();return t}return e},r.isObject=e=>"[object Object]"===Object.prototype.toString.call(e),r.isUndefined=e=>void 0===e,r.callbackify=e=>(async function(...t){const n=t[t.length-1];let r;"function"==typeof n&&t.pop();try{r=await e.apply(null,t)}catch(e){if("function"==typeof n)return i(n,e);throw e}return"function"==typeof n?i(n,null,r):r})}).call(this,e("_process"),e("timers").setImmediate)},{_process:31,timers:43}],43:[function(e,t,n){(function(t,r){var a=e("process/browser.js").nextTick,o=Function.prototype.apply,i=Array.prototype.slice,s={},l=0;function u(e,t){this._id=e,this._clearFn=t}n.setTimeout=function(){return new u(o.call(setTimeout,window,arguments),clearTimeout)},n.setInterval=function(){return new u(o.call(setInterval,window,arguments),clearInterval)},n.clearTimeout=n.clearInterval=function(e){e.close()},u.prototype.unref=u.prototype.ref=function(){},u.prototype.close=function(){this._clearFn.call(window,this._id)},n.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},n.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},n._unrefActive=n.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout(function(){e._onTimeout&&e._onTimeout()},t))},n.setImmediate="function"==typeof t?t:function(e){var t=l++,r=!(arguments.length<2)&&i.call(arguments,1);return s[t]=!0,a(function(){s[t]&&(r?e.apply(null,r):e.call(null),n.clearImmediate(t))}),t},n.clearImmediate="function"==typeof r?r:function(e){delete s[e]}}).call(this,e("timers").setImmediate,e("timers").clearImmediate)},{"process/browser.js":31,timers:43}],44:[function(e,t,n){"use strict";var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function a(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var o=e("./utilities"),i=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.IRI=t,this.graph=n}return r(e,[{key:"getIRI",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return e?this.IRI:o.toAbsoluteIRI(this.IRI,this.graph.context)}},{key:"getTermType",value:function(){return"rdfs:Class"}},{key:"getVocabulary",value:function(){var e=this.graph.classes[this.IRI];return void 0!==e["schema:isPartOf"]?e["schema:isPartOf"]:null}},{key:"getSource",value:function(){var e=this.graph.classes[this.IRI];return void 0!==e["dc:source"]?e["dc:source"]:null}},{key:"isSupersededBy",value:function(){var e=this.graph.classes[this.IRI];return o.isString(e["schema:supersededBy"])?e["schema:supersededBy"]:null}},{key:"getName",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"en",t=this.graph.classes[this.IRI]["rdfs:label"];return null===t||void 0===t[e]?null:t[e]}},{key:"getDescription",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"en",t=this.graph.classes[this.IRI]["rdfs:comment"];return null===t||void 0===t[e]?null:t[e]}},{key:"getProperties",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this.graph.classes[this.IRI],r=[];return r.push.apply(r,a(n["soa:hasProperty"])),!0===e&&r.push.apply(r,a(this.graph.reasoner.inferPropertiesFromSuperClasses(n["rdfs:subClassOf"]))),o.applyFilter(o.uniquifyArray(r),t,this.graph)}},{key:"getSuperClasses",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this.graph.classes[this.IRI],r=[];return!0===e?r.push.apply(r,a(this.graph.reasoner.inferImplicitSuperClasses(this.IRI))):r.push.apply(r,a(n["rdfs:subClassOf"])),o.applyFilter(o.uniquifyArray(r),t,this.graph)}},{key:"getSubClasses",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this.graph.classes[this.IRI],r=[];return!0===e?r.push.apply(r,a(this.graph.reasoner.inferImplicitSubClasses(this.IRI))):r.push.apply(r,a(n["soa:superClassOf"])),o.applyFilter(o.uniquifyArray(r),t,this.graph)}},{key:"toString",value:function(){return JSON.stringify(this.toJSON(!1,null),null,2)}},{key:"toJSON",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n={};return n.id=this.getIRI(!0),n.IRI=this.getIRI(),n.type=this.getTermType(),n.vocabulary=this.getVocabulary(),n.source=this.getSource(),n.supersededBy=this.isSupersededBy(),n.name=this.getName(),n.description=this.getDescription(),n.superClasses=this.getSuperClasses(e,t),n.subClasses=this.getSubClasses(e,t),n.properties=this.getProperties(e,t),n}}]),e}();t.exports=i},{"./utilities":52}],45:[function(e,t,n){"use strict";var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function a(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var o=e("./utilities"),i=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.IRI=t,this.graph=n}return r(e,[{key:"getIRI",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return e?this.IRI:o.toAbsoluteIRI(this.IRI,this.graph.context)}},{key:"getTermType",value:function(){return"schema:DataType"}},{key:"getVocabulary",value:function(){var e=this.graph.dataTypes[this.IRI];return void 0!==e["schema:isPartOf"]?e["schema:isPartOf"]:null}},{key:"getSource",value:function(){var e=this.graph.dataTypes[this.IRI];return void 0!==e["dc:source"]?e["dc:source"]:null}},{key:"isSupersededBy",value:function(){var e=this.graph.dataTypes[this.IRI];return o.isString(e["schema:supersededBy"])?e["schema:supersededBy"]:null}},{key:"getName",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"en",t=this.graph.dataTypes[this.IRI]["rdfs:label"];return null===t||void 0===t[e]?null:t[e]}},{key:"getDescription",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"en",t=this.graph.dataTypes[this.IRI]["rdfs:comment"];return null===t||void 0===t[e]?null:t[e]}},{key:"getSuperDataTypes",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this.graph.dataTypes[this.IRI],r=[];return!0===e?r.push.apply(r,a(this.graph.reasoner.inferImplicitSuperDataTypes(this.IRI))):r.push.apply(r,a(n["rdfs:subClassOf"])),o.applyFilter(o.uniquifyArray(r),t,this.graph)}},{key:"getSubDataTypes",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this.graph.dataTypes[this.IRI],r=[];return!0===e?r.push.apply(r,a(this.graph.reasoner.inferImplicitSubDataTypes(this.IRI))):r.push.apply(r,a(n["soa:superClassOf"])),o.applyFilter(o.uniquifyArray(r),t,this.graph)}},{key:"toString",value:function(){return JSON.stringify(this.toJSON(!1,null),null,2)}},{key:"toJSON",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n={};return n.id=this.getIRI(!0),n.IRI=this.getIRI(),n.type=this.getTermType(),n.vocabulary=this.getVocabulary(),n.source=this.getSource(),n.supersededBy=this.isSupersededBy(),n.name=this.getName(),n.description=this.getDescription(),n.superDataTypes=this.getSuperDataTypes(e,t),n.subDataTypes=this.getSubDataTypes(e,t),n}}]),e}();t.exports=i},{"./utilities":52}],46:[function(e,t,n){"use strict";var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function a(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var o=e("./utilities"),i=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.IRI=t,this.graph=n}return r(e,[{key:"getIRI",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return e?this.IRI:o.toAbsoluteIRI(this.IRI,this.graph.context)}},{key:"getTermType",value:function(){return"schema:Enumeration"}},{key:"getVocabulary",value:function(){var e=this.graph.enumerations[this.IRI];return void 0!==e["schema:isPartOf"]?e["schema:isPartOf"]:null}},{key:"getSource",value:function(){var e=this.graph.enumerations[this.IRI];return void 0!==e["dc:source"]?e["dc:source"]:null}},{key:"isSupersededBy",value:function(){var e=this.graph.enumerations[this.IRI];return o.isString(e["schema:supersededBy"])?e["schema:supersededBy"]:null}},{key:"getName",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"en",t=this.graph.enumerations[this.IRI]["rdfs:label"];return null===t||void 0===t[e]?null:t[e]}},{key:"getDescription",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"en",t=this.graph.enumerations[this.IRI]["rdfs:comment"];return null===t||void 0===t[e]?null:t[e]}},{key:"getEnumerationMembers",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=this.graph.enumerations[this.IRI],n=t["soa:hasEnumerationMember"];return o.applyFilter(o.uniquifyArray(n),e,this.graph)}},{key:"getProperties",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this.graph.enumerations[this.IRI],r=[];return r.push.apply(r,a(n["soa:hasProperty"])),!0===e&&r.push.apply(r,a(this.graph.reasoner.inferPropertiesFromSuperClasses(n["rdfs:subClassOf"]))),o.applyFilter(o.uniquifyArray(r),t,this.graph)}},{key:"getSuperClasses",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this.graph.enumerations[this.IRI],r=[];return!0===e?r.push.apply(r,a(this.graph.reasoner.inferImplicitSuperClasses(this.IRI))):r.push.apply(r,a(n["rdfs:subClassOf"])),o.applyFilter(o.uniquifyArray(r),t,this.graph)}},{key:"getSubClasses",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this.graph.enumerations[this.IRI],r=[];return!0===e?r.push.apply(r,a(this.graph.reasoner.inferImplicitSubClasses(this.IRI))):r.push.apply(r,a(n["soa:superClassOf"])),o.applyFilter(o.uniquifyArray(r),t,this.graph)}},{key:"toString",value:function(){return JSON.stringify(this.toJSON(!1,null),null,2)}},{key:"toJSON",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n={};return n.id=this.getIRI(!0),n.IRI=this.getIRI(),n.type=this.getTermType(),n.vocabulary=this.getVocabulary(),n.source=this.getSource(),n.supersededBy=this.isSupersededBy(),n.name=this.getName(),n.description=this.getDescription(),n.enumerationMembers=this.getEnumerationMembers(t),n.superClasses=this.getSuperClasses(e,t),n.subClasses=this.getSubClasses(e,t),n.properties=this.getProperties(e,t),n}}]),e}();t.exports=i},{"./utilities":52}],47:[function(e,t,n){"use strict";var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=e("./utilities"),o=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.IRI=t,this.graph=n}return r(e,[{key:"getIRI",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return e?this.IRI:a.toAbsoluteIRI(this.IRI,this.graph.context)}},{key:"getTermType",value:function(){return"soa:EnumerationMember"}},{key:"getVocabulary",value:function(){var e=this.graph.enumerationMembers[this.IRI];return void 0!==e["schema:isPartOf"]?e["schema:isPartOf"]:null}},{key:"getSource",value:function(){var e=this.graph.enumerationMembers[this.IRI];return void 0!==e["dc:source"]?e["dc:source"]:null}},{key:"isSupersededBy",value:function(){var e=this.graph.enumerationMembers[this.IRI];return a.isString(e["schema:supersededBy"])?e["schema:supersededBy"]:null}},{key:"getName",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"en",t=this.graph.enumerationMembers[this.IRI]["rdfs:label"];return null===t||void 0===t[e]?null:t[e]}},{key:"getDescription",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"en",t=this.graph.enumerationMembers[this.IRI]["rdfs:comment"];return null===t||void 0===t[e]?null:t[e]}},{key:"getDomainEnumerations",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=this.graph.enumerationMembers[this.IRI],n=t["soa:enumerationDomainIncludes"];return a.applyFilter(a.uniquifyArray(n),e,this.graph)}},{key:"toString",value:function(){return JSON.stringify(this.toJSON(!1,null),null,2)}},{key:"toJSON",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t={};return t.id=this.getIRI(!0),t.IRI=this.getIRI(),t.type=this.getTermType(),t.vocabulary=this.getVocabulary(),t.source=this.getSource(),t.supersededBy=this.isSupersededBy(),t.name=this.getName(),t.description=this.getDescription(),t.domainEnumerations=this.getDomainEnumerations(e),t}}]),e}();t.exports=o},{"./utilities":52}],48:[function(e,t,n){"use strict";var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=e("./utilities"),o=e("./Class"),i=e("./Property"),s=e("./Enumeration"),l=e("./EnumerationMember"),u=e("./DataType"),c=e("./ReasoningEngine"),d=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.sdoAdapter=t,this.reasoner=new c(this),this.context={rdf:"http://www.w3.org/1999/02/22-rdf-syntax-ns#",rdfs:"http://www.w3.org/2000/01/rdf-schema#",xsd:"http://www.w3.org/2001/XMLSchema#",dc:"http://purl.org/dc/terms/",schema:"http://schema.org/",soa:"http://schema-org-adapter.at/vocabTerms/","soa:superClassOf":{"@id":"soa:superClassOf","@type":"@id"},"soa:superPropertyOf":{"@id":"soa:superPropertyOf","@type":"@id"},"soa:hasProperty":{"@id":"soa:hasProperty","@type":"@id"},"soa:isRangeOf":{"@id":"soa:isRangeOf","@type":"@id"},"soa:hasEnumerationMember":{"@id":"soa:hasEnumerationMember","@type":"@id"},"soa:enumerationDomainIncludes":{"@id":"soa:enumerationDomainIncludes","@type":"@id"},"rdfs:subClassOf":{"@id":"rdfs:subClassOf","@type":"@id"},"rdfs:subPropertyOf":{"@id":"rdfs:subPropertyOf","@type":"@id"},"schema:isPartOf":{"@id":"schema:isPartOf","@type":"@id"},"schema:domainIncludes":{"@id":"schema:domainIncludes","@type":"@id"},"schema:rangeIncludes":{"@id":"schema:rangeIncludes","@type":"@id"},"schema:supersededBy":{"@id":"schema:supersededBy","@type":"@id"},"schema:inverseOf":{"@id":"schema:inverseOf","@type":"@id"},"dc:source":{"@id":"dc:source","@type":"@id"}},this.classes={},this.properties={},this.dataTypes={},this.enumerations={},this.enumerationMembers={}}return r(e,[{key:"addVocabulary",value:async function(e){try{this.context=a.generateContext(this.context,e["@context"]),e=await a.preProcessVocab(e,this.context);for(var t=this.sdoAdapter.getVocabularies(),n=0;n<e["@graph"].length;n++)e["@graph"][n]=a.curateNode(e["@graph"][n],t);for(var r=0;r<e["@graph"].length;r++){var o=JSON.parse(JSON.stringify(e["@graph"][r]));if(a.isString(o["@type"]))switch(o["@type"]){case"rdfs:Class":this.addGraphNode(this.classes,o);break;case"rdf:Property":this.addGraphNode(this.properties,o);break;default:this.addGraphNode(this.enumerationMembers,o)}else a.isArray(o["@type"])?-1!==o["@type"].indexOf("rdfs:Class")&&-1!==o["@type"].indexOf("schema:DataType")?this.addGraphNode(this.dataTypes,o):this.addGraphNode(this.enumerationMembers,o):(console.log("unexpected @type format for the following node:"),console.log(JSON.stringify(o,null,2)))}var i=void 0;do{i=!1;for(var s=Object.keys(this.classes),l=Object.keys(this.enumerations),u=0;u<s.length;u++)if(void 0!==this.classes[s[u]]["rdfs:subClassOf"])for(var c=this.classes[s[u]]["rdfs:subClassOf"],d=0;d<c.length;d++)-1===l.indexOf(c[d])&&"schema:Enumeration"!==c[d]||void 0!==this.classes[s[u]]&&void 0===this.enumerations[s[u]]&&(i=!0,this.enumerations[s[u]]=JSON.parse(JSON.stringify(this.classes[s[u]])),delete this.classes[s[u]])}while(i);var p=void 0;do{p=!1;for(var f=Object.keys(this.classes),h=Object.keys(this.dataTypes),y=0;y<f.length;y++)if(void 0!==this.classes[f[y]]["rdfs:subClassOf"])for(var g=this.classes[f[y]]["rdfs:subClassOf"],v=0;v<g.length;v++)-1===h.indexOf(g[v])&&"schema:DataType"!==g[v]||void 0!==this.classes[f[y]]&&void 0===this.dataTypes[f[y]]&&(p=!0,this.dataTypes[f[y]]=JSON.parse(JSON.stringify(this.classes[f[y]])),delete this.classes[f[y]])}while(p);for(var m=Object.keys(this.dataTypes),b=0;b<m.length;b++)this.dataTypes[m[b]]["@type"]="schema:DataType";for(var x=Object.keys(this.classes),w=0;w<x.length;w++){var I=this.classes[x[w]]["rdfs:subClassOf"];void 0===this.classes[x[w]]["soa:superClassOf"]&&(this.classes[x[w]]["soa:superClassOf"]=[]);for(var S=0;S<I.length;S++){var O=this.classes[I[S]];void 0===O&&(O=this.enumerations[I[S]]),void 0!==O&&(void 0!==O["soa:superClassOf"]?-1===O["soa:superClassOf"].indexOf(x[w])&&O["soa:superClassOf"].push(x[w]):O["soa:superClassOf"]=[x[w]])}}for(var C=Object.keys(this.enumerations),k=0;k<C.length;k++){var A=this.enumerations[C[k]]["rdfs:subClassOf"];void 0===this.enumerations[C[k]]["soa:superClassOf"]&&(this.enumerations[C[k]]["soa:superClassOf"]=[]);for(var j=0;j<A.length;j++){var T=this.classes[A[j]];void 0===T&&(T=this.enumerations[A[j]]),void 0!==T&&(void 0!==T["soa:superClassOf"]?-1===T["soa:superClassOf"].indexOf(C[k])&&T["soa:superClassOf"].push(C[k]):T["soa:superClassOf"]=[C[k]])}}for(var N=Object.keys(this.dataTypes),D=0;D<N.length;D++){var L=this.dataTypes[N[D]]["rdfs:subClassOf"];if(void 0===this.dataTypes[N[D]]["soa:superClassOf"]&&(this.dataTypes[N[D]]["soa:superClassOf"]=[]),void 0===L)this.dataTypes[N[D]]["rdfs:subClassOf"]=[];else for(var E=0;E<L.length;E++){var R=this.dataTypes[L[E]];void 0!==R&&(void 0!==R["soa:superClassOf"]?-1===R["soa:superClassOf"].indexOf(N[D])&&R["soa:superClassOf"].push(N[D]):R["soa:superClassOf"]=[N[D]])}}for(var _=Object.keys(this.properties),B=0;B<_.length;B++){var P=this.properties[_[B]]["rdfs:subPropertyOf"];if(void 0===this.properties[_[B]]["soa:superPropertyOf"]&&(this.properties[_[B]]["soa:superPropertyOf"]=[]),void 0===P)this.properties[_[B]]["rdfs:subPropertyOf"]=[];else for(var M=0;M<P.length;M++){var U=this.properties[P[M]];void 0!==U&&(void 0!==U["soa:superPropertyOf"]?-1===U["soa:superPropertyOf"].indexOf(_[B])&&U["soa:superPropertyOf"].push(_[B]):U["soa:superPropertyOf"]=[_[B]])}}x=Object.keys(this.classes);for(var J=0;J<x.length;J++)void 0===this.classes[x[J]]["soa:hasProperty"]&&(this.classes[x[J]]["soa:hasProperty"]=[]),void 0===this.classes[x[J]]["soa:isRangeOf"]&&(this.classes[x[J]]["soa:isRangeOf"]=[]);C=Object.keys(this.enumerations);for(var F=0;F<C.length;F++)void 0===this.enumerations[C[F]]["soa:hasEnumerationMember"]&&(this.enumerations[C[F]]["soa:hasEnumerationMember"]=[]),void 0===this.enumerations[C[F]]["soa:isRangeOf"]&&(this.enumerations[C[F]]["soa:isRangeOf"]=[]),void 0===this.enumerations[C[F]]["soa:hasProperty"]&&(this.enumerations[C[F]]["soa:hasProperty"]=[]);for(var V=Object.keys(this.enumerationMembers),q=0;q<V.length;q++)void 0===this.enumerationMembers[V[q]]["soa:enumerationDomainIncludes"]&&(this.enumerationMembers[V[q]]["soa:enumerationDomainIncludes"]=[]);_=Object.keys(this.properties);for(var z=0;z<_.length;z++){var H=this.properties[_[z]]["schema:domainIncludes"];if(a.isArray(H))for(var G=0;G<H.length;G++){var W=this.classes[H[G]];void 0===W&&(W=this.enumerations[H[G]]),void 0!==W&&a.isArray(W["soa:hasProperty"])&&-1===W["soa:hasProperty"].indexOf(_[z])&&W["soa:hasProperty"].push(_[z])}var Q=this.properties[_[z]]["schema:rangeIncludes"];if(a.isArray(Q))for(var X=0;X<Q.length;X++){var K=this.classes[Q[X]];void 0===K&&(K=this.enumerations[Q[X]]),void 0!==K&&a.isArray(K["soa:isRangeOf"])&&-1===K["soa:isRangeOf"].indexOf(_[z])&&K["soa:isRangeOf"].push(_[z])}}V=Object.keys(this.enumerationMembers);for(var Y=0;Y<V.length;Y++){var Z=this.enumerationMembers[V[Y]],$=Z["@type"];a.isArray($)||($=[$]);for(var ee=0;ee<$.length;ee++){var te=this.enumerations[$[ee]];void 0!==te&&a.isArray(te["soa:hasEnumerationMember"])&&-1===te["soa:hasEnumerationMember"].indexOf(V[Y])&&(te["soa:hasEnumerationMember"].push(V[Y]),a.isArray(Z["soa:enumerationDomainIncludes"])?Z["soa:enumerationDomainIncludes"].push($[ee]):Z["soa:enumerationDomainIncludes"]=[$[ee]])}}return!0}catch(k){return console.log(k),!1}}},{key:"addGraphNode",value:function(e,t){try{if(void 0===e[t["@id"]])e[t["@id"]]=t;else{var n=e[t["@id"]];if(void 0!==t["schema:isPartOf"]&&null!==t["schema:isPartOf"]&&(n["schema:isPartOf"]=t["schema:isPartOf"]),void 0!==t["dc:source"]&&null!==t["dc:source"]&&(n["dc:source"]=t["dc:source"]),void 0!==t["schema:category"]&&null!==t["schema:category"]&&(n["schema:category"]=t["schema:category"]),void 0!==t["schema:supersededBy"]&&null!==t["schema:supersededBy"]&&(n["schema:supersededBy"]=t["schema:supersededBy"]),void 0!==t["rdfs:label"]&&null!==t["rdfs:label"])for(var r=Object.keys(t["rdfs:label"]),a=0;a<r.length;a++)n["rdfs:label"][r[a]]=t["rdfs:label"][r[a]];if(void 0!==t["rdfs:comment"]&&null!==t["rdfs:comment"])for(var o=Object.keys(t["rdfs:comment"]),i=0;i<o.length;i++)n["rdfs:comment"][o[i]]=t["rdfs:comment"][o[i]];if(void 0!==t["rdfs:subClassOf"]&&null!==t["rdfs:subClassOf"])for(var s=0;s<t["rdfs:subClassOf"].length;s++)-1===n["rdfs:subClassOf"].indexOf(t["rdfs:subClassOf"][s])&&n["rdfs:subClassOf"].push(t["rdfs:subClassOf"][s]);if(void 0!==t["soa:superClassOf"]&&null!==t["soa:superClassOf"])for(var l=0;l<t["soa:superClassOf"].length;l++)-1===n["soa:superClassOf"].indexOf(t["soa:superClassOf"][l])&&n["soa:superClassOf"].push(t["soa:superClassOf"][l]);if(void 0!==t["soa:hasProperty"]&&null!==t["soa:hasProperty"])for(var u=0;u<t["soa:hasProperty"].length;u++)-1===n["soa:hasProperty"].indexOf(t["soa:hasProperty"][u])&&n["soa:hasProperty"].push(t["soa:hasProperty"][u]);if(void 0!==t["soa:isRangeOf"]&&null!==t["soa:isRangeOf"])for(var c=0;c<t["soa:isRangeOf"].length;c++)-1===n["soa:isRangeOf"].indexOf(t["soa:isRangeOf"][c])&&n["soa:isRangeOf"].push(t["soa:isRangeOf"][c]);if(void 0!==t["soa:enumerationDomainIncludes"]&&null!==t["soa:enumerationDomainIncludes"])for(var d=0;d<t["soa:enumerationDomainIncludes"].length;d++)-1===n["soa:enumerationDomainIncludes"].indexOf(t["soa:enumerationDomainIncludes"][d])&&n["soa:enumerationDomainIncludes"].push(t["soa:enumerationDomainIncludes"][d]);if(void 0!==t["soa:hasEnumerationMember"]&&null!==t["soa:hasEnumerationMember"])for(var p=0;p<t["soa:hasEnumerationMember"].length;p++)-1===n["soa:hasEnumerationMember"].indexOf(t["soa:hasEnumerationMember"][p])&&n["soa:hasEnumerationMember"].push(t["soa:hasEnumerationMember"][p]);if(void 0!==t["rdfs:subPropertyOf"]&&null!==t["rdfs:subPropertyOf"])for(var f=0;f<t["rdfs:subPropertyOf"].length;f++)-1===n["rdfs:subPropertyOf"].indexOf(t["rdfs:subPropertyOf"][f])&&n["rdfs:subPropertyOf"].push(t["rdfs:subPropertyOf"][f]);if(void 0!==t["schema:domainIncludes"]&&null!==t["schema:domainIncludes"])for(var h=0;h<t["schema:domainIncludes"].length;h++)-1===n["schema:domainIncludes"].indexOf(t["schema:domainIncludes"][h])&&n["schema:domainIncludes"].push(t["schema:domainIncludes"][h]);if(void 0!==t["schema:rangeIncludes"]&&null!==t["schema:rangeIncludes"])for(var y=0;y<t["schema:rangeIncludes"].length;y++)-1===n["schema:rangeIncludes"].indexOf(t["schema:rangeIncludes"][y])&&n["schema:rangeIncludes"].push(t["schema:rangeIncludes"][y]);if(void 0!==t["schema:superPropertyOf"]&&null!==t["schema:superPropertyOf"])for(var g=0;g<t["schema:superPropertyOf"].length;g++)-1===n["schema:superPropertyOf"].indexOf(t["schema:superPropertyOf"][g])&&n["schema:superPropertyOf"].push(t["schema:superPropertyOf"][g])}return!0}catch(n){return console.log(n),console.log("memory[newNode[@id]]:"),console.log(JSON.stringify(e[t["@id"]],null,2)),console.log("newNode:"),console.log(JSON.stringify(t,null,2)),!1}}},{key:"getTerm",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this.discoverCompactIRI(e),r=void 0,c=void 0,d=0;do{switch(d){case 0:r=this.classes[n],c="Class";break;case 1:r=this.properties[n],c="Property";break;case 2:r=this.dataTypes[n],c="DataType";break;case 3:r=this.enumerations[n],c="Enumeration";break;case 4:r=this.enumerationMembers[n],c="EnumerationMember"}d++}while(void 0===r&&d<6);if(void 0===r)throw new Error("There is no term with the IRI "+e);if(0===(r=a.applyFilter([r["@id"]],t,this)).length)throw new Error("There is no term with that IRI and filter settings.");switch(c){case"Class":return new o(n,this);case"Property":return new i(n,this);case"Enumeration":return new s(n,this);case"EnumerationMember":return new l(n,this);case"DataType":return new u(n,this)}}},{key:"getClass",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this.discoverCompactIRI(e);if(null!==n){var r=this.classes[n];if(void 0!==r){if(0===(r=a.applyFilter([n],t,this)).length)throw new Error("There is no class with that IRI and filter settings.");return new o(n,this)}if(void 0!==(r=this.enumerations[n]))try{return this.getEnumeration(n)}catch(e){}}throw new Error("There is no class with the IRI "+e)}},{key:"getProperty",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this.discoverCompactIRI(e);if(null!==n){var r=this.properties[n];if(void 0!==r){if(0===(r=a.applyFilter([n],t,this)).length)throw new Error("There is no property with that URI and filter settings.");return new i(n,this)}}throw new Error("There is no property with that URI.")}},{key:"getDataType",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this.discoverCompactIRI(e);if(null!==n){var r=this.dataTypes[n];if(void 0!==r){if(0===(r=a.applyFilter([n],t,this)).length)throw new Error("There is no data-type with that IRI and filter settings.");return new u(n,this)}}throw new Error("There is no data-type with the IRI "+e)}},{key:"getEnumeration",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this.discoverCompactIRI(e);if(null!==n){var r=this.enumerations[n];if(void 0!==r){if(0===(r=a.applyFilter([n],t,this)).length)throw new Error("There is no enumeration with that IRI and filter settings.");return new s(n,this)}}throw new Error("There is no enumeration with the IRI "+e)}},{key:"getEnumerationMember",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this.discoverCompactIRI(e);if(null!==n){var r=this.enumerationMembers[n];if(void 0!==r){if(0===(r=a.applyFilter([n],t,this)).length)throw new Error("There is no EnumerationMember with that IRI and filter settings.");return new l(n,this)}}throw new Error("There is no EnumerationMember with the IRI "+e)}},{key:"discoverCompactIRI",value:function(e){if(-1!==e.indexOf(":"))for(var t=Object.keys(this.context),n=0;n<t.length;n++){var r=this.context[t[n]];if(a.isString(r)){if(e.startsWith(t[n]))return e;if(e.startsWith(r))return a.toCompactIRI(e,this.context)}}else{for(var o=Object.keys(this.classes),i=0;i<o.length;i++)if(!0===this.containsLabel(this.classes[o[i]],e))return o[i];for(var s=Object.keys(this.properties),l=0;l<s.length;l++)if(!0===this.containsLabel(this.properties[s[l]],e))return s[l];for(var u=Object.keys(this.dataTypes),c=0;c<u.length;c++)if(!0===this.containsLabel(this.dataTypes[u[c]],e))return u[c];for(var d=Object.keys(this.enumerations),p=0;p<d.length;p++)if(!0===this.containsLabel(this.enumerations[d[p]],e))return d[p];for(var f=Object.keys(this.enumerationMembers),h=0;h<f.length;h++)if(!0===this.containsLabel(this.enumerationMembers[f[h]],e))return f[h]}return null}},{key:"containsLabel",value:function(e,t){if(void 0!==e&&a.isObject(e["rdfs:label"]))for(var n=Object.keys(e["rdfs:label"]),r=0;r<n.length;r++)if(e["rdfs:label"][n[r]]===t)return!0;return!1}}]),e}();t.exports=d},{"./Class":44,"./DataType":45,"./Enumeration":46,"./EnumerationMember":47,"./Property":49,"./ReasoningEngine":50,"./utilities":52}],49:[function(e,t,n){"use strict";var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function a(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var o=e("./utilities"),i=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.IRI=t,this.graph=n}return r(e,[{key:"getIRI",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return e?this.IRI:o.toAbsoluteIRI(this.IRI,this.graph.context)}},{key:"getTermType",value:function(){return"rdf:Property"}},{key:"getVocabulary",value:function(){var e=this.graph.properties[this.IRI];return void 0!==e["schema:isPartOf"]?e["schema:isPartOf"]:null}},{key:"getSource",value:function(){var e=this.graph.properties[this.IRI];return void 0!==e["dc:source"]?e["dc:source"]:null}},{key:"isSupersededBy",value:function(){var e=this.graph.properties[this.IRI];return o.isString(e["schema:supersededBy"])?e["schema:supersededBy"]:null}},{key:"getName",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"en",t=this.graph.properties[this.IRI]["rdfs:label"];return null===t||void 0===t[e]?null:t[e]}},{key:"getDescription",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"en",t=this.graph.properties[this.IRI]["rdfs:comment"];return null===t||void 0===t[e]?null:t[e]}},{key:"getRanges",value:function(){var e,t,n=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=this.graph.properties[this.IRI],s=[];return(e=s).push.apply(e,a(i["schema:rangeIncludes"])),!0===n&&((t=s).push.apply(t,a(this.graph.reasoner.inferImplicitSubClasses(s))),s=s.filter(function(e){return null!==e})),o.applyFilter(o.uniquifyArray(s),r,this.graph)}},{key:"getDomains",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this.graph.properties[this.IRI],r=[];return r.push.apply(r,a(n["schema:domainIncludes"])),!0===e&&r.push.apply(r,a(this.graph.reasoner.inferImplicitSubClasses(r))),o.applyFilter(o.uniquifyArray(r),t,this.graph)}},{key:"getSuperProperties",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this.graph.properties[this.IRI],r=[];return!0===e?r.push.apply(r,a(this.graph.reasoner.inferSuperProperties(this.IRI))):r.push.apply(r,a(n["rdfs:subPropertyOf"])),o.applyFilter(o.uniquifyArray(r),t,this.graph)}},{key:"getSubProperties",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this.graph.properties[this.IRI],r=[];return!0===e?r.push.apply(r,a(this.graph.reasoner.inferSubProperties(this.IRI))):r.push.apply(r,a(n["soa:superPropertyOf"])),o.applyFilter(o.uniquifyArray(r),t,this.graph)}},{key:"toString",value:function(){return JSON.stringify(this.toJSON(!1,null),null,2)}},{key:"toJSON",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n={};return n.id=this.getIRI(!0),n.IRI=this.getIRI(),n.type=this.getTermType(),n.vocabulary=this.getVocabulary(),n.source=this.getSource(),n.supersededBy=this.isSupersededBy(),n.name=this.getName(),n.description=this.getDescription(),n.ranges=this.getRanges(e,t),n.domains=this.getDomains(e,t),n.superProperties=this.getSuperProperties(e,t),n.subProperties=this.getSubProperties(e,t),n}}]),e}();t.exports=i},{"./utilities":52}],50:[function(e,t,n){"use strict";var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function a(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var o=e("./utilities"),i=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.graph=t}return r(e,[{key:"inferPropertiesFromSuperClasses",value:function(e){for(var t=[],n=0;n<e.length;n++){var r=this.graph.classes[e[n]];void 0===r&&(r=this.graph.enumerations[e[n]]),void 0!==r&&(t.push.apply(t,a(r["soa:hasProperty"])),0!==r["rdfs:subClassOf"].length&&t.push.apply(t,a(this.inferPropertiesFromSuperClasses(r["rdfs:subClassOf"]))))}return o.uniquifyArray(t)}},{key:"inferImplicitSuperClasses",value:function(e){var t=this.graph.classes[e],n=[];if(void 0===t&&(t=this.graph.enumerations[e]),void 0!==t){var r;(r=n).push.apply(r,a(t["rdfs:subClassOf"]));var i=o.copByVal(n);do{for(var s,l=[],u=0;u<i.length;u++){var c,d=this.graph.classes[i[u]];void 0===d&&(d=this.graph.enumerations[i[u]]),void 0!==d&&(c=l).push.apply(c,a(d["rdfs:subClassOf"]))}l=o.uniquifyArray(l),i=o.copByVal(l),(s=n).push.apply(s,a(l))}while(0!==i.length);n=o.uniquifyArray(n)}return n}},{key:"inferImplicitSubClasses",value:function(e){var t=this.graph.classes[e],n=[];if(void 0===t&&(t=this.graph.enumerations[e]),void 0!==t){var r;(r=n).push.apply(r,a(t["soa:superClassOf"]));var i=o.copByVal(n);do{for(var s,l=[],u=0;u<i.length;u++){var c,d=this.graph.classes[i[u]];void 0===d&&(d=this.graph.enumerations[i[u]]),void 0!==d&&(c=l).push.apply(c,a(d["soa:superClassOf"]))}l=o.uniquifyArray(l),i=o.copByVal(l),(s=n).push.apply(s,a(l))}while(0!==i.length);return n=o.uniquifyArray(n)}return n}},{key:"inferImplicitSuperDataTypes",value:function(e){var t=this.graph.dataTypes[e],n=[];if(void 0!==t){var r;(r=n).push.apply(r,a(t["rdfs:subClassOf"]));var i=o.copByVal(n);do{for(var s,l=[],u=0;u<i.length;u++){var c,d=this.graph.dataTypes[i[u]];void 0!==d&&(c=l).push.apply(c,a(d["rdfs:subClassOf"]))}l=o.uniquifyArray(l),i=o.copByVal(l),(s=n).push.apply(s,a(l))}while(0!==i.length);n=o.uniquifyArray(n)}return n}},{key:"inferImplicitSubDataTypes",value:function(e){var t=this.graph.dataTypes[e],n=[];if(void 0!==t){var r;(r=n).push.apply(r,a(t["soa:superClassOf"]));var i=o.copByVal(n);do{for(var s,l=[],u=0;u<i.length;u++){var c,d=this.graph.dataTypes[i[u]];void 0!==d&&(c=l).push.apply(c,a(d["soa:superClassOf"]))}l=o.uniquifyArray(l),i=o.copByVal(l),(s=n).push.apply(s,a(l))}while(0!==i.length);n=o.uniquifyArray(n)}return n}},{key:"inferSubProperties",value:function(e){var t=this.graph.properties[e],n=[];if(void 0!==t){var r;(r=n).push.apply(r,a(t["soa:superPropertyOf"]));var i=o.copByVal(n);do{for(var s,l=[],u=0;u<i.length;u++){var c,d=this.graph.properties[i[u]];void 0!==d&&(c=l).push.apply(c,a(d["soa:superPropertyOf"]))}l=o.uniquifyArray(l),i=o.copByVal(l),(s=n).push.apply(s,a(l))}while(0!==i.length);n=o.uniquifyArray(n)}return n}},{key:"inferSuperProperties",value:function(e){var t=this.graph.properties[e],n=[];if(void 0!==t){var r;(r=n).push.apply(r,a(t["rdfs:subPropertyOf"]));var i=o.copByVal(n);do{for(var s,l=[],u=0;u<i.length;u++){var c,d=this.graph.properties[i[u]];void 0!==d&&(c=l).push.apply(c,a(d["rdfs:subPropertyOf"]))}l=o.uniquifyArray(l),i=o.copByVal(l),(s=n).push.apply(s,a(l))}while(0!==i.length);n=o.uniquifyArray(n)}return n}}]),e}();t.exports=i},{"./utilities":52}],51:[function(e,t,n){"use strict";var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=e("./Graph"),o=e("./utilities"),i=e("node-fetch"),s=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.graph=new a(this)}return r(e,[{key:"addVocabularies",value:async function(e,t){if(!o.isArray(e))throw new Error("The first argument of the function must be an Array of vocabularies (JSON-LD)");for(var n=0;n<e.length;n++)if(o.isString(e[n]))if(e[n].startsWith("www")||e[n].startsWith("http")){var r=await this.fetchVocabularyFromURL(e[n]);try{await this.graph.addVocabulary(r)}catch(t){console.log("The given URL "+e[n]+" did not contain a valid JSON-LD vocabulary.")}}else try{await this.graph.addVocabulary(JSON.parse(e[n]))}catch(e){console.log("Parsing of vocabulary string produced an invalid JSON-LD.")}else{if(!o.isObject(e[n]))throw new Error("The first argument of the function must be an Array of vocabularies (JSON-LD as Object/String)");await this.graph.addVocabulary(e[n])}null!==t&&t()}},{key:"fetchVocabularyFromURL",value:async function(e){var t=await i(e,{method:"GET",headers:{"Content-Type":"application/x-www-form-urlencoded"}});return await t.json()}},{key:"getClass",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this.graph.getClass(e,t)}},{key:"getAllClasses",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=this.getListOfClasses(e),n=[],r=0;r<t.length;r++)try{n.push(this.getClass(t[r]))}catch(e){}return n}},{key:"getListOfClasses",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return o.applyFilter(Object.keys(this.graph.classes),e,this.graph)}},{key:"getProperty",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this.graph.getProperty(e,t)}},{key:"getAllProperties",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=this.getListOfProperties(e),n=[],r=0;r<t.length;r++)try{n.push(this.getProperty(t[r]))}catch(e){}return n}},{key:"getListOfProperties",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return o.applyFilter(Object.keys(this.graph.properties),e,this.graph)}},{key:"getDataType",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this.graph.getDataType(e,t)}},{key:"getAllDataTypes",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=this.getListOfDataTypes(e),n=[],r=0;r<t.length;r++)try{n.push(this.getDataType(t[r]))}catch(e){}return n}},{key:"getListOfDataTypes",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return o.applyFilter(Object.keys(this.graph.dataTypes),e,this.graph)}},{key:"getEnumeration",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this.graph.getEnumeration(e,t)}},{key:"getAllEnumerations",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=this.getListOfEnumerations(e),n=[],r=0;r<t.length;r++)try{n.push(this.getEnumeration(t[r]))}catch(e){}return n}},{key:"getListOfEnumerations",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return o.applyFilter(Object.keys(this.graph.enumerations),e,this.graph)}},{key:"getEnumerationMember",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this.graph.getEnumerationMember(e,t)}},{key:"getAllEnumerationMembers",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=this.getListOfEnumerationMembers(e),n=[],r=0;r<t.length;r++)try{n.push(this.getEnumerationMember(t[r]))}catch(e){}return n}},{key:"getListOfEnumerationMembers",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return o.applyFilter(Object.keys(this.graph.enumerationMembers),e,this.graph)}},{key:"getVocabularies",value:function(){for(var e=Object.keys(this.graph.context),t={},n=["soa","xsd","rdf","rdfa","rdfs","dc"],r=0;r<e.length;r++)o.isString(this.graph.context[e[r]])&&-1===n.indexOf(e[r])&&(t[e[r]]=this.graph.context[e[r]]);return t}}]),e}();t.exports=s},{"./Graph":48,"./utilities":52,"node-fetch":24}],52:[function(e,t,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function a(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var o=e("jsonld");function i(e){if(void 0!==e)return JSON.parse(JSON.stringify(e))}function s(e){return!Array.isArray(e)&&null!=e&&"object"===(void 0===e?"undefined":r(e))}function l(e){return null!=e&&("string"==typeof e||e instanceof String)}function u(e){return Array.isArray(e)}t.exports={applyFilter:function(e,t,n){if(!Array.isArray(e)||0===e.length||null===t||0===Object.keys(t).length)return e;for(var r=[],a=0;a<e.length;a++){var o=n.getTerm(e[a]);if(void 0!==t.isSuperseded){if(!1===t.isSuperseded&&null!==o.isSupersededBy())continue;if(!0===t.isSuperseded&&null===o.isSupersededBy())continue}if(void 0!==t.fromVocabulary){var i=!1;if(l(t.fromVocabulary))o.getIRI(!0).startsWith(t.fromVocabulary)&&(i=!0);else if(u(t.fromVocabulary))for(var s=0;s<t.fromVocabulary.length;s++)o.getIRI(!0).startsWith(t.fromVocabulary[s])&&(i=!0);if(!i)continue}if(void 0!==t.termType){var c=!1,d=[];l(t.termType)?d.push(t.termType):u(t.termType)&&(d=t.termType);for(var p=0;p<d.length;p++){var f=void 0;switch(d[p]){case"Class":f="rdfs:Class";break;case"Property":f="rdf:Property";break;case"Enumeration":f="schema:Enumeration";break;case"EnumerationMember":f="soa:EnumerationMember";break;case"DataType":f="schema:DataType";break;default:console.log("Invalid filter.termType "+d[p])}if(f===o.getTermType()){c=!0;break}}if(!c)continue}r.push(e[a])}return r},copByVal:i,isArray:u,isString:l,isObject:s,uniquifyArray:function(e){for(var t={},n=[],r=0;r<e.length;r++){var a=e[r];1!==t[a]&&(t[a]=1,n.push(a))}return n},preProcessVocab:async function(e,t){var n=!1;do{var r=[];n=!1;for(var s=0;s<e["@graph"].length;s++)void 0!==e["@graph"][s]["@graph"]?(r.push.apply(r,a(i(e["@graph"][s]["@graph"]))),n=!0):r.push(i(e["@graph"][s]));e["@graph"]=i(r)}while(!0===n);return await o.compact(await o.expand(e),t)},generateContext:function(e,t){for(var n=Object.keys(e),r=Object.keys(t),a=JSON.parse(JSON.stringify(e)),o=0;o<r.length;o++){var i=r[o];if(l(t[i])){for(var u=!1,c=0;c<n.length;c++)if(l(a[n[c]])&&a[n[c]]===t[i]){u=!0;break}if(u)continue;if(void 0===a[i])a[i]=t[i];else if(a[i]!==t[i])for(var d=!1,p=1;!1===d;){var f=i+p++;void 0===a[f]&&(d=!0,a[f]=t[i])}}}var h={};Object.keys(a).sort().forEach(function(e){h[e]=a[e]}),a=h;for(var y=Object.keys(a),g={},v=0;v<y.length;v++)l(a[y[v]])&&(g[y[v]]=a[y[v]]);for(var m=0;m<y.length;m++)s(a[y[m]])&&(g[y[m]]=a[y[m]]);return g},curateNode:function(e,t){if(void 0!==e["rdfs:comment"]){if(l(e["rdfs:comment"]))e["rdfs:comment"]={en:e["rdfs:comment"]};else if(s(e["rdfs:comment"])){var n={};n[e["rdfs:comment"]["@language"]]=e["rdfs:comment"]["@value"],e["rdfs:comment"]=i(n)}else if(u(e["rdfs:comment"])){for(var r={},a=0;a<e["rdfs:comment"].length;a++)s(e["rdfs:comment"][a])&&(r[e["rdfs:comment"][a]["@language"]]=e["rdfs:comment"][a]["@value"]);e["rdfs:comment"]=i(r)}}else e["rdfs:comment"]={};if(void 0!==e["rdfs:label"]){if(l(e["rdfs:label"]))e["rdfs:label"]={en:e["rdfs:label"]};else if(s(e["rdfs:label"])){var o={};o[e["rdfs:label"]["@language"]]=e["rdfs:label"]["@value"],e["rdfs:label"]=i(o)}else if(u(e["rdfs:label"])){for(var c={},d=0;d<e["rdfs:label"].length;d++)s(e["rdfs:label"][d])&&(c[e["rdfs:label"][d]["@language"]]=e["rdfs:label"][d]["@value"]);e["rdfs:label"]=i(c)}}else e["rdfs:label"]={};if(l(e["rdfs:subClassOf"])?e["rdfs:subClassOf"]=[e["rdfs:subClassOf"]]:void 0===e["rdfs:subClassOf"]&&"rdfs:Class"===e["@type"]&&(e["rdfs:subClassOf"]=[]),l(e["rdfs:subPropertyOf"])?e["rdfs:subPropertyOf"]=[e["rdfs:subPropertyOf"]]:void 0===e["rdfs:subPropertyOf"]&&"rdf:Property"===e["@type"]&&(e["rdfs:subPropertyOf"]=[]),l(e["schema:domainIncludes"])?e["schema:domainIncludes"]=[e["schema:domainIncludes"]]:void 0===e["schema:domainIncludes"]&&"rdf:Property"===e["@type"]&&(e["schema:domainIncludes"]=[]),l(e["schema:rangeIncludes"])?e["schema:rangeIncludes"]=[e["schema:rangeIncludes"]]:void 0===e["schema:rangeIncludes"]&&"rdf:Property"===e["@type"]&&(e["schema:rangeIncludes"]=[]),!l(e["schema:isPartOf"])){for(var p=Object.keys(t),f=void 0,h=0;h<p.length;h++)if(e["@id"].substring(0,e["@id"].indexOf(":"))===p[h]){f=t[p[h]];break}if(void 0!==f){var y=void 0;do{y=!1,(f.endsWith("/")||f.endsWith("#"))&&(f=f.substring(0,f.length-1),y=!0)}while(!0===y);e["schema:isPartOf"]=f}}return e},toCompactIRI:function(e,t){for(var n=Object.keys(t),r=0;r<n.length;r++){var a=t[n[r]];if(l(a)&&e.startsWith(a))return n[r]+":"+e.substring(a.length)}return null},toAbsoluteIRI:function(e,t){for(var n=Object.keys(t),r=0;r<n.length;r++){var a=t[n[r]];if(e.substring(0,e.indexOf(":"))===n[r])return a.concat(e.substring(e.indexOf(":")+1))}return null}}},{jsonld:18}]},{},[51])(51)}).call(this,n(4),n(0))},function(e,t){e.exports=moment},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),o=(n(3),n(1),"https://semantify.it"),i="https://smtfy.it/";function s(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,a=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(r=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==s.return||s.return()}finally{if(a)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function l(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e){return e.split(":")[1]}function d(e){p(e,5e3)}function p(e,t){var n={content:'<table class="snackbar-table"><td><i class="material-icons snackbar-icon">info</i><span>  '+e+"</span></td></table>",style:"toast",timeout:t||4e3,htmlAllowed:!0,onClose:function(){}};a.a.snackbar(n)}function f(e,t){for(var n=e.indexOf(t);-1!==n;)e.splice(n,1),n=e.indexOf(t)}function h(e,t){y(e,null,t)}function y(e,t,n){a.a.ajax({type:"GET",url:e,headers:t,success:function(e){n(e)},error:function(){n()}})}function g(e,t,n,r){v("POST",e,"application/json ; charset=utf-8",t,n,r)}function v(e,t,n,r,o,i){a.a.ajax({type:e,contentType:n,headers:r,url:t,data:JSON.stringify(o),success:function(e){i(e)},error:function(e){i(e)}})}function m(e){return"object"===u(e)&&(e=JSON.stringify(e,null,2)),(e=e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")).replace(/("(\\u[a-zA-Z0-9]{4}|\\[^u]|[^\\"])*"(\s*:)?|\b(true|false|null)\b|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?)/g,function(e){var t="number";return/^"/.test(e)?t=/:$/.test(e)?"key":"string":/true|false/.test(e)?t="boolean":/null/.test(e)&&(t="null"),'<span class="'+t+'">'+e+"</span>"})}function b(e){var t=document.createElement("textarea");document.body.appendChild(t),t.setAttribute("id","dummy_id"),t.value=e,t.select(),document.execCommand("copy"),document.body.removeChild(t),p("Annotation copied into your clipboard",3e3)}function x(e){return"function appendAnnotation() {\n\tvar element = document.createElement('script');\n\telement.type = 'application/ld+json';\n\telement.text = this.responseText;\n\tdocument.querySelector('head').appendChild(element);\n}\nvar request = new XMLHttpRequest();\nrequest.onload = appendAnnotation;\nrequest.open(\"get\", \""+i+e+'", true);\nrequest.send();'}var w,I=function(e){var t={};return function n(){for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];var i=a.pop(),s=JSON.stringify(a);t[s]&&t[s].ready?i(t[s].data):t[s]&&!t[s].ready?setTimeout(function(){return n.apply(void 0,a.concat([i]))},50):(t[s]={ready:!1,data:null},e.apply(void 0,a.concat([function(e){t[s].ready=!0,t[s].data=e,i(e)}])))}};function S(e,t,n){try{return"".concat(n,":\n").concat((r=e.getProperty(t).getDescription(),(a=document.createElement("DIV")).innerHTML=r,a.textContent||a.innerText||""))}catch(e){return n}var r,a}function O(e,t){try{return e.getClass(t).getSubClasses().map(function(e){return c(e)})}catch(e){return[t]}}var C={name:"Save",icon:"save",createJsonLD:!0,onclick:function(e){var t=[],n={};if(n.content=e.jsonLd,n.dsHash=e.dsHash,t.push(n),null!=e.jsonLd){var r,i,s,l=e.options.smtfySemantifyWebsiteUID,u=e.options.smtfySemantifyWebsiteSecret,c=a()("#panel-"+e.panelId).data("smtfyAnnId"),f=(a()("#panel-"+e.panelId).data("smtfyWebId"),a()("#panel-"+e.panelId).data("smtfyWebSecret"));if(c)r=o+"/api/annotation/uid/"+c,i={"website-secret":f},s={content:e.jsonLd},v("PATCH",r,"application/json ; charset=utf-8",i,s,function(e){e&&"Not Found"!==e.statusText&&"Forbidden"!==e.statusText?window.is_typo3?a.a.ajax({type:"post",url:window.myAjax.ajaxurl,data:{action:"iasemantify_refresh_cache"},success:function(e){p("Successfully updated Annotation")},error:function(e){d("An error occurred while saving to typo3")}}):p("Successfully updated Annotation"):d("An error occurred. Please check your semantify api-key!")});else g(o+"/api/annotation/"+l,{"website-secret":u},t,function(t){if(t&&!t.message){p("Successfully saved Annotation to semantify.it");var n=t[0].UID;a()("#panel-"+e.panelId).data("smtfyAnnId",n).data("smtfyWebId",l).data("smtfyWebSecret",u);var r=a()("#ia-data").attr("data-post_id"),o=a()("#ia-data").attr("data-nonce");a.a.ajax({type:"post",url:window.myAjax.ajaxurl,data:{action:"iasemantify_push_ann",post_id:r,nonce:o,ann_id:n,ds_hash:e.dsHash,web_id:l,web_secret:u},success:function(e){},error:function(e){d("An error occurred while saving to "+(window.is_typo3?"typo3":"wordpress"))}})}else d("An error occurred. Please check your semantify api-key! ("+t.message+")")})}}},k={name:"Delete",icon:"close",createJsonLD:!1,onclick:function(e){var t=a()("#panel-"+e.panelId).data("smtfyAnnId"),n=a()("#panel-"+e.panelId).data("smtfyWebId"),r=a()("#panel-"+e.panelId).data("smtfyWebSecret");if(f(window.IA_currently_added_annotations,t),window.IA_delete_id_whitelist.push(t),!t||confirm("Do you really want to delete this annotation?")){a()("#panel-"+e.panelId).hide(500);var o=a()("#ia-data").attr("data-post_id"),i=a()("#ia-data").attr("data-nonce");a.a.ajax({type:"post",url:window.myAjax.ajaxurl,data:{action:"iasemantify_delete_ann",post_id:o,nonce:i,ann_id:e.annId,ds_hash:e.dsHash||"NO_DS",web_id:n,web_secret:r},success:function(e){},error:function(e){d("An error occurred while deleting from wordpress")}})}}},A={name:"Copy",icon:"content_copy",createJsonLD:!0,onclick:function(e){e.jsonLd&&b(JSON.stringify(e.jsonLd,null,2))}},j={name:"Close",icon:"close",createJsonLD:!1,onclick:function(e){a()("#panel-"+e.panelId.toString()).hide()}},T={name:"Clear",icon:"delete",onclick:function(e){e.inputFields.forEach(function(t){var n=t.slice(t.indexOf("_")+1,t.indexOf("_",t.indexOf("_")+1));e.panelId.toString()===n&&a()("#"+t).val("")})}},N={name:"Save",icon:"save",onlyIcon:!1,createJsonLD:!0,onclick:function(e){if(e.jsonLd){var t=[],n={};n.content=e.jsonLd,n.dsHash=e.dsHash,t.push(n);var r={htmlAllowed:!0,style:"toast",timeout:3e3},s={"website-secret":e.options.smtfySemantifyWebsiteSecret};g(o+"/api/annotation/"+e.options.smtfySemantifyWebsiteUID,s,t,function(n){if(console.log(n),n&&n[0]&&n[0].UID){r.content="Successfully saved Annotation to semantify.it",a.a.snackbar(r);var s=i+n[0].UID,l=document.createElement("div");document.body.appendChild(l),l.setAttribute("id","IA_preview_id"),a()("#IA_preview_id").append('<div class="bootstrap semantify semantify-instant-annotations"><div class="modal fade" id="IA_saveModal" role="dialog"><div class="modal-dialog"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal">&times;</button><h3 class="modal-title">Successfully saved JSON-LD annotation!</h3></div><div class="modal-body"><pre id="IA_preview_textArea" style="max-height: 300px;"></pre><button class="btn btn-default" id="IA_preview_copy" style="float: right; position:relative;bottom:55px; right:5px "> <i class="material-icons">content_copy</i> Copy</button><br/>Saved annotation "<b>'+n[0].name+'" </b><div id="IA_toWebsite" style="display: inline"></div> at: <a target="_blank" id="IA_annUrl" href="'+s+'">'+s+'</a> <br/><br/><button class="btn btn-default" style="margin:0; padding: 2px; text-transform:none; font-weight:normal" id="IA_JS_inject"><span class="caret"/>  How do i get this annotation into my website?</button><br/><br/><br/><div id="IA_loginSection"></div><div class="modal-footer"><button type="button" class="btn btn-default" data-dismiss="modal">Close</button></div></div></div></div></div>'),a()("#IA_preview_copy").click(function(){b(JSON.stringify(e.jsonLd,null,2))}),a()("#IA_JS_inject").after('<div id="IA_JS_inject_area" style="display:none;"><br/> Add this Javascript code to your Website: <pre id="IA_JS_inject_code"></pre><button class="btn btn-default" id="IA_inject_copy" style="float: right; position:relative;bottom:55px; right:5px "> <i class="material-icons">content_copy</i> Copy</button></div>');var u=x(n[0].UID);a()("#IA_inject_copy").click(function(){b(u)}),a()("#IA_JS_inject_code").html(u),a()("#IA_JS_inject").click(function(){a()("#IA_JS_inject_area").html()&&("none"===a()("#IA_JS_inject_area").css("display")?a()("#IA_JS_inject_area").slideDown(200):a()("#IA_JS_inject_area").slideUp(200))}),a()("#IA_preview_textArea").html(m(JSON.stringify(e.jsonLd,null,2)));var c=function(){y(o+"/api/website",{Authorization:"Bearer "+w},function(e){e?(a()("#IA_loginSection").after('<div class="list-group" id="IA_my_websites"><h4>Your websites: (Select one to save your annotation to) </h4> </div>'),e.forEach(function(e){a()("#IA_my_websites").append('<button type="button" class="list-group-item list-group-item-action" id="IA_'+e.uid+'" style="padding: 5px 0">'+e.name+" ("+e.domain+")</button>"),a()("#IA_"+e.uid).click(function(){a()("#IA_my_websites").slideUp(100),console.log("ele",e);var n={"website-secret":e.secret};g(o+"/api/annotation/"+e.uid,n,t,function(t){if(console.log(t),t&&t[0]&&t[0].UID){console.log("saved",t),r.content="Saved the annotation to: "+e.name+" ("+e.domain+")",a.a.snackbar(r),a()("#IA_toWebsite").append("to website <b>"+e.name+(e.domain?" ("+e.domain+")":"")+"</b>");var n=i+t[0].UID;a()("#IA_annUrl").html(n).attr("href",n);var o=x(t[0].UID);a()("#IA_inject_copy").click(function(){b(o)}),a()("#IA_JS_inject_code").html(o)}else r.content="Failed to save the annotation to: "+e.name+" ("+e.domain+")",a.a.snackbar(r)})})})):(r.content="There has been an error when retrieving your websites",a.a.snackbar(r))})};w?c():a()("#IA_loginSection").append('<p>Want to save this Annotation to your Semantify.it account?</p><button type="button" class="btn button-sti-red" id="IA_loginBtn" style="margin:0 10px 0 0;padding:6px 30px; line-height:24px;">Login</button><button type="button" class="btn button-sti-red" id="IA_registerBtn" style="padding:6px 30px" onclick=" window.open(\'https://semantify.it/register\',\'_blank\')" title="Register at semantify.it"> <i class="material-icons">open_in_new</i>  Register</button><div id="IA_credentialsSection" hidden><input type="text" class="form-control" id="IA_username" placeholder="Username/Email" title="Username/Email"><input type="password" class="form-control" id="IA_password" placeholder="Password" title="Password"></div>');var d=function(e){13===e.keyCode&&a()("#IA_loginBtn").click()};a()("#IA_username").keyup(function(e){d(e)}),a()("#IA_password").keyup(function(e){d(e)}),a()("#IA_saveModal").modal().on("hidden.bs.modal",function(){a()(this).remove()}),a()("#IA_loginBtn").click(function(){if("none"===a()("#IA_credentialsSection").css("display"))a()("#IA_credentialsSection").slideDown(100);else{var e={identifier:a()("#IA_username").val(),password:a()("#IA_password").val()};g(o+"/api/login",void 0,e,function(e){e?(a()("#IA_loginSection").slideUp(100),w=e.token,c()):(r.content="Couldn't log in to semantify.it",a.a.snackbar(r))})}})}else r.content="There was an error saving annotation to semantify.it",a.a.snackbar(r)})}}},D={name:"Preview",icon:"find_in_page",createJsonLD:!0,onclick:function(e){if(null!==e.jsonLd){var t=document.createElement("div");document.body.appendChild(t),t.setAttribute("id","preview_id"),a()("#preview_id").append('<div class="bootstrap semantify semantify-instant-annotations"><div class="modal fade" id="previewModal" role="dialog"><div class="modal-dialog"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal">&times;</button><h4 class="modal-title">Preview JSON-LD</h4></div><div class="modal-body"><pre id="preview_textArea" style="max-height: 500px;"></pre><button class="btn btn-default" id="IA_simple_preview_copy" style="float: right; position:relative;bottom:55px; right:5px "> <i class="material-icons">content_copy</i> Copy</button></div><div class="modal-footer"><button type="button" class="btn btn-default" data-dismiss="modal">Close</button></div></div></div></div></div>'),a()("#preview_textArea").html(m(JSON.stringify(e.jsonLd,null,2))),a()("#previewModal").modal().on("hidden.bs.modal",function(){a()(this).remove()}),a()("#IA_simple_preview_copy").click(function(){b(JSON.stringify(e.jsonLd,null,2))})}}},L=[D,T,N],E=[D,C,k];function R(e){var t=[];switch(e){case"no":t=[];break;case"default":case void 0:case null:t=L.slice();break;case"wp_delete":t=[k];break;case"wp_default":t=E.slice();break;default:e.split("+").forEach(function(e){switch(e){case"preview":t.push(D);break;case"clear":t.push(T);break;case"delete":t.push(j);break;case"save":t.push(N);break;case"copy":t.push(A);break;case"wpsave":t.push(C)}})}return t}function _(e){var t,n=[],r=!0,a=!1,o=void 0;try{for(var i,s=(t=e,Array.isArray(t)?t:[t])[Symbol.iterator]();!(r=(i=s.next()).done);r=!0){var l=i.value;"string"==typeof l?n=n.concat(R(l)):n.push(l)}}catch(e){a=!0,o=e}finally{try{r||null==s.return||s.return()}finally{if(a)throw o}}return n}var B=n(2),P=n.n(B);var M=I(function(e,t){var n=new P.a;n.addVocabularies(e,function(){return t(n)})}),U=function(e,t){var n=function(e){for(var t,n,r=[],a=o+"/api/vocabulary/namespace/",i=0;i<e.length;i++)-1!==e[i].indexOf("schema.org")?r.push("https://raw.githubusercontent.com/schemaorg/schemaorg/master/data/releases/"+(t=e[i],void 0,n=void 0,/.*schema\.org\/version\/([0-9\.]+)\//g,n=/.*schema\.org\/version\/([0-9\.]+)\//g.exec(t),parseFloat(n[1]))+"/all-layers.jsonld"):-1!==e[i].indexOf("dachkg.org")&&r.push(a+encodeURIComponent(e[i]));return r}(function(e){var t=[];if(e&&e["@graph"]&&e["@graph"][0]&&e["@graph"][0]["schema:schemaVersion"]&&t.push(e["@graph"][0]["schema:schemaVersion"]),e&&e["@context"])for(var n=Object.keys(e["@context"]),r=["rdf","rdfs","sh","xsd","schema","sh:targetClass","sh:property","sh:path","sh:nodeKind","sh:datatype","sh:node","sh:class","sh:or","sh:in"],a=0;a<n.length;a++)-1===r.indexOf(n[a])&&t.push(e["@context"][n[a]]);return t}(e));M(n,t)};function J(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,a=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(r=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==s.return||s.return()}finally{if(a)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}n.d(t,"createIABox",function(){return ae}),n.d(t,"util",function(){return ce});var F=h,V=c,q=function(e){var t=[];return a.a.each(e,function(e,n){-1==a.a.inArray(n,t)&&t.push(n)}),t},z=function(e){for(var t=[e],n=!1;!n&&t.length;){var r=t.shift();n=Object.keys(r).some(function(e){if("@type"!==e&&r[e]instanceof Array&&"@context"!==e)return!0;null!==r[e]&&"object"===u(r[e])&&t.push(r[e])})}return n},H=m,G=function e(t){var n,r=arguments[1]||"",a=arguments[2]||{};for(n in t)t.hasOwnProperty(n)&&("object"===u(t[n])?e(t[n],r+n+".",a):a[r+n]=t[n]);return a},W=function(e,t,n){for(var r=e,a=t.split("-"),o=a.length,i=0;i<o-1;i++){var s=a[i];r[s]||(r[s]={}),r=r[s]}return r[a[o-1]]=n,e},Q=function(e){var t=[];return a.a.each(e,function(e,n){t.push("<li>"+n+"</li> \n")}),t},X=p,K=function(e){return'[id="'+e+'"]'},Y=function(e){return e.startsWith("schema")?c(e):e},Z=function(e){return l(e).reduce(function(e,t){var n=s(t,2),r=n[0],a=n[1];return e[r]=a,e},{})},$=[],ee=[],te=[];var ne=0;var re=I(function(e,t,n){var r="".concat(o,"/api/domainSpecification/").concat(t?"hash/":"").concat(e);F(r,function(r){if(!r)throw new Error("Ds with hash/id '"+e+"'does not exist");r.hash=t?e:null,n(r)})});function ae(){(function(e,t,n,r){var i=a()("#"+e);if(!i)throw new Error("Cannot find div with id "+e);var s={panelId:"Panel"+ne++};i.append('<div id="loading'+s.panelId+'" class="col-lg-3 col-md-4 col-sm-6 text-center" style="margin: 10px; padding: 10px; background: white; border-radius: 10px;"><img src="'+o+'/images/loading.gif"></div>');var l=Object.assign({buttons:"default",title:void 0,panelColClass:"col-lg-3 col-md-4 col-sm-6 col-xs-12",withSubClassSelection:!0,annotation:void 0,smtfyAnnotationUID:void 0,smtfySemantifyWebsiteUID:"Hkqtxgmkz",smtfySemantifyWebsiteSecret:"ef0a64008d0490fc4764c2431ca4797b"},n);if(l.buttons=_(l.buttons),t)if("string"==typeof t)re(t,!0,function(e){oe(s,i,e,l,r)});else{if(!t.dsId)throw new Error('Either provide ds as string or {dsId: "yourdsid"}');re(t.dsId,!1,function(e){oe(s,i,e,l,r)})}else oe(s,i,void 0,l,r)}).apply(void 0,arguments)}function oe(e,t,n,r,i){U(n&&n.content,function(s){!function(e,t,n,r,i,s){var l=e.panelId;a()("#loading"+l).hide();var u=n&&n.content["@graph"][0],c=r&&r.title?r.title:void 0===u?"Domainspecification not found":u["schema:name"],d=c,p=r&&r.buttons&&r.buttons.length>0?'<div class="panel-footer text-center" id="panel-footer-'+l+'"></div>':"";if(t.append('<div class="'+r.panelColClass+'" id="panel-'+l+'"><div class="panel panel-info "><div class="panel-heading sti-red"> <h3>'+c+'</h3></div> <div class="panel-body" id="panel-body-'+l+'"></div>'+p+"</div></div>"),n){var f;if(Array.isArray(u["sh:targetClass"])){f=[];var h=!0,y=!1,g=void 0;try{for(var v,m=u["sh:targetClass"][Symbol.iterator]();!(h=(v=m.next()).done);h=!0){var b=v.value;f.push(Y(b))}}catch(e){y=!0,g=e}finally{try{h||null==m.return||m.return()}finally{if(y)throw g}}}else f=Y(u["sh:targetClass"]);Array.isArray(f)&&1===f.length&&(f=f[0]);var x={panelId:l,name:d,root:f};$.push(x);var w=u["sh:property"],I=[],C=[],k=function e(t,n,r,a,o){var i=[];for(var s in t)if(t.hasOwnProperty(s)){var l=t[s],u=ie(l["sh:or"])[0],c=!l["sh:minCount"]||0===l["sh:minCount"],d=Y(l["sh:path"]);if(u["sh:node"]||!u["sh:datatype"]&&!u["sh:in"])if(u["sh:node"]){var p,f=""===n?d:n+"-"+d,h=f+"-@type";if(Array.isArray(u["sh:class"])){p=[];var y=!0,g=!1,v=void 0;try{for(var m,b=u["sh:class"][Symbol.iterator]();!(y=(m=b.next()).done);y=!0){var x=m.value;p.push(V(x))}}catch(e){g=!0,v=e}finally{try{y||null==b.return||b.return()}finally{if(g)throw v}}}else p=V(u["sh:class"]);var w={name:p,path:h,panelId:a};ee.push(w);var I=!0===o||c;i=i.concat(e(u["sh:node"]["sh:property"],f,u["sh:class"],a,I))}else console.log("UNKOWN PROP",l);else{var S={simpleName:d,name:(""===n?"":n+"-")+d,type:u["sh:datatype"],fatherType:r,isOptional:c,multipleValuesAllowed:!1,rootIsOptional:o};if(u["sh:in"]){S.type="Enumeration";var O=[];ie(u["sh:in"]).forEach(function(e){O.push(V(e))}),S.enums=O}i.push(S)}}return i}(w,"",f,l,!1),A=!0,j=!1,T=void 0;try{for(var N,D=k[Symbol.iterator]();!(A=(N=D.next()).done);A=!0){var L=N.value;L.isOptional||L.rootIsOptional?C.push(L):I.push(L)}}catch(e){j=!0,T=e}finally{try{A||null==D.return||D.return()}finally{if(j)throw T}}for(var E=0,R=I;E<R.length;E++){var _=R[E];se(l,_.name,S(i,_.simpleName,_.name),_.type,_.enums,"#panel-body-",_.isOptional,_.rootIsOptional,_.multipleValuesAllowed)}if(C.length>0){a()("#panel-body-"+l).append('<button type="button" class="btn btn-block btn-default text-left" id="panel-body-opt-btn-'+l+'" style="background-color: lightgrey;">Optional<span class="caret"></button>').append('<div id="panel-body-opt-'+l+'"> </div>'),W=l,a()("#panel-body-opt-btn-"+W).click(function(){var e=a()("#panel-body-opt-"+W);"none"===e.css("display")?e.slideDown(500):e.slideUp(500)});for(var B=0,P=C;B<P.length;B++){_=P[B];se(l,_.name,S(i,_.simpleName,_.name),_.type,_.enums,"#panel-body-opt-",_.isOptional,_.rootIsOptional,_.multipleValuesAllowed)}}if(a()("#panel-body-opt-"+l).slideUp(0),r.withSubClassSelection)if(a()("#panel-body-"+l).append("<hr>"),Array.isArray(f)){b=0;var M=!0,U=!1,J=void 0;try{for(var q,z=f[Symbol.iterator]();!(M=(q=z.next()).done);M=!0){x=q.value;var H=O(i,x).sort();a()("#panel-body-"+l).append('<select name="select" class="form-control input-myBackground input-mySelect" id="sub_'+l+"_"+b+'" title="Select a sub-class if you want to specify further">'),(G=a()("#sub_"+l+"_"+b)).append('<option value="'+x+'">Default: '+x+"</option>"),H.forEach(function(e){G.append('<option value="'+e+'">'+e+"</option>")}),G.append("</select>"),b++}}catch(e){U=!0,J=e}finally{try{M||null==z.return||z.return()}finally{if(U)throw J}}}else{var G;H=O(i,f).sort();a()("#panel-body-"+l).append('<select name="select" class="form-control input-myBackground input-mySelect" id="sub_'+l+'" title="Select a sub-class if you want to specify further">'),(G=a()("#sub_"+l)).append('<option value="'+f+'">Default: '+f+"</option>"),H.forEach(function(e){G.append('<option value="'+e+'">'+e+"</option>")}),G.append("</select>")}}else a()("#panel-body-"+l).html('<pre  style="max-height:400px" id="ia_panel_'+l+'_content"></pre>');var W;var Q=!0,X=!1,K=void 0;try{for(var Z,ne=r.buttons[Symbol.iterator]();!(Q=(Z=ne.next()).done);Q=!0){var re=Z.value;!function(t){var o=re.name,s=re.onclick,l=re.additionalClasses,u=re.hasOwnProperty("icon")?re.icon:null,c=!!re.createJsonLD,d=!1!==re.onlyIcon;a()("#panel-footer-"+t).append('<button class="btn button-sti-red" id="panel-footer-btn-'+o+"-"+t+'" style="margin: 5px 5px; padding: 10px 10px" '+(l||"")+' title="'+o+'" >'+(u?'<i class="material-icons">'+u+"</i>":o)+(d?"":" "+o)+"</button>"),a()("#panel-footer-btn-"+o+"-"+t).click(function(o){o.preventDefault(),s({jsonLd:a()("#panel-footer-btn-Preview-"+t).prop("already_annotation_created")?a()("#panel-footer-btn-Preview-"+t).prop("already_annotation_created"):c?ue(t,i):null,dsHash:n&&n.hash,annId:a()("#panel-"+t).data("smtfyAnnId"),webId:a()("#panel-"+t).data("smtfyWebId"),panelId:t,inputFields:te,options:r,iaBox:e})})}(l)}}catch(e){X=!0,K=e}finally{try{Q||null==ne.return||ne.return()}finally{if(X)throw K}}r.annotation?le(e,n,r,s):r.smtfyAnnotationUID?function(e,t,n,r){a()("#panel-"+e.panelId).data("smtfyAnnId",n.smtfyAnnotationUID).data("smtfyWebId",n.smtfySemantifyWebsiteUID).data("smtfyWebSecret",n.smtfySemantifyWebsiteSecret),F(o+"/api/annotation/short/"+n.smtfyAnnotationUID,function(o){"string"==typeof o&&(o=JSON.parse(o)),void 0===o?(a()("#panel-body-"+e.panelId).html("There was an error loading the annotation with id: <b>"+n.smtfyAnnotationUID+"</b> from the server!\n Reload the page or check if the annotation was deleted"),a()("#panel-footer-btn-Preview-"+e.panelId).prop("disabled",!0),a()("#panel-footer-btn-Save-"+e.panelId).prop("disabled",!0)):(n.annotation=o,le(e,t,n,r))})}(e,n,r,s):s&&s(e)}(e,t,n,r,s,i)})}var ie=function(e){return e["@list"]?e["@list"]:e};function se(e,t,n,r,o,i,s,l,u){var c="IA_"+e+"_"+t;switch(l&&!s&&!0,r){case"xsd:string":case"xsd:anyURI":case"xsd:double":case"xsd:float":case"xsd:integer":a()(i+e).append('<input type="text" class="form-control input-myBackground" id="'+c+'" placeholder="'+t+'" title="'+n+'">');break;case"xsd:boolean":a()(i+e).append('<select style="color:#aaa" name="select" class="form-control input-myBackground" id="'+c+'" title=" '+n+'"></select>'),a()(K(c)).append('<option value="" selected style="color:#aaa">'+t+'</option><option  style="color:#000" value="true">true</option><option style="color:#000" value="false">false</option>'),a()(K(c)).change(function(){""==a()(this).val()?a()(this).css({color:"#aaa"}):a()(this).css({color:"#000"})});break;case"xsd:date":a()(i+e).append('<input type="text" class="form-control input-myBackground" id="'+c+'" placeholder="'+t+'" title="'+n+'">'),a()(K(c)).datetimepicker({format:"YYYY-MM-DD"});break;case"xsd:dateTime":a()(i+e).append('<input type="text" class="form-control input-myBackground" id="'+c+'" placeholder="'+t+'" title="'+n+'">'),a()(K(c)).datetimepicker({format:"YYYY-MM-DDTHH:mm"});break;case"xsd:time":a()(i+e).append('<input type="text" class="form-control input-myBackground" id="'+c+'" placeholder="'+t+'" title="'+n+'">'),a()(K(c)).datetimepicker({format:"HH:mm"});break;case"Enumeration":u?a()(i+e).append('<select multiple name="select" class="form-control input-myBackground input-mySelect" id="'+c+'" title=" You can add more than one value by pressing *Ctrl* \n\n'+n+'">'):(a()(i+e).append('<select style="color:#bfc0bf" name="select" class="form-control input-myBackground" id="'+c+'" title=" '+n+'">'),a()(K(c)).change(function(){""==a()(this).val()?a()(this).css({color:"#bfc0bf"}):a()(this).css({color:"#555555"})}));var d=a()(K(c));d.append('<option value="" selected style="color:#bfc0bf">Select: '+t+"</option>"),o.forEach(function(e){d.append('<option style="color:#555555" value="'+e+'">'+e+"</option>")}),d.append("</select>")}a()(K(c)).data("type",r).data("enumerations",o).data("isOptional",s).data("rootIsOptional",l).data("multipleValuesAllowed",u).data("name",t),te.push(c)}function le(e,t,n,r){var o=e.panelId,i=n.annotation;if(z(i))a()("#panel-body-"+o).html('<pre id="ia_panel_'+o+'_content"></pre> To edit this annotation, please visit <a href="https://semantify.it">semantify.it</a>  and use the full editor. In this version, no multiple values are allowed! '),a()("#panel-footer-btn-Preview-"+o).prop("already_annotation_created",i),a()("#panel-footer-btn-Save-"+o).prop("disabled",!0),(S=a()("#ia_panel_"+o+"_content")).html(H(JSON.stringify(i,null,2))),S.css("max-height","200px"),S.css("overflow","hidden"),S.css("text-overflow","ellipsis"),S.css("-webkit-mask","linear-gradient(0deg, rgba(0,0,0,0) 20%, rgba(0,0,0,1) 70%)");else if(t){var s=G(i);if(Array.isArray(i["@type"])){var l=0,u=!0,c=!1,d=void 0;try{for(var p,f=i["@type"][Symbol.iterator]();!(u=(p=f.next()).done);u=!0){var h=p.value;a()("#sub_"+o+"_"+l).val(h).change(),l++}}catch(e){c=!0,d=e}finally{try{u||null==f.return||f.return()}finally{if(c)throw d}}}else a()("#sub_"+o).val(s["@type"]).change();var y=!0,g=!1,v=void 0;try{for(var m,b=function(e){for(var t=[],n=0,r=te;n<r.length;n++){var a=r[n];a.slice(a.indexOf("_")+1,a.indexOf("_",a.indexOf("_")+1))===e.toString()&&t.push(a)}return t}(o)[Symbol.iterator]();!(y=(m=b.next()).done);y=!0){var x=m.value,w=a()(K(x)),I=s[w.data("name").replace(/-/g,".")];void 0!==I&&I.length>0&&(I=I.replace("http://schema.org/","")),w.val(I)}}catch(e){g=!0,v=e}finally{try{y||null==b.return||b.return()}finally{if(g)throw v}}}else{var S;a()("#panel-body-"+o).append("This annotation does not have any Domain Specification. Therefore you won`t be able to edit it."),a()("#panel-footer-btn-Preview-"+o).prop("already_annotation_created",i),a()("#panel-footer-btn-Save-"+o).prop("disabled",!0),(S=a()("#ia_panel_"+o+"_content")).html(H(JSON.stringify(i,null,2))),S.css("max-height","200px"),S.css("overflow","hidden"),S.css("text-overflow","ellipsis"),S.css("-webkit-mask","linear-gradient(0deg, rgba(0,0,0,0) 20%, rgba(0,0,0,1) 70%)")}r&&r(e)}function ue(e,t){var n,r="Thing";if($.forEach(function(t){t.panelId==e&&(t.name,r=t.root)}),Array.isArray(r))for(var o in n=[],r)n.push(a()("#sub_"+e+"_"+o).val());else n=a()("#sub_"+e).val();null!=n&&""!=n&&null!=n&&(r=n);for(var i=[],s=[],l=Object.entries(t.getVocabularies()),u={"@context":l=1===l.length&&"schema"===l[0][0]?l[0][1]:Z(l.map(function(e){var t=J(e,2),n=t[0];return["schema"===n?"@vocab":n,t[1]]})),"@type":r},c=!0,d=!0,p=[],f=[],h=[],y=0,g=te;y<g.length;y++){(b=g[y]).slice(b.indexOf("_")+1,b.indexOf("_",b.indexOf("_")+1))===e.toString()&&p.push(b)}for(var v=0,m=p;v<m.length;v++){var b=m[v],x=a()(K(b)),w=x.val(),I=x.data("name"),S=x.data("isOptional"),O=x.data("rootIsOptional");if(null!=w&&""!==w&&0!==w.length&&null!=w.length||!1!==S||!1!==O||(c=!1,f.push(x)),null!=w&&null!=w&&""!=w&&0!=w.length&&null!=w.length&&!0===O){for(var C=[],k=I.split("-");k.length>1;)k.pop(),C.push(k.join("-"));p.forEach(function(e){var t=a()(K(e)),n=t.data("name"),r=t.data("isOptional"),o=t.data("rootIsOptional"),i=n.split("-");i=i.length;for(var s=t.val(),l=0;l<C.length;l++){var u=C[l].split("-");u=u.length,0==r&&1==o&&n.indexOf(C[l])>=0&&i===u+1&&(void 0!==s&&""!==s&&null!=s&&0!==s.length&&null!=s.length||(h.push(n),d=!1))}})}if(ee.forEach(function(t){if(t.panelId===e){var n={name:t.name,path:t.path};s.push(n)}}),null!=w&&""!==w&&0!==w.length&&null!=w.length){for(var A=I.split("-");A.length>1;){A.pop();var j=A.join("-")+"-@type";i.push(j)}s.forEach(function(e){i.forEach(function(t){t===e.path&&(u=W(u,e.path,e.name))})}),u=W(u,I,w)}}return c&&d?u:(c?(h=Q(q(h)),X("Please also fill in <ul>"+h.join("")+"</ul>",3e3+1e3*(h.length-1)),h.forEach(function(t){var n=a()("#IA_"+e+"_"+t.replace(/<(?:.|\n)*?>/gm,""));n.css({border:"1px solid rgba(255, 0, 0, 1)","box-shadow":"0 0 10px rgba(255, 0, 0, 1)"}),setTimeout(function(){n.css({border:"","box-shadow":""})},3e3)})):(f.forEach(function(e){e.css({border:"1px solid rgba(255, 0, 0, 1)","box-shadow":"0 0 10px rgba(255, 0, 0, 1)"}),setTimeout(function(){e.css({border:"","box-shadow":""})},3e3)}),X("Please fill in all required fields",3e3)),null)}var ce={semantifyUrl:o,remove:f,copyStr:b,syntaxHighlight:m,send_snackbarMSG:p,send_snackbarMSG_fail:d,httpGetHeaders:y,httpPostJson:g,httpCall:v,httpGet:h,sdoAdapter:function(e){var t=new P.a;t.addVocabularies(["https://raw.githubusercontent.com/schemaorg/schemaorg/master/data/releases/3.9/all-layers.jsonld"],function(){return e(t)})}}}]);